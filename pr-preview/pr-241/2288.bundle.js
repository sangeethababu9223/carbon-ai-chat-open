/*! For license information please see 2288.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_carbon_ai_chat_examples_demo=self.webpackChunk_carbon_ai_chat_examples_demo||[]).push([[2288],{34:function(e,t,n){n.d(t,{r:function(){return o}});var a=n(3696),s=n(6753),r=n(577);function o(){const e=(0,a.useRef)();return void 0===e.current&&(e.current=(0,s.u)(r.y.COMPONENT)),e.current}},395:function(e,t,n){n.d(t,{s:function(){return a}});const a=n(3696).createContext(null)},404:function(e,t,n){n.d(t,{S:function(){return s},o:function(){return a}});const a="cds--aichat",s="cds-aichat"},577:function(e,t,n){var a;n.d(t,{y:function(){return a}}),function(e){e[e.MISCELLANEOUS=1]="MISCELLANEOUS",e[e.LOCAL_MESSAGE=2]="LOCAL_MESSAGE",e[e.MESSAGE=3]="MESSAGE",e[e.COMPONENT=4]="COMPONENT",e[e.USER=6]="USER",e[e.DEVICE_ID=8]="DEVICE_ID",e[e.FILE=9]="FILE"}(a||(a={}))},948:function(e,t,n){function a(e){return Array.isArray(e)?e:[e]}async function s(e,t){for(let n=0;n<e.length;n++){const a=e[n];await t(a,n,e)}}function r(e,t,n){const a=function(e,t){if(e)for(let n=e.length-1;n>=0;n--)if(t(e[n],n,e))return n;return-1}(e,t);return-1===a?void 0:e[a]}function o(e,t,n){for(let a=e.length-1;a>=0;a--){const s=t[e[a]];if(n(s,a,e))return s}}function i(e){return e&&e.length?e[e.length-1]:null}n.d(t,{PQ:function(){return s},U1:function(){return o},Uk:function(){return r},_j:function(){return a},ns:function(){return i}})},1120:function(e,t,n){n.d(t,{CL:function(){return c},aT:function(){return u},fS:function(){return l}});var a=n(9633),s=n(6753),r=n(7391),o=n(2870),i=n(577);function c(e,t,n=!1,a=!1){const o={ui_state:{id:(0,r.xN)(t.id,e)||(0,s.u)(i.y.LOCAL_MESSAGE),needsAnnouncement:!t.history.from_history,disableFadeAnimation:a},item:e,fullMessageID:t.id};return n&&(o.ui_state.isWelcomeResponse=!0),o}function l(e){return function(e){const t=(0,r.jv)(e);return{originalMessage:t,localMessage:c(e,t)}}({response_type:a.sP.INLINE_ERROR,text:e})}function u(e,t,n,a,s){const{item:o}=e;if((0,r._x)(o))e.ui_state.gridLocalMessageItemIDs=o.rows.map(s=>s.cells.map(s=>{const r=[];return d("items",e,s.items,r,t,n,a,t=>h(e.item,t),!1),r}));else if((0,r.Ex)(o))e.ui_state.itemsLocalMessageItemIDs=[],d("items",e,o.items,e.ui_state.itemsLocalMessageItemIDs,t,n,a,e=>h(o,e),s);else{const i=o.body||o.panel?.body;if(i&&(e.ui_state.bodyLocalMessageItemIDs=[],d("body",e,i,e.ui_state.bodyLocalMessageItemIDs,t,n,a,e=>h(o,e),!(0,r.Cx)(o))),!s)return;const c=o.footer||o.panel?.footer;c&&(e.ui_state.footerLocalMessageItemIDs=[],d("footer",e,c,e.ui_state.footerLocalMessageItemIDs,t,n,a,e=>function(e,t){return!!(0,r.Mm)(t)&&(!(0,r.Cx)(e)||!(0,r.Cx)(t))}(o,e),!(0,r.Cx)(o)))}}function d(e,t,n,a,s,i,l,d,h){n.forEach(n=>{if(d(n)){const e=c(n,s,!1,!0);a.push(e.ui_state.id),l.push(e),(0,r.bY)(e.item)&&u(e,s,i,l,h)}else(0,o.yA)(`The "${t.item.response_type}" response type does not support "${n.response_type}" in "${e}" array.`)})}function h(e,t){switch(e.response_type){case a.sP.CARD:return!(0,r._0)(t)&&(0,r.Wo)(t);case a.sP.CAROUSEL:return(0,r._0)(t);case a.sP.BUTTON:return e.button_type===a.kw.SHOW_PANEL&&(0,r.Wo)(t);case a.sP.GRID:return!(0,r._0)(t)&&(0,r.Wo)(t);default:return!1}}},1424:function(e,t,n){n.d(t,{b:function(){return l}});var a=n(4544),s=n(3696),r=n(5022),o=n(5230),i=n(5688);function c({className:e,children:t,isOpen:n,hidePanelHeader:c,labelBackButton:l,title:u,hideBackButton:d,useAITheme:h,onClickCloseAndRestart:g,onClickRestart:m,testIdPrefix:p,...f},S){const y=(0,r.d4)(e=>e.config.public.headerConfig?.showRestartButton),C=(0,s.useRef)();return(0,s.useImperativeHandle)(S,()=>C.current),s.createElement(a,{active:n,focusTrapOptions:{clickOutsideDeactivates:!0,returnFocusOnDeactivate:!o.yS,preventScroll:!0}},s.createElement("div",{className:e},!c&&s.createElement(i.Y,{...f,ref:C,showRestartButton:y,onClickRestart:m,onCloseAndRestart:g,showBackButton:!d,labelBackButton:l,displayName:u,useAITheme:h,testIdPrefix:p,showCenter:!0}),s.createElement("div",{className:"WACPanelContent"},t)))}const l=s.memo(s.forwardRef(c))},1748:function(e,t,n){n.d(t,{$z:function(){return $},A$:function(){return ae},AM:function(){return ue},Ay:function(){return Se},By:function(){return i},CA:function(){return de},Cw:function(){return U},Ew:function(){return x},FG:function(){return f},GZ:function(){return d},HD:function(){return re},IE:function(){return le},JX:function(){return A},Ky:function(){return pe},Mp:function(){return se},Mu:function(){return O},NO:function(){return c},P9:function(){return X},Pq:function(){return u},Qz:function(){return fe},RT:function(){return L},Rj:function(){return s},T0:function(){return m},TD:function(){return S},TP:function(){return J},TV:function(){return ge},Tp:function(){return E},UC:function(){return K},Uy:function(){return D},VG:function(){return C},XU:function(){return V},Xi:function(){return y},YO:function(){return p},ZB:function(){return te},_J:function(){return h},_P:function(){return _},_V:function(){return ce},bH:function(){return ee},c:function(){return g},c7:function(){return w},dD:function(){return ne},ds:function(){return k},ex:function(){return q},fO:function(){return ie},gA:function(){return z},hU:function(){return R},hp:function(){return he},iA:function(){return T},iS:function(){return oe},ko:function(){return v},m:function(){return r},nS:function(){return Y},qO:function(){return G},qe:function(){return P},qu:function(){return F},qx:function(){return Q},rJ:function(){return me},rq:function(){return H},sK:function(){return W},uc:function(){return I},vI:function(){return l},vf:function(){return Z},vp:function(){return M},wq:function(){return N},ww:function(){return b},xi:function(){return B},yM:function(){return o},zM:function(){return j}});var a=n(6753);const s="CHANGE_STATE",r="UPDATE_BOT_NAME",o="UPDATE_BOT_AVATAR_URL",i="UPDATE_LAUNCHER_AVATAR_URL",c="UPDATE_MAIN_HEADER_TITLE",l="HYDRATE_CHAT",u="HYDRATE_MESSAGE_HISTORY",d="ADD_LOCAL_MESSAGE_ITEM",h="REMOVE_MESSAGES",g="UPDATE_LOCAL_MESSAGE_ITEM",m="SET_APP_STATE_VALUE",p="ADD_IS_TYPING_COUNTER",f="ADD_IS_LOADING_COUNTER",S="ADD_IS_HYDRATING_COUNTER",y="SET_VIEW_STATE",C="SET_VIEW_CHANGING",E="SET_INITIAL_VIEW_CHANGE_COMPLETE",_="UPDATE_CSS_VARIABLES",A="MESSAGE_SET_OPTION_SELECTED",v="SET_MESSAGE_UI_PROPERTY",T="SET_MESSAGE_HISTORY_PROPERTY",I="MERGE_HISTORY",w="SET_LAUNCHER_PROPERTY",M="SET_LAUNCHER_CONFIG_PROPERTY",b="ANNOUNCE_MESSAGE",R="SET_CHAT_MESSAGES_PROPERTY",N="RESTART_CONVERSATION",O="ACCEPTED_DISCLAIMER",P="ADD_MESSAGE",D="UPDATE_HOME_SCREEN_CONFIG",B="UPDATE_HAS_SENT_NON_WELCOME_MESSAGE",L="UPDATE_PERSISTED_CHAT_STATE",H="SET_TOUR_DATA",W="CLEAR_TOUR_DATA",k="CHANGE_STEP_IN_TOUR",x="SET_HOME_SCREEN_IS_OPEN",U="UPDATE_LAUNCHER_CONFIG",F="UPDATE_MESSAGE",V="SET_LAUNCHER_MINIMIZED",$="CLOSE_IFRAME_PANEL",G="OPEN_IFRAME_CONTENT",q="SET_CONVERSATIONAL_SEARCH_CITATION_PANEL_IS_OPEN",Y="SET_CUSTOM_PANEL_OPTIONS",j="SET_CUSTOM_PANEL_OPEN",z="GO_BACK_TO_HOME",X="UPDATE_INPUT_STATE",K="SET_IS_PAGE_VISIBLE",Q="ADD_INPUT_FILE",Z="CLEAR_INPUT_FILES",J="REMOVE_INPUT_FILE",ee="REMOVE_LOCAL_MESSAGE_ITEM",te="FILE_UPLOAD_INPUT_ERROR",ne="ADD_NESTED_MESSAGES",ae="SET_RESPONSE_PANEL_IS_OPEN",se="SET_PANEL_RESPONSE_CONTENT",re="STREAMING_ADD_CHUNK",oe="STREAMING_START",ie="STREAMING_MERGE_HISTORY",ce="ADD_NOTIFICATION",le="REMOVE_ALL_NOTIFICATIONS",ue="REMOVE_NOTIFICATIONS",de="UPDATE_CHAT_HEADER_CONFIG",he="UPDATE_MAX_VISIBLE_HEADER_OBJECTS",ge="SET_STOP_STREAMING_BUTTON_VISIBLE",me="SET_STOP_STREAMING_BUTTON_DISABLED",pe="SET_STREAM_ID",fe="UPDATE_MAIN_HEADER_AVATAR",Se={changeState(e){return{type:s,partialState:e}},chatWasHydrated(){return{type:l}},hydrateMessageHistory(e){return{type:u,messageHistory:e}},removeMessages(e){return{type:h,messageIDs:e}},restartConversation(){return{type:N}},addLocalMessageItem(e,t,n,a){return{type:d,messageItem:e,message:t,addMessage:n,addAfterID:a}},addMessage(e){return{type:P,message:e}},updateLocalMessageItem(e){return{type:g,messageItem:e}},updateMessage(e){return{type:F,message:e}},messageSetOptionSelected(e,t){return{type:A,messageID:e,sentMessage:t}},updatePersistedChatState(e){return{type:L,chatState:e}},setTourData(e){return{type:H,newActiveTourMessageID:e}},clearTourData(){return{type:W}},changeStepInTour(e){return{type:k,newStepNumber:e}},updateHasSentNonWelcomeMessage(e){return{type:B,hasSentNonWelcomeMessage:e}},setAppStateValue(e,t){return{type:m,key:e,value:t}},addIsTypingCounter(e){return{type:p,addToIsTyping:e}},addIsLoadingCounter(e){return{type:f,addToIsLoading:e}},addIsHydratingCounter(e){return{type:S,addToIsHydrating:e}},updateBotName(e){return{type:r,name:e}},updateMainHeaderTitle(e){return{type:c,title:e}},updateBotAvatarURL(e){return{type:o,url:e}},updateCSSVariables(e,t,n){return{type:_,variables:e,publicVars:t,whiteLabelVariables:n}},updateHomeScreenConfig(e){return{type:D,homeScreenConfig:e}},setViewState(e){return{type:y,viewState:e}},setViewChanging(e){return{type:C,viewChanging:e}},setInitialViewChangeComplete(e){return{type:E,changeComplete:e}},setMessageUIProperty(e,t,n){return{type:v,localMessageID:e,propertyName:t,propertyValue:n}},setLauncherProperty(e,t){return{type:w,propertyName:e,propertyValue:t}},setLauncherConfigProperty(e,t,n){return{type:M,propertyName:e,propertyValue:t,launcherType:n}},setMessageHistoryProperty(e,t,n){return{type:T,messageID:e,propertyName:t,propertyValue:n}},mergeMessageHistory(e,t){return{type:I,messageID:e,history:t}},setMessageErrorState(e,t){return Se.setMessageHistoryProperty(e,"error_state",t)},setMessageWasAnnounced(e){return Se.setMessageUIProperty(e,"needsAnnouncement",!1)},announceMessage(e){return{type:b,message:e}},setChatMessagesStateProperty(e,t){return{type:R,propertyName:e,propertyValue:t}},addNotification(e){const t=(0,a.u)();return{type:ce,notificationID:t,notification:e}},removeNotifications({groupID:e,notificationID:t}){return{type:ue,groupID:e,notificationID:t}},removeAllNotifications(){return{type:le}},acceptDisclaimer(){return{type:O}},setHomeScreenIsOpen(e){return{type:x,isOpen:e}},updateLauncherConfig(e){return{type:U,launcherConfig:e}},setLauncherMinimized(){return{type:V}},closeIFramePanel(){return{type:$}},setIFrameContent(e){return{type:G,messageItem:e}},setViewSourcePanelIsOpen(e,t,n){return{type:q,isOpen:e,citationItem:t,relatedSearchResult:n}},setCustomPanelConfigOptions(e){return{type:Y,options:e}},setCustomPanelOpen(e){return{type:j,isOpen:e}},toggleHomeScreen(){return{type:z}},updateInputState(e,t){return{type:X,newState:e,isInputToAgent:t}},setIsBrowserPageVisible(e){return{type:K,isVisible:e}},addInputFile(e,t){return{type:Q,file:e,isInputToAgent:t}},removeFileUpload(e,t){return{type:J,fileID:e,isInputToAgent:t}},removeLocalMessageItem(e){return{type:ee,localMessageItemID:e}},fileUploadInputError(e,t,n){return{type:te,fileID:e,errorMessage:t,isInputToAgent:n}},clearInputFiles(e){return{type:Z,isInputToAgent:e}},addNestedMessages(e){return{type:ne,localMessageItems:e}},setResponsePanelIsOpen(e){return{type:ae,isOpen:e}},setResponsePanelContent(e,t=!1){return{type:se,localMessageItem:e,isMessageForInput:t}},streamingStart(e){return{type:oe,messageID:e}},streamingMergeHistory(e,t){return{type:ie,messageID:e,history:t}},streamingAddChunk(e,t,n,a){return{type:re,fullMessageID:e,chunkItem:t,isCompleteItem:n,disableFadeAnimation:a}},updateChatHeaderConfig(e){return{type:de,chatHeaderConfig:e}},setMaxVisibleHeaderObjects(e){return{type:he,maxTotal:e}},setStopStreamingButtonVisible(e){return{type:ge,isVisible:e}},setStopStreamingButtonDisabled(e){return{type:me,isDisabled:e}},setStreamID(e){return{type:pe,currentStreamID:e}},updateMainHeaderAvatar(e){return{type:fe,config:e}}}},2288:function(e,t,n){n.r(t),n.d(t,{AppContainer:function(){return bn}});var a=n(253),s=n(3696),r=n(5285),o=n(8306),i=n(1122),c=n(8690),l=n(1748),u=n(9049);function d(e){let t=e;return e?.starters?.buttons?.length&&(t={allow_return:!0,...e,starters:{...e.starters,buttons:e.starters.buttons.filter(e=>Boolean(e.label?.trim()))}},t?.starters?.buttons?.length||(t.starters.is_on=!1)),t}var h=n(5888),g=n(2870),m=n(5505),p=n(2685);function f(e,t,n){e.intl=(0,p.E)({locale:t,messages:n}),e.store.dispatch(l.Ay.setAppStateValue("languagePack",n)),e.store.dispatch(l.Ay.setAppStateValue("locale",t))}var S=n(6895);function y(e){const t=new Set,n={get(e,n){return t.has(n)||t.add(n),e[n]}};return new Proxy(e.writeableElements,n)}var C=n(9499),E=n(1120),_=n(8625),A=n(9763);const v="0.3.3";var T;!function(e){e.TEXT_NOTIFICATION="text_notification"}(T||(T={}));const I=[15e3,6e4];var w=n(5822),M=n(9280),b=n(3158),R=n(7019);const N={config:{is_on:!0,mobile:{is_on:!0,title:"",time_to_expand:15e3,new_expand_time:!1,time_to_reduce:1e4,notification_type:T.TEXT_NOTIFICATION},desktop:{is_on:!0,title:"",new_expand_time:!1,time_to_expand:15e3,notification_type:T.TEXT_NOTIFICATION}}};(0,M.o)(N);const O={title:null,hideBackButton:!1,hidePanelHeader:!1,disableAnimation:!1};(0,M.o)(O);const P={isOpen:!1,panelID:w.z0,options:O};(0,M.o)(P);const D={isOpen:!1,messageItem:null};(0,M.o)(D);const B={isOpen:!1,citationItem:null};(0,M.o)(B);const L={activeTourStepItems:null};(0,M.o)(L);const H={isOpen:!1,localMessageItem:null,isMessageForInput:!1};(0,M.o)(H);const W={launcher:!1,mainWindow:!1,tour:!1};(0,M.o)(W);const k={launcher:!0,mainWindow:!1,tour:!1};(0,M.o)(k);const x={mainWindow:!0,launcher:!1,tour:!1};(0,M.o)(x);const U={chatState:{version:v,disclaimersAccepted:{},homeScreenState:{isHomeScreenOpen:!1,showBackToBot:!1},hasSentNonWelcomeMessage:!1,persistedTourState:{activeTourID:null,activeTourCurrentStepIndex:null},agentState:{isConnected:!1,isSuspended:!1,agentProfiles:{}}},launcherState:{wasLoadedFromBrowser:!1,version:v,viewState:W,activeTour:!1,showUnreadIndicator:!1,mobileLauncherIsExtended:!1,mobileLauncherWasReduced:!1,mobileLauncherDisableBounce:!1,desktopLauncherIsExpanded:!1,desktopLauncherWasMinimized:!1,bounceTurn:1,hasSentNonWelcomeMessage:!1}};(0,M.o)(U);const F={localMessageIDs:[],messageIDs:[],isTypingCounter:0,isLoadingCounter:0,isHydratingCounter:0,isScrollAnchored:!1};(0,M.o)(F);const V={allMessageItemsByID:{},allMessagesByID:{},botMessageState:{...F}};(0,M.o)(V);const $={isConnecting:!1,isReconnecting:!1,numUnreadMessages:0,fileUploadInProgress:!1,showScreenShareRequest:!1,isScreenSharing:!1,isAgentTyping:!1,inputState:{fieldVisible:!0,isReadonly:!1,files:[],allowFileUploads:!1,allowMultipleFileUploads:!1,allowedFileUploadTypes:null,stopStreamingButtonState:{currentStreamID:null,isVisible:!1,isDisabled:!1}}};(0,M.o)($);const G={carbonTheme:b.jF.G10,useAITheme:!1,corners:R.L.ROUND};(0,M.o)(G);const q={showFrame:!0,hasContentMaxWidth:!0};function Y(e,t){return{...e,botMessageState:{...e.botMessageState,...t}}}function j(e,t,n){return void 0===n&&(n=e.persistedToBrowserStorage.chatState.homeScreenState.showBackToBot),{...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,homeScreenState:{...e.persistedToBrowserStorage.chatState.homeScreenState,isHomeScreenOpen:t,showBackToBot:n}}}}}function z(e,t,n,a){const s=e.allMessageItemsByID[t];return s?{...e,allMessageItemsByID:{...e.allMessageItemsByID,[t]:{...s,ui_state:{...s.ui_state,[n]:a}}}}:e}function X(e,t){const n={...e,allMessagesByID:{...e.allMessagesByID,[t.id]:t}};return e.allMessagesByID[t.id]?n:Y(n,{messageIDs:[...e.botMessageState.messageIDs,t.id]})}(0,M.o)(q);var K=n(948),Q=n(9080),Z=n(6753),J=n(7391),ee=n(5041),te=n(5235),ne=n(4308);const ae=4.5;function se(e){if(7===e.length){const t=e.substring(1,3),n=e.substring(3,5),a=e.substring(5,7);return[parseInt(t,16),parseInt(n,16),parseInt(a,16)]}if(4===e.length){const t=e.substring(1,2),n=e.substring(2,3),a=e.substring(3,4);return[parseInt(t+t,16),parseInt(n+n,16),parseInt(a+a,16)]}return(0,g.yA)(`Unsupported color code: "${e}"`),[0,0,0]}function re(e,t){const n=se(e),a=se(t),s=oe(n),r=oe(a);let o;return o=s>r?(s+.05)/(r+.05):(r+.05)/(s+.05),o}function oe([e,t,n]){const a=e/255,s=t/255,r=n/255;return.2126*(a<=.03928?a/12.92:((a+.055)/1.055)**2.4)+.7152*(s<=.03928?s/12.92:((s+.055)/1.055)**2.4)+.0722*(r<=.03928?r/12.92:((r+.055)/1.055)**2.4)}function ie(e){return re(te.Xx,e)>=ae?te.Xx:te.ON}function ce(e,t){const n=ne(e).hsl().object();return ne({...n,l:n.l+t}).round().hex().toLowerCase()}var le=n(6543);const ue="--cds-",de=/#([a-f0-9]{3}){1,2}\b/i,he={"$chat-button":"#000000","$chat-button-text-hover":"#525252"},ge={"$chat-button":"#ffffff","$chat-button-text-hover":"#f4f4f4"},me={white:{blue20:["$highlight"],blue60:["$background-brand","$interactive","$border-interactive","$button-primary","$button-tertiary","$icon-interactive","$focus"],blue60Hover:["$button-primary-hover","$button-tertiary-hover"],blue80:["$button-primary-active","$button-tertiary-active"]},g10:{blue20:["$highlight"],blue60:["$background-brand","$interactive","$border-interactive","$button-primary","$button-tertiary","$icon-interactive","$focus"],blue60Hover:["$button-primary-hover","$button-tertiary-hover"],blue80:["$button-primary-active","$button-tertiary-active"]},g90:{blue20:[],blue60:["$background-brand","$interactive","$border-interactive","$button-primary","$button-tertiary","$focus-inverse"],blue60Hover:["$button-primary-hover","$button-tertiary-hover"],blue80:["$button-primary-active","$highlight","$button-tertiary-active"]},g100:{blue20:[],blue60:["$background-brand","$interactive","$border-interactive","$button-primary","$button-tertiary","$focus-inverse"],blue60Hover:["$button-primary-hover","$button-tertiary-hover"],blue80:["$button-primary-active","$highlight","$button-tertiary-active"]}};function pe(e,t,n){t.forEach(t=>{e[t]=n})}function fe(e,t,n,a){n=n||b.jF.G10,e=e||{};const s=function(e,t){let n={};return t||([b.jF.G10,b.jF.WHITE].includes(e)?n={...n,...he}:[b.jF.G90,b.jF.G100].includes(e)&&(n={...n,...ge})),n}(n,a=a||!1),r={...s,...e};Object.entries(r).forEach(([t,n])=>{t.startsWith("$")&&!n.match(de)&&(console.warn(`${w.qI} You tried to call "updateCSSVariables" with an invalid value for "${t}": "${e[t]}". You must use hexadecimal values for colors.`),delete r[t])});const o=function(e,t){const n={},a=e["BASE-primary-color"],s=e["BASE-secondary-color"],r=e["BASE-accent-color"];if(a){n["PRIMARY-color"]=a,n["PRIMARY-color-text"]=ie(a),n["PRIMARY-color-hover"]=ce(a,-8),n["PRIMARY-color-active"]=ce(a,-10);const e=r||te.bm,s=t===b.jF.G90||t===b.jF.G100?te.ON:e;let o;o=re(a,s)>=ae?s:s!==e&&re(a,e)>=ae?e:s!==te.ON&&re(a,te.ON)>=ae?te.ON:te.Xx,o!==s&&(n["PRIMARY-color-focus"]=o)}if(s?(n["SECONDARY-color"]=s,n["SECONDARY-color-text"]=ie(s)):t!==b.jF.G90&&t!==b.jF.G100||(n["SECONDARY-color"]=`var(${ue}layer-02)`,n["SECONDARY-color-text"]=`var(${ue}text-primary);`),r){const e=me[t],a=ce(r,40),s=ce(r,-8),o=ce(r,-20);pe(n,e.blue20,a),pe(n,e.blue60,r),pe(n,e.blue60Hover,s),pe(n,e.blue80,o),n["LAUNCHER-color-background"]=r,n["LAUNCHER-color-background-hover"]=s,n["LAUNCHER-color-background-active"]=o,n["LAUNCHER-EXPANDED-MESSAGE-color-background"]=r,n["LAUNCHER-EXPANDED-MESSAGE-color-hover"]=s,n["LAUNCHER-EXPANDED-MESSAGE-color-active"]=o,n["ACCENT-color"]=r;const i=se(r);n["ACCENT-color-r"]=i[0].toString(),n["ACCENT-color-g"]=i[1].toString(),n["ACCENT-color-b"]=i[2].toString(),n["ACCENT-color-ghost-text"]=r;const c=ie(r);n["ACCENT-color-text"]=c,n["ACCENT-color-background-hover"]=s,n["ACCENT-color-background-active"]=o,n["LAUNCHER-color-focus-border"]=c,n["LAUNCHER-color-avatar"]=c,n["LAUNCHER-EXPANDED-MESSAGE-color-text"]=c,n["LAUNCHER-EXPANDED-MESSAGE-color-focus-border"]=c,n["LAUNCHER-MOBILE-color-text"]=c,n["ACCENT-color-bw"]=c,n["ACCENT-color-bw-hover"]=ce(c,-8),n["ACCENT-color-bw-active"]=ce(c,-10),n["ACCENT-color-bw-inverse"]=c===te.Xx?te.ON:te.Xx,n["ACCENT-color-bw-gray"]=c===te.Xx?te.Um:te.Tc,n["ACCENT-color-pastel"]=c===te.Xx?ce(r,20):ce(r,-15)}return n}(t||{},n);return Object.entries(o).forEach(([t,n])=>{""!==n&&void 0===e[t]&&(r[t]=n)}),r}function Se(e){let t;switch(e?.carbonTheme){case b.jF.WHITE:t=le.ps.WHITE;break;case b.jF.G10:t=le.ps.G10;break;case b.jF.G90:t=le.ps.G90;break;case b.jF.G100:t=le.ps.G100;break;default:t=le.ps.G10}return e?.useAITheme&&(t+=" WAC--aiTheme"),t}function ye(e,t){const{activeTour:n}=t.persistedToBrowserStorage.launcherState;return!(e.tour&&!n&&((0,g.yA)("Error changing the view. The new view was supposed to show a tour however there is no active tour to show. Changing the view has been canceled."),1))}var Ce=n(9633),Ee=n(8795),_e=n(577);const Ae=new Set(Object.values(Ee.k)),ve=`[updateCSSVariables] The AI theme is enabled and only ${Object.values(Ee.k).join(", ")} can be updated.`;class Te{constructor(e){this.hydrating=!1,this.restarting=!1,this.alreadyHydrated=!1,this.chunkQueue=[],this.serviceManager=e}async hydrateChat(e,t,n){let a=!1;try{this.hydrationPromise||(this.hydrating=!0,this.hydrationPromise=this.doHydrateChat(e,t,n),a=!0),await this.hydrationPromise}finally{this.hydrating=!1}a&&await this.serviceManager.fire({type:m.xp.CHAT_READY})}async doHydrateChat(e,t,n){let a;(0,g.cY)("Hydrating Carbon AI chat",e,t,n);const{serviceManager:s}=this;s.store.dispatch(l.Ay.addIsHydratingCounter(1)),this.alreadyHydrated||(a=await this.serviceManager.historyService.loadHistory(),s.humanAgentService?((0,g.cY)("Initializing the human agent service"),await s.humanAgentService.initialize()):(0,g.cY)("No service desk integrations present"));const{config:r}=s.store.getState();if(a)s.store.dispatch(l.Ay.hydrateMessageHistory(a.messageHistory)),await this.createElementsForUserDefinedResponses(a.messageHistory),a.latestPanelLocalMessageItem&&this.openResponsePanel(a.latestPanelLocalMessageItem,!0);else if(!e){const e=s.store.getState();e.homeScreenConfig?.is_on?s.store.dispatch(l.Ay.setHomeScreenIsOpen(!0)):r.public.messaging?.skipWelcome||await s.actions.send((0,J.Sq)(),m.vW.WELCOME_REQUEST,{returnBeforeStreaming:!0},!0)}if(e&&(s.store.dispatch(l.Ay.setHomeScreenIsOpen(!1)),await s.actions.send(e,t,n,!0)),s.store.dispatch(l.Ay.chatWasHydrated()),s.store.dispatch(l.Ay.addIsHydratingCounter(-1)),a){const e=(0,K.ns)(a.messageHistory.botMessageState.localMessageIDs),t=a.messageHistory.allMessageItemsByID[e],n=a.messageHistory.allMessagesByID[t?.fullMessageID];!(0,J.Dc)(t)&&(0,J.ks)(n)&&s.messageService.resendMessage(n,t.ui_state.id)}const o=r.public.serviceDesk.allowReconnect??!0;this.serviceManager?.humanAgentService?.handleHydration(o,Boolean(a)),this.alreadyHydrated=!0}getPublicWebChatState(){const e=this.serviceManager.store.getState(),{persistedToBrowserStorage:t}=e,{chatState:n,launcherState:a}=t;return{isConnectedWithHumanAgent:n.agentState.isConnected,isWebChatOpen:a.viewState.mainWindow,isConnectingWithHumanAgent:e.agentState.isConnecting,isHomeScreenOpen:n.homeScreenState.isHomeScreenOpen,isDebugEnabled:(0,g.Tl)(),hasUserSentMessage:n.hasSentNonWelcomeMessage,isTourActive:a.activeTour,viewState:{...a.viewState},serviceDesk:{isConnected:n.agentState.isConnected,isConnecting:e.agentState.isConnecting,isSuspended:n.agentState.isSuspended??!1},locale:this.serviceManager.store.getState().locale,intl:this.serviceManager.intl}}async sendWithCatch(e,t,n={},a=!1){try{await this.send(e,t,n,a)}catch(e){(0,g.yA)("An error occurred sending the message",e)}}async send(e,t,n={},a=!1){const s="string"==typeof e?(0,J.r2)(e):e;this.serviceManager.store.getState().persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen&&this.serviceManager.store.dispatch(l.Ay.setHomeScreenIsOpen(!1)),this.serviceManager.store.getState().responsePanelState.isOpen&&this.serviceManager.store.dispatch(l.Ay.setResponsePanelIsOpen(!1)),this.hydrationPromise||a?(a||await this.hydrationPromise,await this.doSend(s,t,n)):await this.hydrateChat(s,t,n)}async doSend(e,t,n={}){const{store:a}=this.serviceManager;(0,J.Wf)(e);const s=e.history?.label||e.input.text;n.silent&&(e.history.silent=!0);const r=(0,C.A)(e,s);e.history.silent?a.dispatch(l.Ay.addMessage(e)):a.dispatch(l.Ay.addLocalMessageItem(r,e,!0)),n.setValueSelectedForMessageID&&a.dispatch(l.Ay.messageSetOptionSelected(n.setValueSelectedForMessageID,e)),(0,M.o)(e),await this.serviceManager.messageService.send((0,c.A)(e),t,r.ui_state.id,n)}async receive(e,t=!1,n,a){const{restartCount:s}=this.serviceManager;e.id||(e.id=(0,Z.u)(_e.y.MESSAGE));const r={type:m.xp.PRE_RECEIVE,data:e};if(await this.serviceManager.fire(r),s!==this.serviceManager.restartCount)return;if(t||this.serviceManager.store.dispatch(l.Ay.updateHasSentNonWelcomeMessage(!0)),s!==this.serviceManager.restartCount)return;const{languagePack:o}=this.serviceManager.store.getState();if((0,J.Sv)(e))this.processMessageResponse(e,t,n,a).catch(e=>{(0,g.yA)("Error processing the message response",e)});else{const t=(0,J.Z2)(o.errors_singleMessage,e.thread_id,Ce.sP.INLINE_ERROR);this.receive(t,!1)}(0,M.o)(e),await this.serviceManager.fire({type:m.xp.RECEIVE,data:e})}async removeMessages(e){this.serviceManager.store.dispatch(l.Ay.removeMessages(e))}async insertHistory(e){const t=this.serviceManager.mainWindow?.getMessagesScrollBottom(),n=this.serviceManager.store.getState(),a={notes:[{body:e}]},s=await this.serviceManager.historyService.loadHistory(a),r={allMessageItemsByID:n.allMessageItemsByID,allMessagesByID:n.allMessagesByID,botMessageState:n.botMessageState},o=(0,i.A)({},s.messageHistory,r);o.botMessageState.messageIDs=[...s.messageHistory.botMessageState.messageIDs,...r.botMessageState.messageIDs],o.botMessageState.localMessageIDs=[...s.messageHistory.botMessageState.localMessageIDs,...r.botMessageState.localMessageIDs],this.serviceManager.store.dispatch(l.Ay.hydrateMessageHistory(o)),await this.createElementsForUserDefinedResponses(s.messageHistory),this.serviceManager.mainWindow?.doAutoScroll({scrollToBottom:t})}async receiveChunk(e,t,n={}){const a=(0,ee.H)();return this.chunkQueue.push({chunk:e,messageID:t,options:n,chunkPromise:a}),1===this.chunkQueue.length&&this.processChunkQueue(),a}async processChunkQueue(){const{chunk:e,options:t,chunkPromise:n}=this.chunkQueue[0];let{messageID:a}=this.chunkQueue[0];const s=(0,J.XV)(e),r=(0,J.f9)(e),{store:o}=this.serviceManager,i=o.getState().botInputState.stopStreamingButtonState.isVisible;if(r&&e.partial_item.streaming_metadata.cancellable&&!i&&o.dispatch(l.Ay.setStopStreamingButtonVisible(!0)),s||r){a||(a=e.streaming_metadata.response_id),o.getState().allMessagesByID[a]||o.dispatch(l.Ay.streamingStart(a));const n=e.partial_item||e.complete_item;if(o.dispatch(l.Ay.streamingAddChunk(a,n,s,t.disableFadeAnimation??!0)),e.partial_response?.history){if(Object.keys(e.partial_response).length>1)throw new Error('The partial_response object only supports the "history" property.');o.dispatch(l.Ay.streamingMergeHistory(a,e.partial_response?.history))}await this.handleUserDefinedResponseItemsChunk(a,e,n)}else(0,J.kZ)(e)&&this.receive(e.final_response,t.isLatestWelcomeNode,null,{disableFadeAnimation:!0});(s||(0,J.kZ)(e))&&i&&(o.dispatch(l.Ay.setStopStreamingButtonDisabled(!1)),o.dispatch(l.Ay.setStopStreamingButtonVisible(!1))),this.chunkQueue.shift(),n.doResolve(),this.chunkQueue[0]&&this.processChunkQueue()}getOrCreateUserDefinedElement(e){let t=this.serviceManager.userDefinedElementRegistry.get(e);return t||(t={element:document.createElement("div"),slotName:`slot-user-defined-${(0,Z.u)()}`},t.element.setAttribute("slot",t.slotName),this.serviceManager.userDefinedElementRegistry.set(e,t)),t}async handleUserDefinedResponseItems(e,t){if((0,J.OL)(e.item)){let n,a;e.item.user_defined?.silent||({element:n,slotName:a}=this.getOrCreateUserDefinedElement(e.ui_state.id));const s={type:m.xp.USER_DEFINED_RESPONSE,data:{message:e.item,fullMessage:t,element:n,slot:a,fullWidth:!1}};await this.serviceManager.fire(s),s.data.fullWidth&&this.serviceManager.store.dispatch(l.Ay.setMessageUIProperty(e.ui_state.id,"fullWidth",!0))}else if((0,J.bY)(e.item)){const{itemsLocalMessageItemIDs:n,bodyLocalMessageItemIDs:a,footerLocalMessageItemIDs:s,gridLocalMessageItemIDs:r}=e.ui_state,{allMessageItemsByID:o}=this.serviceManager.store.getState(),i=e=>{const n=o[e];return this.handleUserDefinedResponseItems(n,t)};r?.length&&await(0,K.PQ)(r,e=>(0,K.PQ)(e,e=>(0,K.PQ)(e,e=>i(e)))),n?.length&&await(0,K.PQ)(n,i),a?.length&&await(0,K.PQ)(a,i),s?.length&&await(0,K.PQ)(s,i)}}async handleUserDefinedResponseItemsChunk(e,t,n){if((0,J.OL)(n)){const{store:a}=this.serviceManager,s=(0,J.xN)(e,n);let r,o;n.user_defined?.silent||({element:r,slotName:o}=this.getOrCreateUserDefinedElement(s));const i={type:m.xp.CHUNK_USER_DEFINED_RESPONSE,data:{messageItem:n,chunk:t,element:r,slot:o,fullWidth:!1}};await this.serviceManager.fire(i),a.getState().allMessageItemsByID[s].ui_state.fullWidth!==i.data.fullWidth&&a.dispatch(l.Ay.setMessageUIProperty(s,"fullWidth",i.data.fullWidth))}}async processMessageResponse(e,t,n,a={}){const{store:s}=this.serviceManager,{config:r}=s.getState(),o=this.serviceManager.restartCount,i=e.output.generic;e.request_id=n?.id,(0,J.Wf)(e),s.dispatch(l.Ay.addMessage(e));let c=null;for(let n=0;n<i.length&&o===this.serviceManager.restartCount;n++){const u=i[n];if(u){const n=(0,J.Ll)(u),i=(0,J.$H)(u),d=(0,J.Xk)(u),h=(0,E.CL)(u,e,t,a.disableFadeAnimation);if(d&&(a.skipTourCard||u.user_defined?.skip_card)){const e=a.skipTourCard?m.h4.START_TOUR_METHOD:m.h4.SKIP_CARD,{viewState:t}=s.getState().persistedToBrowserStorage.launcherState;if(t.mainWindow){const t=a.skipTourCard?m.MX.CALLED_START_TOUR:m.MX.TOUR_SKIP_CARD;this.startTour(h,e,{mainWindowCloseReason:t}).catch(e=>{(0,g.yA)("Error starting the tour",e)})}else{const t=a.skipTourCard?m.ey.CALLED_START_TOUR:m.ey.TOUR_SKIP_CARD;this.startTour(h,e,{viewChangeReason:t}).catch(e=>{(0,g.yA)("Error starting the tour",e)})}}else!d&&a.skipTourCard&&(0,g.yA)("The message response received was not a tour, so the tour card was not skipped nor was a tour started by the startTour() call.");const p=[];if((0,E.aT)(h,e,!1,p,!0),s.dispatch(l.Ay.addNestedMessages(p)),i&&(0,J.Sv)(e)){if(s.dispatch(l.Ay.addIsTypingCounter(1)),!(0,J.Rt)(r)){const e='Web chat received a "connect_to_agent" message but there is no service desk configured. Check your chat configuration.';this.errorOccurred({errorType:b.sO.INTEGRATION_ERROR,message:e}),s.dispatch(l.Ay.setMessageHistoryProperty(h.fullMessageID,"agent_no_service_desk",!0))}const t=await(this.serviceManager.humanAgentService?.checkAreAnyAgentsOnline(e));if(o===this.serviceManager.restartCount){s.dispatch(l.Ay.setMessageHistoryProperty(h.fullMessageID,"agent_availability",t));let n=!1;r.public.serviceDesk?.skipConnectAgentCard&&(n=!0),s.dispatch(l.Ay.addIsTypingCounter(-1)),n&&t===_.Gf.ONLINE&&this.serviceManager.humanAgentService.startChat(h,e)}}if(n){const e=(0,J.SP)(u);e&&s.dispatch(l.Ay.addIsTypingCounter(1)),await(0,Q.y)(u.time),e&&o===this.serviceManager.restartCount&&s.dispatch(l.Ay.addIsTypingCounter(-1))}else await this.handleUserDefinedResponseItems(h,e),h.item.user_defined?.silent||o!==this.serviceManager.restartCount||(this.serviceManager.store.dispatch(l.Ay.addLocalMessageItem(h,e,!1,c)),c=h.ui_state.id)}}}openResponsePanel(e,t){this.serviceManager.store.dispatch(l.Ay.setResponsePanelContent(e,t)),this.serviceManager.store.dispatch(l.Ay.setResponsePanelIsOpen(!0))}async insertLocalMessageResponse(e){e.id=(0,Z.u)(_e.y.MESSAGE),await this.processMessageResponse(e,!1,null,{})}updateLanguagePack(e){const{languagePack:t,locale:n}=this.serviceManager.store.getState(),a={...t,...e};f(this.serviceManager,n,a)}addNotification(e){this.serviceManager.store.dispatch(l.Ay.addNotification(e))}removeNotification(e){this.serviceManager.store.dispatch(l.Ay.removeNotifications({groupID:e}))}removeAllNotifications(){this.serviceManager.store.dispatch(l.Ay.removeAllNotifications())}updateCSSVariables(e,t={}){const{store:n}=this.serviceManager,{theme:a}=n.getState(),{carbonTheme:s,useAITheme:r}=a;if(r){const n=e;e={},t={},n&&Object.entries(n).forEach(([t])=>{Ae.has(t)?e[t]=n[t]:(0,g.OP)(ve)})}else e={...e},t={...t};const o=fe(e,t,s,r);n.dispatch(l.Ay.updateCSSVariables(o,e,t))}updateBotName(e){this.serviceManager.store.dispatch(l.Ay.updateBotName(e))}updateMainHeaderTitle(e){this.serviceManager.store.dispatch(l.Ay.updateMainHeaderTitle(e))}updateBotAvatarURL(e){this.serviceManager.store.dispatch(l.Ay.updateBotAvatarURL(e))}updateHomeScreenConfig(e){this.serviceManager.store.dispatch(l.Ay.updateHomeScreenConfig(e))}updateLauncherConfig(e){this.serviceManager.store.dispatch(l.Ay.updateLauncherConfig(e))}async changeView(e,t,n=!0,s=!1){const{store:r}=this.serviceManager,{viewState:o}=r.getState().persistedToBrowserStorage.launcherState;let i=function(e,t){const{viewState:n}=t.persistedToBrowserStorage.launcherState;let a;return a="string"==typeof e?{...W,[e]:!0}:{...n,...e},a}(e,r.getState());return ye(i,r.getState())?((0,a.A)(i,o)&&!s||(await this.fireViewChangeEventsAndChangeView(i,t),i=r.getState().persistedToBrowserStorage.launcherState.viewState,n&&(i.mainWindow||i.tour)&&!r.getState().isHydrated&&this.hydrateChat().catch(e=>{(0,g.yA)("Error hydrating the chat",e)})),i):o}async fireViewChangeEventsAndChangeView(e,t){const{store:n}=this.serviceManager;if(n.getState().viewChanging)throw new Error("The view may not be changed while a view change event is already running. Please make sure to resolve any promises from these events.");n.dispatch(l.Ay.setViewChanging(!0));const{viewState:a}=n.getState().persistedToBrowserStorage.launcherState,{viewChangeReason:s}=t,r=(0,M.o)(a);try{const t={type:m.xp.VIEW_PRE_CHANGE,reason:s,oldViewState:r,newViewState:e,cancelViewChange:!1};if(await this.serviceManager.fire(t),t.cancelViewChange)return void(0,g.cY)("The view changing was cancelled by a view:pre:change event.");if(!ye(t.newViewState,n.getState()))return;e=t.newViewState,n.dispatch(l.Ay.setViewState((0,M.o)(e)));const a={type:m.xp.VIEW_CHANGE,reason:s,oldViewState:r,newViewState:e,cancelViewChange:!1};if(await this.serviceManager.fire(a),a.cancelViewChange)return n.dispatch(l.Ay.setViewState(r)),void(0,g.cY)("The view changing was cancelled by a view:change event.");if(!ye(a.newViewState,n.getState()))return void n.dispatch(l.Ay.setViewState(r));e=a.newViewState,n.dispatch(l.Ay.setViewState((0,M.o)(e)))}finally{n.dispatch(l.Ay.setViewChanging(!1))}}async startTour(e,t,n){this.serviceManager.store.dispatch(l.Ay.setTourData(e.fullMessageID)),(await this.changeView(S.qi.TOUR,n)).tour&&(await this.serviceManager.fire({type:m.xp.TOUR_START,reason:t}),await this.serviceManager.fire({type:m.xp.TOUR_STEP,step:this.serviceManager.store.getState().tourState.activeTourStepItems[0]}))}async endTour(e){const{viewState:t}=this.serviceManager.store.getState().persistedToBrowserStorage.launcherState;let n=t;return t.tour&&(n=await this.changeView(S.qi.LAUNCHER,e)),!n.tour&&(this.serviceManager.store.dispatch(l.Ay.clearTourData()),!0)}goToSpecificTourStep(e){const{activeTourStepItems:t}=this.serviceManager.store.getState().tourState,n=t.findIndex(t=>t.step_id===e);n?this.changeStepInTour({newStepIndex:n}):(0,g.yA)(`No step with the id "${e}" was found within the current tour. As a result, goToTourStep() did not change the current tour step.`)}async changeStepInTour(e){const{store:t}=this.serviceManager,{activeTourStepItems:n}=t.getState().tourState,{activeTourCurrentStepIndex:a}=t.getState().persistedToBrowserStorage.chatState.persistedTourState;let{newStepIndex:s}=e;e.nextStep?s=a+1:e.previousStep&&(s=a-1),t.dispatch(l.Ay.changeStepInTour(s));const r=t.getState().persistedToBrowserStorage.chatState.persistedTourState.activeTourCurrentStepIndex;r===s?await this.serviceManager.fire({type:m.xp.TOUR_STEP,step:n[r]}):(0,g.OP)("The tour tried to change to a step that was out of bounds for the step array, so no step change was made.")}errorOccurred(e){(0,g.yA)("An error has occurred",e),e.catastrophicErrorType&&this.serviceManager.store.dispatch(l.Ay.setAppStateValue("catastrophicErrorType",e.catastrophicErrorType)),(0,g.MO)(this.serviceManager.additionalChatParameters.onError,e)}async restartConversation(e={}){const{skipHydration:t=!1,endAgentConversation:n=!0,fireEvents:a=!0}=e;if((0,g.cY)("Restarting conversation"),this.restarting)(0,g.OP)("You cannot restart a conversation while a previous restart is still pending.");else{this.restarting=!0;try{const{serviceManager:e}=this,{store:s}=e;a&&await e.fire({type:m.xp.PRE_RESTART_CONVERSATION}),e.restartCount++,this.hydrating&&await this.hydrationPromise;const r=s.getState(),{persistedToBrowserStorage:o}=r,{viewState:i}=o.launcherState,{isConnecting:c}=r.agentState,{isConnected:u}=r.persistedToBrowserStorage.chatState.agentState;(u||c)&&n&&await e.humanAgentService.endChat(!0,!1,!1),i.tour&&await this.serviceManager.actions.changeView(S.qi.MAIN_WINDOW,{mainWindowOpenReason:m.eg.CALLED_RESTART_CONVERSATION},!1),this.serviceManager.instance.updateAssistantInputFieldVisibility(!0),this.serviceManager.messageService.cancelAllMessageRequests(),s.dispatch(l.Ay.restartConversation()),t||(this.hydrationPromise=null),a&&await e.fire({type:m.xp.RESTART_CONVERSATION}),this.hydrating&&await this.hydrationPromise,t||e.store.getState().isHydrated?s.dispatch(l.Ay.chatWasHydrated()):(this.hydrationPromise=null,s.getState().persistedToBrowserStorage.launcherState.viewState.mainWindow&&await e.actions.hydrateChat())}finally{this.restarting=!1}}}async destroySession(e){const{store:t}=this.serviceManager,{persistedToBrowserStorage:n}=t.getState(),a=n.launcherState.viewState,s=(0,c.A)(U);e?(s.launcherState.viewState=a,a.tour&&(s.launcherState.viewState={...a,tour:!1,mainWindow:!0})):s.launcherState.viewState=k,this.serviceManager.messageService.cancelAllMessageRequests(),this.serviceManager.userSessionStorageService.clearLauncherSession(),this.serviceManager.userSessionStorageService.clearChatSession(),this.serviceManager.store.dispatch(l.Ay.setAppStateValue("persistedToBrowserStorage",s))}agentEndConversation(e){return this.serviceManager.humanAgentService.endChat(e)}agentUpdateIsSuspended(e){this.serviceManager.store.dispatch((0,A.A9)(e))}async createElementsForUserDefinedResponses(e){await(0,K.PQ)(Object.values(e.allMessageItemsByID),t=>{const n=e.allMessagesByID[t.fullMessageID];return this.handleUserDefinedResponseItems(t,n)})}}const Ie="The event handler is not a function.";class we{constructor(){this.handlersByType=new Map,this.eventsTypesRunning=new Set,this.eventsRunningCount=0}async fire(e,t){Me("Before fire",e);const{type:n}=e;if(!n)throw new Error(`Attempted to fire an event with no type! ${JSON.stringify(e)}`);if(this.eventsTypesRunning.has(n))throw new Error(`An event of type ${n} is already running. Please make sure that you have resolved the Promises for any earlier events that were fired.`);try{this.eventsRunningCount++;try{this.eventsTypesRunning.add(n);const a=this.handlersByType.get(n);if(a&&a.length){const s=a.slice();await(0,K.PQ)(s,function(a){const s=a(e,t);return!s||s instanceof Promise||(0,g.OP)(`An event handler for event ${n} returned a non-promise. This might be a mistake.`,s),s})}}finally{this.eventsTypesRunning.delete(n)}}finally{this.eventsRunningCount--,this.waitForEmptyPromise&&0===this.eventsRunningCount&&this.waitForEmptyPromise.doResolve()}Me("After fire",e)}fireSync(e,t){Me("Before fire",e);const{type:n}=e,a=this.handlersByType.get(n);a&&a.length&&a.slice().forEach(n=>n(e,t)),Me("After fire",e)}async waitForEmpty(){0!==this.eventsRunningCount&&(this.waitForEmptyPromise||(this.waitForEmptyPromise=(0,ee.H)()),await this.waitForEmptyPromise,this.waitForEmptyPromise=null)}on(e){return(0,K._j)(e).forEach(({type:e,handler:t})=>{if(!e)throw new Error(`Attempted to listen to an event with no type: "${e}"!`);if("function"==typeof t){this.handlersByType.has(e)||this.handlersByType.set(e,[]);const n=this.handlersByType.get(e);(0,g.d8)(`[EventBus] Adding ${e} event handler`,t),n.push(t)}else(0,g.yA)(Ie,t)}),this}off(e){return(0,K._j)(e).forEach(({type:e,handler:t})=>{const n=this.handlersByType.get(e);if(n)if(t){const a=n.indexOf(t);if(-1!==a){const t=n.splice(a,1);(0,g.d8)(`[EventBus] Removing ${e} event handlers`,t)}}else(0,g.d8)(`[EventBus] Removing all ${e} event handlers`),this.handlersByType.set(e,[])}),this}once(e){return(0,K._j)(e).forEach(({type:e,handler:t})=>{if("function"==typeof t){const n=(a,s)=>(this.off({type:e,handler:n}),t(a,s));this.on({type:e,handler:n})}else(0,g.yA)(Ie,t)}),this}logListeners(){this.handlersByType.forEach((e,t)=>{console.group(`Event ${t} (${e.length})`),e.forEach(e=>{(0,g.aO)("Listener",e)}),console.groupEnd()})}clear(){return this.handlersByType.clear(),this}}function Me(e,t){if((0,g.Tl)()){const n=(0,c.A)(t);(0,g.cY)(`[EventBus] ${e}`,n)}}function be(e){const t={open(t=O){const{store:n}=e;n.dispatch(l.Ay.setCustomPanelConfigOptions(t)),n.dispatch(l.Ay.setCustomPanelOpen(!0))},close(){e.store.dispatch(l.Ay.setCustomPanelOpen(!1))}};return Object.freeze(t)}var Re=n(3092);class Ne{constructor(e){this.serviceManager=e}async loadHistory(e){const t=this.serviceManager.store.getState(),{config:n,persistedToBrowserStorage:a}=t,s=n.public,{viewState:r}=a.launcherState;try{let t;if(e)t=e;else if(s.messaging?.customLoadHistory){t={notes:[{body:await s.messaging.customLoadHistory(this.serviceManager.instance)}]}}if(t){const e=t?.notes;return async function(e,t){const n={},a={},s={serviceManager:t,allMessages:[],allMessagesByID:a,allLocalMessagesByID:n,threadMessagesByThreadID:{},responsesByRequestID:{},relatedMessageByID:{},localMessagesByOriginalMessageID:{},lastThreadID:null,loadedHistory:{messageHistory:{allMessageItemsByID:n,allMessagesByID:a,botMessageState:null},latestTransferToAgentResponse:null,latestPanelLocalMessageItem:null}};return await async function(e,t){const{allMessages:n,allMessagesByID:a,responsesByRequestID:s,relatedMessageByID:r,serviceManager:o,localMessagesByOriginalMessageID:i}=t;if(!e?.length)return;e.forEach(e=>{e.body.forEach(e=>{const{message:n}=e;(0,J.U7)(n)||!(0,J.ks)(n)&&!(0,J.Sv)(n)||function(e,t,n){e.history=e.history||{},e.history.from_history=!0,e.history.timestamp=new Date(n.time).getTime(),e.thread_id!==J.R2&&(t.lastThreadID=e.thread_id),t.allMessagesByID[e.id]=e,t.allMessages.push(e)}(n,t,e)})});for(let e=n.length-1;e>=0;e--){const t=n[e];t.history?.file_upload_status===S.aT.UPLOADING&&(t.history.file_upload_status=S.aT.COMPLETE,t.history.error_state=Re.J.FAILED),(0,J.Sv)(t)&&t.history.silent?(n.splice(e,1),delete a[t.id]):(i[t.id]=[],(0,J.Sv)(t)&&t.request_id&&(s[t.request_id]=t),t.history.related_message_id&&(r[t.history.related_message_id]=t))}if(!n.length)return;Object.freeze(n);const c={type:m.xp.HISTORY_BEGIN,messages:n};await o.eventBus.fire(c,o.instance),n.forEach(M.o),await o.eventBus.fire({type:m.xp.HISTORY_END,messages:n},o.instance)}(e,s),s.allMessages.length?(function(e){const{allMessages:t,allLocalMessagesByID:n,localMessagesByOriginalMessageID:a}=e;t.forEach(t=>{if((0,J.ks)(t)){if(!t.history?.silent){const e=t.history?.label||t.input.text,s=(0,C.A)(t,e);a[t.id].push(s),n[s.ui_state.id]=s}}else{const s=function(e){return(0,J.Sv)(e)?e.output.generic:null}(t);s?.length&&s.forEach(s=>{if(!(0,J.Ll)(s)){const r=(0,E.CL)(s,t,!1);if(a[t.id].push(r),n[r.ui_state.id]=r,(0,J.bY)(r.item)){const n=[];(0,E.aT)(r,t,!0,n,!0),n.forEach(t=>{const n=t.ui_state.id;e.loadedHistory.messageHistory.allMessageItemsByID[n]=t})}}})}!function(e,t){const{threadMessagesByThreadID:n}=t;let a=n[J.R2];a||(a=[],n[J.R2]=a),a.push(e)}(t,e)})}(s),function(e){const{loadedHistory:t,threadMessagesByThreadID:n,localMessagesByOriginalMessageID:a}=e;t.messageHistory.botMessageState=function(e,t){const n=[],a=[];return e&&e.forEach(e=>{a.push(e.id),t[e.id].forEach(e=>{n.push(e.ui_state.id)})}),{...F,localMessageIDs:n,messageIDs:a}}(n[J.R2],a)}(s),function(e){const{responsesByRequestID:t,threadMessagesByThreadID:n,localMessagesByOriginalMessageID:a}=e,s=n[J.R2],r=(0,K.Uk)(s,e=>(0,J.ks)(e)&&e.history.is_welcome_request);if(r){const e=t[r.id];e&&a[e.id].forEach(e=>{e.ui_state.isWelcomeResponse=!0})}}(s),function({allMessages:e,relatedMessageByID:t,localMessagesByOriginalMessageID:n}){e.forEach(e=>{(0,J.Sv)(e)&&n[e.id].forEach(n=>{if((0,J.$Q)(n.item)){const a=t[e.id];(0,J.ks)(a)&&(n.ui_state.optionSelected=a)}else if((0,J.Of)(n)){const a=t[e.id];(0,J.ks)(a)&&(n.ui_state.originalUserText=a.history.label)}})})}(s),s.loadedHistory):null}(e,this.serviceManager)}r.tour&&(await this.serviceManager.actions.changeView(S.qi.MAIN_WINDOW,{mainWindowOpenReason:m.eg.SESSION_HISTORY},!1),this.serviceManager.store.dispatch(l.Ay.clearTourData()))}catch(e){(0,g.yA)("An error occurred while attempting to load the conversation history",e)}return null}}class Oe{start(e,t,n,a,s){this.hasExceededMaxSilentLoading=!1,this.onEnd=t,this.onSilentLoading=setTimeout(()=>{this.hasExceededMaxSilentLoading=!0,e()},a),this.onMaxAttempt=setTimeout(()=>{n()},s)}end(){this.onMaxAttempt&&clearTimeout(this.onMaxAttempt),this.onSilentLoading&&clearTimeout(this.onSilentLoading),this.onEnd&&this.onEnd(this.hasExceededMaxSilentLoading),this.hasExceededMaxSilentLoading=null,this.onEnd=null}}const Pe=[1e3,3e3,5e3];var De;!function(e){e[e.SILENT=1]="SILENT",e[e.VISIBLE=2]="VISIBLE"}(De||(De={}));class Be{constructor(e,t){this.pendingLocale=!1,this.localeIsExplicit=!1,this.serviceManager=e,this.messageLoadingManager=new Oe,this.queue={waiting:[],current:null};const n=t.messaging?.messageTimeoutSecs;this.timeoutMS=n?1e3*n:15e4}async processSuccess(e,t){const{requestOptions:n,isProcessed:a}=e,s=Boolean(e.message.history.is_welcome_request);if(a)return;this.setMessageErrorState(e,Re.J.NONE);const{message:r}=e;t&&(r.input.message_type!==Ce.s9.EVENT&&(s||this.messageLoadingManager.end(),t.history=t.history||{},t.history.timestamp=t.history.timestamp||Date.now(),e.trackData.lastRequestTime=Date.now()-e.timeLastRequest,e.trackData.totalRequestTime=Date.now()-e.timeFirstRequest,await this.serviceManager.actions.receive(t,s,r,n)),this.messageLoadingManager.end()),e.isProcessed||(e.sendMessagePromise.doResolve(),e.isProcessed=!0,this.moveToNextQueueItem())}addErrorMessage(){const{store:e}=this.serviceManager,t=e.getState().languagePack.errors_singleMessage,{originalMessage:n,localMessage:a}=(0,E.fS)(t);e.dispatch(l.Ay.addLocalMessageItem(a,n,!0))}async resendMessage(e,t){await this.send((0,c.A)(e),m.vW.HYDRATE_RESEND,t,{skipQueue:!0,silent:!0})}sendToAssistantAndUpdateErrorState(e){e.isProcessed||(this.sendToAssistant(e),(6e3>Date.now()-e.timeFirstRequest?De.SILENT:De.VISIBLE)===De.VISIBLE&&(this.setMessageErrorState(e,Re.J.RETRYING),this.queue.waiting.forEach(e=>{this.setMessageErrorState(e,Re.J.WAITING)})))}async processError(e,t,n){const{message:a,timeFirstRequest:s,timeLastRequest:r,tryCount:o,isProcessed:i,trackData:c,requestOptions:l}=e,u=a.history.is_welcome_request,d=Date.now()-s,h=this.timeoutMS>d&&o<Pe.length;if(!i)if(c.lastRequestTime=Date.now()-r,c.totalRequestTime=Date.now()-s,h&&n){c.numErrors++;const t=Pe[e.tryCount++];setTimeout(()=>{this.sendToAssistantAndUpdateErrorState(e)},t)}else{let n=!1;u?n=!0:l.silent&&this.addErrorMessage(),this.serviceManager.actions.errorOccurred({errorType:b.sO.MESSAGE_COMMUNICATION,message:"An error occurred sending a message",otherData:t,catastrophicErrorType:n}),this.rejectFinalErrorOnMessage(e,t)}}rejectFinalErrorOnMessage(e,t="An undefined error occurred trying to send your message."){const{sendMessagePromise:n}=e;this.setMessageErrorState(e,Re.J.FAILED);const{message:a}=e;e!==this.queue.current||a.input.message_type===Ce.s9.EVENT||a.history.is_welcome_request||this.messageLoadingManager.end(),n.doReject(new Error(t)),e.isProcessed=!0,e===this.queue.current&&this.moveToNextQueueItem()}async sendToAssistant(e){const{store:t}=this.serviceManager,n=t.getState(),{customSendMessage:a}=n.config.public.messaging;if(e.timeLastRequest=Date.now(),!e.isProcessed)try{const n=(0,c.A)(e.message);e.message=n,t.dispatch(l.Ay.updateMessage(n));const s=new AbortController;e.sendMessageController=s,(0,g.cY)("Called customSendMessage",n),await a(n,{signal:s.signal},this.serviceManager.instance),await this.processSuccess(e,null)}catch(t){(0,g.yA)("An error occurred while sending a message",t);const n=t&&("string"==typeof t?t:JSON.stringify(t))||"There was an unidentified error.";this.processError(e,n,!a)}}async runQueueIfReady(){if(!this.queue.current&&this.queue.waiting.length>0){const{eventBus:e,store:t}=this.serviceManager;this.clearCurrentQueueItem(),this.queue.current=this.queue.waiting.shift();const{current:n}=this.queue,{message:a,source:s}=n,r=t.getState(),{config:o}=t.getState(),{public:i}=o;if(n.timeFirstRequest=Date.now(),a.input.message_type!==Ce.s9.EVENT){if((0,J.Or)(r)&&(a.thread_id=J.R2),!a.history.is_welcome_request){const e=i.messaging?.messageLoadingIndicatorTimeoutSecs||0===i.messaging?.messageLoadingIndicatorTimeoutSecs?1e3*i.messaging.messageLoadingIndicatorTimeoutSecs:4e3;this.messageLoadingManager.start(()=>{this.serviceManager.store.dispatch(l.Ay.addIsLoadingCounter(1))},e=>{e&&this.serviceManager.store.dispatch(l.Ay.addIsLoadingCounter(-1))},()=>{this.cancelMessageRequestByID(a.id,!0)},e,this.timeoutMS)}if(n.isProcessed)return;const o=a.history?.label||a.input.text;if(await e.fire({type:m.xp.PRE_SEND,data:a,source:s},this.serviceManager.instance),n.isProcessed)return;const c=(0,C.A)(a,o,n.localMessageID);a.history.silent||(t.dispatch(l.Ay.updateLocalMessageItem(c)),t.dispatch(l.Ay.updateMessage(a))),(0,M.o)(a),await e.fire({type:m.xp.SEND,data:a,source:s},this.serviceManager.instance)}this.sendToAssistant(n)}}addToMessageQueue(e,t,n,a,s={}){const r={localMessageID:n,message:e,sendMessagePromise:a,requestOptions:s||{},timeFirstRequest:0,timeLastRequest:0,trackData:{numErrors:0,lastRequestTime:0,totalRequestTime:0},tryCount:0,isProcessed:!1,source:t};this.queue.waiting.push(r),this.queue.current&&e.history?.error_state===Re.J.RETRYING&&this.setMessageErrorState(r,Re.J.WAITING)}clearCurrentQueueItem(){this.queue.current&&(this.queue.current=null)}moveToNextQueueItem(){this.clearCurrentQueueItem(),this.runQueueIfReady()}setMessageErrorState(e,t){const{message:n}=e,{allMessagesByID:a}=this.serviceManager.store.getState(),s=a[n.id];if(s){const a=s.history?.error_state;if(a!==t&&(t!==Re.J.NONE||a)){let a;t===Re.J.FAILED&&(a="errors_ariaMessageFailed"),a&&this.serviceManager.store.dispatch(l.Ay.announceMessage({messageID:a})),this.serviceManager.store.dispatch(l.Ay.setMessageErrorState(n.id,t));const{allMessagesByID:s}=this.serviceManager.store.getState();e.message=s[n.id]}}}send(e,t,n,a){e.history.timestamp=e.history.timestamp||Date.now(),e.input=e.input||{},e.input.message_type=e.input.message_type||Ce.s9.TEXT;const s=(0,ee.H)();return this.addToMessageQueue(e,t,n,s,a),this.runQueueIfReady(),s}cancelAllMessageRequests(){for(;this.queue.waiting.length;)this.cancelMessageRequestByID(this.queue.waiting[0].message.id,!1);this.queue.current&&(this.cancelMessageRequestByID(this.queue.current.message.id,!1),this.clearCurrentQueueItem())}async cancelMessageRequestByID(e,t){let n;if(this.queue.current?.message.id===e)n=this.queue.current;else{const t=this.queue.waiting.findIndex(t=>t.message.id===e);-1!==t&&(n=this.queue.waiting[t],this.queue.waiting.splice(t,1))}if(n){const{lastResponse:e,sendMessageController:a}=n;a?.abort("Message was cancelled"),this.rejectFinalErrorOnMessage(n,"Message was cancelled"),t&&this.serviceManager.actions.errorOccurred({errorType:b.sO.MESSAGE_COMMUNICATION,message:"Message was cancelled",otherData:await(0,g.I2)(e)})}}}class Le{constructor(e){this.originalName=e,this.attributeSafe=e,this.suffix=function(e){const t=function(e){return e?e.trim():""}(e);return t?.length?`--${e}`:""}(e)}}class He{constructor(){this.userDefinedElementRegistry=new Map,this.restartCount=0}async fire(e){return this.eventBus.fire(e,this.instance)}}var We=n(5230);let ke={};const xe={getItem(e){return ke[e]},setItem(e,t){ke[e]=t},removeItem(e){delete ke[e]},length:Object.keys(ke).length,clear(){ke={}},key(e){return Object.keys(ke)[e]}},Ue=(0,We.w9)()?window.sessionStorage:xe;class Fe{constructor(e){this.serviceManager=e,this.prefix=`CARBON_CHAT_SESSION${this.serviceManager?.namespace?.suffix||""}`}loadChatSession(){try{const e=Ue.getItem(this.getChatSessionKey()),t=e?JSON.parse(e):null;return t?.version===v?t:(this.clearChatSession(),null)}catch(e){return this.clearChatSession(),null}}loadLauncherSession(){try{const e=Ue.getItem(this.getLauncherSessionKey()),t=e?JSON.parse(e):null;return t?.version===v?(t.wasLoadedFromBrowser=!0,t):(this.clearLauncherSession(),null)}catch(e){return this.clearLauncherSession(),null}}persistChatSession(e){try{Ue.setItem(this.getChatSessionKey(),JSON.stringify(e))}catch(e){(0,g.yA)("Error in persistChatSession",e)}}persistLauncherSession(e){try{Ue.setItem(this.getLauncherSessionKey(),JSON.stringify(e))}catch(e){(0,g.yA)("Error in persistLauncherSession",e)}}clearChatSession(){try{Ue.removeItem(this.getChatSessionKey())}catch(e){(0,g.yA)("Error in clearChatSession",e)}}clearLauncherSession(){try{Ue.removeItem(this.getLauncherSessionKey())}catch(e){(0,g.yA)("Error in clearLauncherSession",e)}}getChatSessionKey(){return this.prefix}getLauncherSessionKey(){return this.prefix}}var Ve=n(2446),$e=n(3582);function Ge(e,t){if(Array.isArray(t))return t}const qe={[A.bf]:(e,t)=>{const{isConnecting:n,localMessageID:a}=t;return{...e,agentState:{...e.agentState,isConnecting:n,activeLocalMessageID:a,numUnreadMessages:n?0:e.agentState.numUnreadMessages},persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,agentState:{...e.persistedToBrowserStorage.chatState.agentState,isSuspended:!!n&&e.persistedToBrowserStorage.chatState.agentState.isSuspended}}}}},[A.KK]:(e,t)=>{const{isReconnecting:n}=t;return{...e,agentState:{...e.agentState,isReconnecting:n}}},[A.dB]:(e,t)=>e.agentState.isConnecting?{...e,agentState:{...e.agentState,availability:e.agentState.isConnecting?t.availability:null}}:e,[A.gW]:(e,{showRequest:t})=>({...e,agentState:{...e.agentState,showScreenShareRequest:t}}),[A.HD]:(e,t)=>{const n={...e.persistedToBrowserStorage.chatState.agentState.agentProfiles},{agentProfile:a}=t;return a&&(n[a.id]=a),{...e,agentState:{...e.agentState,isConnecting:!1,isReconnecting:!1,availability:null},persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,agentState:{...e.persistedToBrowserStorage.chatState.agentState,isConnected:!0,agentProfile:a,agentProfiles:n}}}}},[A.xO]:(e,t)=>({...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,agentState:{...e.persistedToBrowserStorage.chatState.agentState,serviceDeskState:t.state}}}}),[A.j1]:(e,t)=>e.agentState.isConnecting||e.persistedToBrowserStorage.chatState.agentState.isConnected?{...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,agentState:{...e.persistedToBrowserStorage.chatState.agentState,isSuspended:t.isSuspended}}}}:e,[A.Rf]:(e,t)=>({...e,agentState:{...e.agentState,isAgentTyping:t.isTyping}}),[A.G]:e=>({...e,botMessageState:{...e.botMessageState},agentState:{...e.agentState,isAgentTyping:!1},persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,agentState:{...e.persistedToBrowserStorage.chatState.agentState,agentProfile:null}}}}),[A.XF]:(e,t)=>{const n={...e.agentState.inputState,...t.capabilities};return n.allowFileUploads||(n.files=[]),{...e,agentState:{...e.agentState,inputState:n}}},[A.o$]:(e,{isSharing:t})=>({...e,agentState:{...e.agentState,isScreenSharing:t}}),[A.HM]:(e,t)=>({...e,agentState:{...e.agentState,fileUploadInProgress:t.fileUploadInProgress}}),[A.Nj]:e=>{let t=z(e,e.agentState.activeLocalMessageID,"wasAgentChatEnded",!0);return t={...t,agentState:{...t.agentState,isConnecting:!1,isReconnecting:!1,availability:null,activeLocalMessageID:null,isAgentTyping:!1,inputState:{...t.agentState.inputState,isReadonly:!1}},persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,agentState:{...e.persistedToBrowserStorage.chatState.agentState,isConnected:!1,isSuspended:!1,agentProfile:null}}}},t}};function Ye(e){const{activeTourID:t}=e.persistedToBrowserStorage.chatState.persistedTourState;if(t){const n=e.allMessagesByID[t],a=n?.output?.generic?.find(e=>Boolean(e.user_defined?.steps));if(a)return{...e,tourState:{...e.tourState,activeTourStepItems:a.user_defined?.steps}}}return je(e)}function je(e){return{...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,persistedTourState:{activeTourID:null,activeTourCurrentStepIndex:null}},launcherState:{...e.persistedToBrowserStorage.launcherState,activeTour:!1}},tourState:{...e.tourState,activeTourStepItems:null}}}const ze=new Set([Ce.Xb.USER_ENDED_CHAT,Ce.Xb.CHAT_WAS_ENDED,Ce.Xb.RELOAD_WARNING]),Xe={[l.Rj]:(e,t)=>(0,i.A)({},e,t.partialState),[l.vI]:e=>({...e,isHydrated:!0}),[l.wq]:e=>{let t={...e,botMessageState:{...e.botMessageState,localMessageIDs:[],messageIDs:[],isTypingCounter:0,isScrollAnchored:!1},allMessageItemsByID:{},allMessagesByID:{},iFramePanelState:{...D},viewSourcePanelState:{...B},customPanelState:{...P},persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,homeScreenState:{...e.persistedToBrowserStorage.chatState.homeScreenState,showBackToBot:!1}}},isHydrated:!1,catastrophicErrorType:null};return t=je(t),t.homeScreenConfig.is_on&&(t=j(t,!0)),t},[l.Pq]:(e,t)=>{let n={...e,...t.messageHistory};return e.persistedToBrowserStorage.chatState.persistedTourState.activeTourID&&(n=Ye(n)),n},[l.GZ]:(e,t)=>{const{messageItem:n,message:a,addMessage:s,addAfterID:r}=t,{id:o}=n.ui_state,i=a.history.silent;let c=e;s&&(c=X(c,a));const l=c.botMessageState.localMessageIDs.findIndex(e=>e===o),u=[...c.botMessageState.localMessageIDs];let d=l;if(-1!==l?u.splice(l,1):d=u.length,r){const e=u.findIndex(e=>e===r);-1!==e&&(d=e+1)}if(u.splice(d,0,o),!i){c={...c,allMessageItemsByID:{...c.allMessageItemsByID,[o]:n},botMessageState:{...c.botMessageState,localMessageIDs:u}},c.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen&&(c=j(c,!1));const t=!n.item.agent_message_type,s=e.persistedToBrowserStorage.launcherState.viewState.mainWindow;t||s&&e.isBrowserPageVisible||!(0,J.ks)(a)&&!ze.has(n.item.agent_message_type)&&(c={...c,agentState:{...c.agentState,numUnreadMessages:c.agentState.numUnreadMessages+1}})}return c},[l._J]:(e,{messageIDs:t})=>{const n=new Set(t),a={...e.allMessagesByID},s={...e.allMessageItemsByID},r=e.botMessageState.messageIDs.filter(e=>!n.has(e)),o=e.botMessageState.localMessageIDs.filter(e=>{const t=s[e],a=n.has(t?.fullMessageID);return a&&delete s[e],!a});return t.forEach(e=>{delete a[e]}),{...e,allMessagesByID:a,allMessageItemsByID:s,botMessageState:{...e.botMessageState,messageIDs:r,localMessageIDs:o}}},[l.c]:(e,t)=>{const{messageItem:n}=t;return{...e,allMessageItemsByID:{...e.allMessageItemsByID,[n.ui_state.id]:n}}},[l.qu]:(e,t)=>{const{message:n}=t;return{...e,allMessagesByID:{...e.allMessagesByID,[n.id]:n}}},[l.qe]:(e,t)=>{const{message:n}=t,a=n.id;let s=e;if((0,J.Sv)(n)){const t=[];n.output.generic.forEach(e=>{const n=(0,J.xN)(a,e);n&&t.push(n)});const r={...e.allMessageItemsByID},o=[];let i;const c=e.botMessageState.localMessageIDs.filter((n,s)=>{const c=e.allMessageItemsByID[n].fullMessageID===a;return c&&(void 0===i&&(i=s),t.includes(n)?o.push(n):delete r[n]),!c});if(o.length){const e=t.filter(e=>o.includes(e));e.length&&c.splice(i,0,...e)}s={...s,allMessageItemsByID:r,botMessageState:{...s.botMessageState,localMessageIDs:c}}}return X(s,n)},[l.JX]:(e,t)=>{const n={...e.allMessageItemsByID};return n[t.messageID]={...e.allMessageItemsByID[t.messageID],ui_state:{...e.allMessageItemsByID[t.messageID].ui_state,optionSelected:t.sentMessage}},{...e,allMessageItemsByID:n}},[l.YO]:(e,t)=>({...e,botMessageState:{...e.botMessageState,isTypingCounter:Math.max(e.botMessageState.isTypingCounter+t.addToIsTyping,0)}}),[l.FG]:(e,t)=>({...e,botMessageState:{...e.botMessageState,isLoadingCounter:Math.max(e.botMessageState.isLoadingCounter+t.addToIsLoading,0)}}),[l.TD]:(e,t)=>({...e,botMessageState:{...e.botMessageState,isHydratingCounter:Math.max(e.botMessageState.isHydratingCounter+t.addToIsHydrating,0)}}),[l.T0]:(e,t)=>({...e,[t.key]:t.value}),[l.RT]:(e,t)=>({...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,...t.chatState}}}),[l.xi]:(e,t)=>e.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage===t.hasSentNonWelcomeMessage?e:{...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,hasSentNonWelcomeMessage:t.hasSentNonWelcomeMessage},launcherState:{...e.persistedToBrowserStorage.launcherState,hasSentNonWelcomeMessage:t.hasSentNonWelcomeMessage}}},[l.Xi]:(e,t)=>function(e,t){let{agentState:n}=e,{showUnreadIndicator:s}=e.persistedToBrowserStorage.launcherState;return t.mainWindow&&e.isBrowserPageVisible&&(0!==n.numUnreadMessages&&(n={...n,numUnreadMessages:0}),s=!1),{...e,announceMessage:(r=e,o=t,(0,a.A)(r.persistedToBrowserStorage.launcherState.viewState,o)?r.announceMessage:{messageID:o.mainWindow?"window_ariaWindowOpened":"window_ariaWindowClosed"}),agentState:n,persistedToBrowserStorage:{...e.persistedToBrowserStorage,launcherState:{...e.persistedToBrowserStorage.launcherState,viewState:t,showUnreadIndicator:s}}};var r,o}(e,t.viewState),[l.VG]:(e,t)=>({...e,viewChanging:t.viewChanging}),[l.Tp]:(e,t)=>({...e,initialViewChangeComplete:t.changeComplete}),[l.m]:(e,t)=>({...e,botName:t.name,headerDisplayName:e.theme.useAITheme?e.headerDisplayName:t.name}),[l.yM]:(e,t)=>({...e,botAvatarURL:t.url}),[l.By]:(e,t)=>({...e,launcher:{...e.launcher,config:{...e.launcher.config,mobile:{...e.launcher.config.mobile,avatar_url_override:t.source},desktop:{...e.launcher.config.desktop,avatar_url_override:t.source}}}}),[l.NO]:(e,t)=>({...e,headerDisplayName:t.title}),[l._P]:(e,t)=>{const{config:n}=e,{variables:a}=t,s={public:{...n.public}};return{...e,config:s,cssVariableOverrides:a}},[l.Uy]:(e,t)=>{const n=t.homeScreenConfig;return{...e,homeScreenConfig:(0,$e.A)({},e.homeScreenConfig,n,Ge)}},[l.ko]:(e,t)=>z(e,t.localMessageID,t.propertyName,t.propertyValue),[l.iA]:(e,t)=>{const{messageID:n,propertyName:a,propertyValue:s}=t,r=e.allMessagesByID[n];return r?{...e,allMessagesByID:{...e.allMessagesByID,[n]:{...r,history:{...r.history,[a]:s}}}}:e},[l.uc]:(e,t)=>{const n=e.allMessagesByID[t.messageID];return n?{...e,allMessagesByID:{...e.allMessagesByID,[t.messageID]:{...n,history:(0,i.A)({},n.history,t.history)}}}:e},[l.ww]:(e,t)=>({...e,announceMessage:t.message}),[l.Mu]:e=>({...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,disclaimersAccepted:{...e.persistedToBrowserStorage.chatState.disclaimersAccepted,[window.location.hostname]:!0}}}}),[l.Ew]:(e,{isOpen:t})=>j(e,t),[l.gA]:e=>j(e,!e.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen,!0),[l.Cw]:(e,t)=>{const n=(0,i.A)({},e.launcher.config,t.launcherConfig);return{...e,launcher:{...e.launcher,config:n},persistedToBrowserStorage:{...e.persistedToBrowserStorage,launcherState:{...e.persistedToBrowserStorage.launcherState,desktopLauncherIsExpanded:!(!n.is_on||!n.desktop.is_on)&&e.persistedToBrowserStorage.launcherState.desktopLauncherIsExpanded,mobileLauncherIsExtended:!(!n.is_on||!n.mobile.is_on)&&e.persistedToBrowserStorage.launcherState.mobileLauncherIsExtended}}}},[l.c7]:(e,t)=>({...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,launcherState:{...e.persistedToBrowserStorage.launcherState,[t.propertyName]:t.propertyValue}}}),[l.vp]:(e,t)=>{const n={...e,launcher:{...e.launcher,config:{...e.launcher.config}}};return t.launcherType&&t.launcherType!==S.vX.DESKTOP||(n.launcher.config.desktop={...e.launcher.config.desktop,[t.propertyName]:t.propertyValue}),t.launcherType&&t.launcherType!==S.vX.MOBILE||(n.launcher.config.mobile={...e.launcher.config.mobile,[t.propertyName]:t.propertyValue}),n},[l.hU]:(e,t)=>Y(e,{[t.propertyName]:t.propertyValue}),[l.XU]:e=>({...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,launcherState:{...e.persistedToBrowserStorage.launcherState,desktopLauncherIsExpanded:!1,desktopLauncherWasMinimized:!0}}}),[l.qO]:(e,{messageItem:t})=>({...e,iFramePanelState:{...e.iFramePanelState,messageItem:t,isOpen:!0},announceMessage:{messageID:"iframe_ariaOpenedPanel"}}),[l.$z]:e=>({...e,iFramePanelState:{...e.iFramePanelState,isOpen:!1},announceMessage:{messageID:"iframe_ariaClosedPanel"}}),[l.ex]:(e,t)=>({...e,viewSourcePanelState:{...e.viewSourcePanelState,citationItem:t.citationItem,relatedSearchResult:t.relatedSearchResult,isOpen:t.isOpen}}),[l.zM]:(e,t)=>({...e,customPanelState:{...e.customPanelState,isOpen:t.isOpen}}),[l.nS]:(e,t)=>({...e,customPanelState:{...e.customPanelState,options:t.options}}),[l.rq]:(e,t)=>Ye({...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,persistedTourState:{activeTourID:t.newActiveTourMessageID,activeTourCurrentStepIndex:0}},launcherState:{...e.persistedToBrowserStorage.launcherState,activeTour:!0}}}),[l.sK]:e=>je(e),[l.ds]:(e,t)=>({...e,persistedToBrowserStorage:{...e.persistedToBrowserStorage,chatState:{...e.persistedToBrowserStorage.chatState,persistedTourState:{...e.persistedToBrowserStorage.chatState.persistedTourState,activeTourCurrentStepIndex:Math.max(Math.min(t.newStepNumber,e.tourState.activeTourStepItems.length-1),0)}}}}),[l.P9]:(e,t)=>Ke(e,{...Qe(e,t.isInputToAgent),...t.newState},t.isInputToAgent),[l.UC]:(e,t)=>{let n;return n=e.persistedToBrowserStorage.launcherState.viewState.mainWindow&&t.isVisible?0:e.agentState.numUnreadMessages,{...e,isBrowserPageVisible:t.isVisible,agentState:{...e.agentState,numUnreadMessages:n}}},[l.qx]:(e,{file:t,isInputToAgent:n})=>{const a=Qe(e,n);return Ke(e,{...a,files:[...a.files,t]},n)},[l.TP]:(e,{fileID:t,isInputToAgent:n})=>{const a=Qe(e,n),s=[...a.files],r=s.findIndex(e=>e.id===t);return-1!==r&&s.splice(r,1),Ke(e,{...a,files:s},n)},[l.bH]:(e,{localMessageItemID:t})=>{const n=e.botMessageState.localMessageIDs.filter(e=>e!==t),a={...e.allMessageItemsByID};return a[t]&&delete a[t],{...e,allMessageItemsByID:a,botMessageState:{...e.botMessageState,localMessageIDs:n}}},[l._V]:(e,{notification:t,notificationID:n})=>({...e,notifications:e.notifications.concat({id:n,notification:t})}),[l.AM]:(e,{groupID:t,notificationID:n})=>({...e,notifications:e.notifications.filter(e=>n?e.id!==n:e.notification.groupID!==t)}),[l.IE]:e=>({...e,notifications:[]}),[l.vf]:(e,{isInputToAgent:t})=>Ke(e,{...Qe(e,t),files:[]},t),[l.ZB]:(e,{fileID:t,errorMessage:n,isInputToAgent:a})=>{const s=Qe(e,a),r=[...s.files],o=r.findIndex(e=>e.id===t);return-1!==o&&(r[o]={...r[o],isError:!0,errorMessage:n,status:S.aT.COMPLETE}),Ke(e,{...s,files:r},a)},[l.dD]:(e,{localMessageItems:t})=>{const n={...e.allMessageItemsByID};return t.forEach(e=>{n[e.ui_state.id]=e}),{...e,allMessageItemsByID:n}},[l.A$]:(e,{isOpen:t})=>({...e,responsePanelState:{...e.responsePanelState,isOpen:t}}),[l.Mp]:(e,{localMessageItem:t,isMessageForInput:n})=>({...e,responsePanelState:{...e.responsePanelState,localMessageItem:t,isMessageForInput:n}}),[l.iS]:(e,{messageID:t})=>X(e,{id:t,output:{generic:[]},history:{timestamp:Date.now()}}),[l.fO]:(e,{messageID:t,history:n})=>{const a=e.allMessagesByID[t],s=(0,i.A)({},a,{history:n});return a?{...e,allMessagesByID:{...e.allMessagesByID,[t]:s}}:e},[l.HD]:(e,{chunkItem:t,fullMessageID:n,isCompleteItem:a,disableFadeAnimation:s})=>{const r=e.allMessagesByID[n],o=(0,J.xN)(n,t),i=e.allMessageItemsByID[o];let c,{localMessageIDs:l}=e.botMessageState;if(i)a?(c=(0,E.CL)(t,r,!1),c.ui_state.needsAnnouncement=!1,c.ui_state.disableFadeAnimation=s,c.ui_state.streamingState={chunks:[],isDone:!0}):c={...i,ui_state:{...i?.ui_state,streamingState:{...i?.ui_state.streamingState,chunks:[...i?.ui_state.streamingState?.chunks||[],t]}}};else if(c=(0,E.CL)(t,r,!1),c.ui_state.needsAnnouncement=!1,c.ui_state.disableFadeAnimation=s,c.ui_state.isIntermediateStreaming=!0,c.ui_state.streamingState=a?{chunks:[],isDone:!0}:{chunks:[t],isDone:!1},l=[...l,o],!c.item.response_type)throw new Error(`New chunk item does not have a response_type: ${JSON.stringify(t)}`);return{...e,allMessageItemsByID:{...e.allMessageItemsByID,[o]:c},botMessageState:{...e.botMessageState,localMessageIDs:l}}},[l.CA]:(e,{chatHeaderConfig:t})=>({...e,chatHeaderState:{...e.chatHeaderState,config:{...e.chatHeaderState.config,...t}}}),[l.hp]:(e,{maxTotal:t})=>({...e,chatHeaderState:{...e.chatHeaderState,maxVisibleHeaderObjects:t}}),[l.TV]:(e,{isVisible:t})=>({...e,botInputState:{...e.botInputState,stopStreamingButtonState:{...e.botInputState.stopStreamingButtonState,isVisible:t}}}),[l.rJ]:(e,{isDisabled:t})=>({...e,botInputState:{...e.botInputState,stopStreamingButtonState:{...e.botInputState.stopStreamingButtonState,isDisabled:t}}}),[l.Ky]:(e,{currentStreamID:t})=>({...e,botInputState:{...e.botInputState,stopStreamingButtonState:{...e.botInputState.stopStreamingButtonState,currentStreamID:t}}}),[l.Qz]:(e,{config:t})=>({...e,headerAvatarConfig:t})};function Ke(e,t,n){return n?{...e,agentState:{...e.agentState,inputState:t}}:{...e,botInputState:t}}function Qe(e,t){return t?e.agentState.inputState:e.botInputState}Object.assign(Xe,qe);var Ze=n(4774);function Je(e){return!1===et(e).showFrame||We.a3||e.public.themeConfig?.corners===R.L.SQUARE?R.L.SQUARE:G.corners}function et(e){return e.public.themeConfig?.useAITheme?{showFrame:e.public.layout?.showFrame??!0,hasContentMaxWidth:e.public.layout?.hasContentMaxWidth??!0}:(0,i.A)({},q,e.public.layout)}function tt(e,t){return t&&Xe[t.type]?Xe[t.type](e,t):e}const nt={openChatByDefault:!1,showLauncher:!0,shouldTakeFocusIfOpensAutomatically:!0,serviceDesk:{},messaging:{},themeConfig:{useAITheme:!0}};var at=n(5088);r.extend(o);class st{constructor(e,t,n){e?.debug&&(0,g.$Z)("Constructed chat widget",e);const a=(0,i.A)({},nt,e);this.additionalChatParameters=n||{},this.appConfig={public:a},this.customHostElement=t}async start(){try{return(await this.startInternal()).instance}catch(e){return(0,g.yA)("There was an error starting your chat",e),null}}async startInternal(){const e=(0,J.Rt)(this.appConfig);this.serviceManager=await async function(e,t){const n=e.public,a=new He;return a.additionalChatParameters=t,a.namespace=new Le(n.namespace),a.userSessionStorageService=new Fe(a),a.actions=new Te(a),a.eventBus=new we,a.store=function(e,t){let n;n=void 0!==e.public.themeConfig?.useAITheme?e.public.themeConfig?.useAITheme:G.useAITheme;const a={carbonTheme:e.public.themeConfig?.carbonTheme||G.carbonTheme,useAITheme:n,corners:Je(e)},s=(0,g.Hg)(a.useAITheme,e),r={...V,notifications:[],botInputState:{fieldVisible:!0,isReadonly:!1,files:[],allowFileUploads:!1,allowMultipleFileUploads:!1,allowedFileUploadTypes:null,stopStreamingButtonState:{currentStreamID:null,isVisible:!1,isDisabled:!1},isReadonly:e.public.isReadonly,fieldVisible:!e.public.isReadonly},agentState:{...$},botName:s,headerDisplayName:null,botAvatarURL:e.public.botAvatarURL||null,headerAvatarConfig:null,chatWidthBreakpoint:null,chatWidth:null,chatHeight:null,cssVariableOverrides:fe({},{},a.carbonTheme,a.useAITheme),isHydrated:!1,languagePack:Ze.Ay$,locale:"en",config:e,originalConfig:e,suspendScrollDetection:!1,homeScreenConfig:d({}),persistedToBrowserStorage:{...U,chatState:{...U.chatState,homeScreenState:{...U.chatState.homeScreenState}}},launcher:(0,i.A)({},N,{config:(0,i.A)({},{},{mobile:{}},{is_on:e.public.showLauncher})}),iFramePanelState:D,viewSourcePanelState:B,isDestroyed:!1,customPanelState:P,viewChanging:!1,initialViewChangeComplete:!1,targetViewState:e.public.openChatByDefault?x:k,responsePanelState:H,customMenuOptions:null,tourState:L,isBrowserPageVisible:!0,showNonHeaderBackgroundCover:!1,theme:a,layout:et(e),chatHeaderState:{config:null,maxVisibleHeaderObjects:0}},o=t.userSessionStorageService?.loadLauncherSession();o&&(r.targetViewState=o.viewState,o.viewState=W,r.persistedToBrowserStorage.launcherState=o);const c=e.public.debug?window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({name:"CarbonAIChat",instanceId:`Chat${t.namespace.suffix}`}):void 0;return(0,Ve.y$)(tt,r,c)}(e,a),a.historyService=new Ne(a),a.messageService=new Be(a,n),a.store.subscribe(function(e){let t=e.store.getState().persistedToBrowserStorage;return()=>{const{persistedToBrowserStorage:n}=e.store.getState();t!==n&&(t=n,e.userSessionStorageService.persistChatSession(n.chatState),e.userSessionStorageService.persistLauncherSession(n.launcherState))}}(a)),n.disableWindowTitleChanges||a.store.subscribe(function(e){const{store:t}=e;let n,a,s=t.getState();return()=>{const e=t.getState(),{agentState:r}=t.getState(),{numUnreadMessages:o}=r;o!==s.agentState.numUnreadMessages&&(o?(clearTimeout(a),n||(n=window.document.title),window.document.title=e.languagePack.agent_newMessage,a=setTimeout(()=>{window.document.title=`(${o}) ${n}`},1e4)):(clearTimeout(a),n&&(window.document.title=n,n=null))),s=e}}(a)),a.customPanelManager=function(e){const t={[w.z0]:be(e)};return Object.freeze({getPanel(){return t[w.z0]}})}(a),f(a,a.store.getState().locale,a.store.getState().languagePack),a.writeableElements={[Ee.t.AI_TOOLTIP_AFTER_DESCRIPTION_ELEMENT]:document.createElement("div"),[Ee.t.WELCOME_NODE_BEFORE_ELEMENT]:document.createElement("div"),[Ee.t.HEADER_BOTTOM_ELEMENT]:document.createElement("div"),[Ee.t.BEFORE_INPUT_ELEMENT]:document.createElement("div"),[Ee.t.HOME_SCREEN_HEADER_BOTTOM_ELEMENT]:document.createElement("div"),[Ee.t.HOME_SCREEN_AFTER_STARTERS_ELEMENT]:document.createElement("div"),[Ee.t.HOME_SCREEN_BEFORE_INPUT_ELEMENT]:document.createElement("div"),[Ee.t.CUSTOM_PANEL_ELEMENT]:document.createElement("div")},n.debug&&(0,g.L6)(!0),n.debugStackTraces&&(0,g.Nb)(!0),a}(this.appConfig,this.additionalChatParameters);const[t,n,s,o]=await Promise.all([(0,h.gu)(this.serviceManager.store.getState().languagePack),(0,h.Xq)(this.serviceManager.store.getState().locale),Promise.resolve(this.additionalChatParameters.render),e?(0,at.RE)():Promise.resolve(null)]);this.serviceManager.customHostElement=this.customHostElement,o&&(this.serviceManager.humanAgentService=o(this.serviceManager)),f(this.serviceManager,n.name,t),r.locale(n);const p=async()=>{await s({serviceManager:this.serviceManager});const e=this.serviceManager.store.getState(),{wasLoadedFromBrowser:t}=e.persistedToBrowserStorage.launcherState,{targetViewState:n}=e,{openChatByDefault:r}=e.config.public;if(n.mainWindow){let e=m.eg.SESSION_HISTORY;r&&!t&&(e=m.eg.OPEN_BY_DEFAULT),await this.serviceManager.actions.changeView(n,{mainWindowOpenReason:e})}else{const e=m.ey.WEB_CHAT_LOADED,t=n.tour,s=(0,a.A)(n,W);await this.serviceManager.actions.changeView(n,{viewChangeReason:e},t,s)}return this.serviceManager.store.dispatch(l.Ay.setInitialViewChangeComplete(!0)),this.serviceManager.instance};return this.serviceManager.instance=function({serviceManager:e,callRender:t}){let n=!1,a={render:()=>n?((0,g.yA)("The render function has already been called!"),Promise.resolve(a)):(n=!0,t()),on:t=>(e.eventBus.on(t),a),off:t=>(e.eventBus.off(t),a),once:t=>(e.eventBus.once(t),a),updateLanguagePack:t=>((0,g.cY)("Called instance.updateLanguagePack",t),e.actions.updateLanguagePack(t)),updateLocale:t=>{(0,g.cY)("Called instance.updateLocale",t);const n=(0,h.Xq)(t),a=(0,h.gu)(e.store.getState().languagePack);return Promise.all([n,a]).then(([t,n])=>{r.locale(t),f(e,t.name,n),e.messageService.pendingLocale=!0,e.messageService.localeIsExplicit=!0})},updateCSSVariables:(t,n)=>((0,g.cY)("Called instance.updateCSSVariables",t),e.actions.updateCSSVariables(t,n)),send:async(t,n)=>{if((0,g.cY)("Called instance.send",t,n),(0,u.i_)(e.store.getState()).isReadonly)throw new Error("You are unable to send messages in read only mode.");return e.actions.send(t,m.vW.INSTANCE_SEND,n)},doAutoScroll:(t={})=>{(0,g.cY)("Called instance.doAutoScroll",t),e.mainWindow?.doAutoScroll?.(t)},destroy:()=>{(0,g.cY)("Called instance.destroy"),e.store.dispatch(l.Ay.setAppStateValue("isDestroyed",!0)),e.container?.remove(),a=void 0},updateAssistantInputFieldVisibility:t=>{(0,g.cY)("Called instance.updateAssistantInputFieldVisibility",t),e.store.dispatch(l.Ay.updateInputState({fieldVisible:t},!1))},updateInputIsDisabled:t=>{(0,g.cY)("Called instance.updateInputIsDisabled",t),e.store.dispatch(l.Ay.updateInputState({isReadonly:t},!1))},updateBotUnreadIndicatorVisibility:t=>{(0,g.cY)("Called instance.updateBotUnreadIndicatorVisibility",t),e.store.dispatch(l.Ay.setLauncherProperty("showUnreadIndicator",t))},changeView:async t=>{(0,g.cY)("Called instance.changeView",t);let a=!1;n||((0,g.yA)('You tried to call "changeView" without ever having called the "render" method. There is no view to change!'),a=!0);const s=Object.values(S.qi);"string"==typeof t?s.includes(t)||((0,g.yA)(`You tried to change the view but the view you specified is not a valid view name. Please use the valid view names; ${s.join(", ")}.`),a=!0):"object"==typeof t?Object.keys(t).forEach(e=>{s.includes(e)||((0,g.yA)(`You tried to change the state of multiple views by providing an object, however you included the key "${e}" within the object which is not a valid view name. Please use the valid view names; ${s.join(", ")}.`),a=!0)}):((0,g.yA)('You tried to change the view but the view you provided was not a string or an object. You can either change to one of the supported views by providing a string, ex. "launcher", "mainWindow", or "tour". Or you can change the state of multiple views by providing an object, ex. { "launcher": true, "mainWindow": false, "tour": true }. Please use one of these supported options.'),a=!0),a||await e.actions.changeView(t,{viewChangeReason:m.ey.CALLED_CHANGE_VIEW})},notifications:{addNotification:t=>{(0,g.cY)("Called instance.addNotification",t),e.actions.addNotification(t)},removeNotifications:t=>{(0,g.cY)("Called instance.removeNotifications",t),e.actions.removeNotification(t)},removeAllNotifications:()=>{(0,g.cY)("Called instance.removeAllNotifications"),e.actions.removeAllNotifications()}},updateMainHeaderTitle:t=>{(0,g.cY)("Called instance.updateMainHeaderTitle",t),t||(t=null),e.actions.updateMainHeaderTitle(t)},updateHomeScreenConfig:t=>{(0,g.cY)("Called instance.updateHomeScreenConfig",t);const n=(0,c.A)(t);e.store.getState().theme.useAITheme&&t?.background&&((0,g.OP)("The home screen background can not be changed when the AI theme is enabled."),delete n.background),e.actions.updateHomeScreenConfig(d(n))},getState:()=>e.actions.getPublicWebChatState(),writeableElements:y(e),scrollToMessage:(t,n)=>{(0,g.cY)("Called instance.scrollToMessage",t,n),e.mainWindow?.doScrollToMessage(t,n)},updateLauncherConfig:t=>e.actions.updateLauncherConfig(t),customPanels:e.customPanelManager,updateCustomMenuOptions:t=>{(0,g.cY)("Called instance.updateCustomMenuOptions",t),e.store.dispatch(l.Ay.setAppStateValue("customMenuOptions",t))},restartConversation:async()=>((0,g.cY)("Called instance.restartConversation"),e.actions.restartConversation()),agentEndConversation:()=>((0,g.cY)("Called instance.agentEndConversation"),(0,g.OP)("The instance.agentEndConversation method is deprecated. Use instance.serviceDesk.endConversation instead."),e.actions.agentEndConversation(!1)),updateIsTypingCounter(t){(0,g.cY)("Called instance.updateIsTypingCounter",t);const{store:n}=e;if("increase"===t)n.dispatch(l.Ay.addIsTypingCounter(1));else if("decrease"===t){if(n.getState().botMessageState.isTypingCounter<=0)return void(0,g.yA)("You cannot decrease the typing counter when it is already <= 0");n.dispatch(l.Ay.addIsTypingCounter(-1))}else(0,g.yA)(`[updateIsTypingCounter] Invalid direction: ${t}. Valid values are "increase" and "decrease".`)},updateIsLoadingCounter(t){(0,g.cY)("Called instance.updateIsLoadingCounter",t);const{store:n}=e;if("increase"===t)n.dispatch(l.Ay.addIsLoadingCounter(1));else if("decrease"===t){if(n.getState().botMessageState.isLoadingCounter<=0)return void(0,g.yA)("You cannot decrease the loading counter when it is already <= 0");n.dispatch(l.Ay.addIsLoadingCounter(-1))}else(0,g.yA)(`[updateIsLoadingCounter] Invalid direction: ${t}. Valid values are "increase" and "decrease".`)},updateIsChatLoadingCounter(t){(0,g.cY)("Called instance.updateIsChatLoadingCounter",t);const{store:n}=e;if("increase"===t)n.dispatch(l.Ay.addIsHydratingCounter(1));else if("decrease"===t){if(n.getState().botMessageState.isHydratingCounter<=0)return void(0,g.yA)("You cannot decrease the hydrating counter when it is already <= 0");n.dispatch(l.Ay.addIsHydratingCounter(-1))}else(0,g.yA)(`[updateIsChatLoadingCounter] Invalid direction: ${t}. Valid values are "increase" and "decrease".`)},updateHeaderConfig:t=>{const n=(0,c.A)(t);e.store.dispatch(l.Ay.updateChatHeaderConfig(n))},updateMainHeaderAvatar:t=>{e.store.dispatch(l.Ay.updateMainHeaderAvatar(t))},updateBotName:t=>e.actions.updateBotName(t),updateBotAvatarURL:t=>e.actions.updateBotAvatarURL(t),elements:{getMainWindow:function(){return{addClassName:t=>e.mainWindow?.addClassName(t),removeClassName:t=>e.mainWindow?.removeClassName(t)}},getMessageInput:function(){return{getHTMLElement:()=>e.mainWindow?.getMessageInput()?.getHTMLElement(),setValue:t=>e.mainWindow?.getMessageInput()?.setValue(t),setEnableEnterKey:t=>e.mainWindow?.getMessageInput()?.setEnableEnterKey(t),addChangeListener:t=>e.mainWindow?.getMessageInput()?.addChangeListener(t),removeChangeListener:t=>e.mainWindow?.getMessageInput()?.removeChangeListener(t)}},getHomeScreenInput:function(){return{getHTMLElement:()=>e.mainWindow?.getHomeScreenInput()?.getHTMLElement(),setValue:t=>e.mainWindow?.getHomeScreenInput()?.setValue(t),setEnableEnterKey:t=>e.mainWindow?.getHomeScreenInput()?.setEnableEnterKey(t),addChangeListener:t=>e.mainWindow?.getHomeScreenInput()?.addChangeListener(t),removeChangeListener:t=>e.mainWindow?.getHomeScreenInput()?.removeChangeListener(t)}}},tours:{startTour:async t=>{(0,g.cY)("Called instance.tours.startTour",t),await e.actions.send(t,m.vW.START_TOUR_METHOD,{skipTourCard:!0})},endTour:async()=>{(0,g.cY)("Called instance.tours.endTour"),e.actions.endTour({viewChangeReason:m.ey.CALLED_END_TOUR})},goToNextStep:async()=>{(0,g.cY)("Called instance.tours.goToNextStep"),e.actions.changeStepInTour({nextStep:!0})},goToStep:async t=>{(0,g.cY)("Called instance.tours.goToStep",t),e.actions.goToSpecificTourStep(t)}},messaging:{addMessage:(t,n={})=>((0,g.cY)("Called instance.messaging.addMessage",t,n),e.messageService.messageLoadingManager.end(),e.actions.receive(t,n?.isLatestWelcomeNode??!1,null,{disableFadeAnimation:n?.disableFadeAnimation})),addMessageChunk:async(t,n={})=>{(0,g.cY)("Called instance.messaging.addMessageChunk",t,n),e.messageService.messageLoadingManager.end(),await e.actions.receiveChunk(t,null,n)},removeMessages:async t=>((0,g.cY)("Called instance.messaging.removeMessages",t),e.actions.removeMessages(t)),clearConversation:()=>((0,g.cY)("Called instance.messaging.clearConversation"),e.actions.restartConversation({skipHydration:!0,endAgentConversation:!1,fireEvents:!1})),insertHistory:t=>((0,g.cY)("Called instance.messaging.insertHistory",t),e.actions.insertHistory(t))},requestFocus:()=>{(0,g.cY)("Called instance.requestFocus"),e.appWindow?.requestFocus()},serviceDesk:{endConversation:()=>((0,g.cY)("Called instance.serviceDesk.endConversation"),e.actions.agentEndConversation(!1)),updateIsSuspended:async t=>((0,g.cY)("Called instance.serviceDesk.updateIsSuspended",t),e.actions.agentUpdateIsSuspended(t))}};return e.store.getState().config.public.debug&&(0,g.$Z)("[ChatInstanceImpl] Created chat instance",a),a}({serviceManager:this.serviceManager,callRender:()=>{const e=p();return this.serviceManager.renderPromise=e,e}}),{instance:this.serviceManager.instance,serviceManager:this.serviceManager}}}n(1108);var rt=n(4452),ot=n(2986),it=n(8710),ct=n(5022),lt=n(395),ut=n(6683),dt=n(5807);function ht(e){const t=(0,it.A)(),{store:n}=(0,ut.O)(),a=(0,s.useRef)(),r=(0,s.useCallback)(e=>{a.current?a.current.announceValue(e):setTimeout(()=>a.current.announceValue(e))},[]),o=(0,s.useRef)();return(0,s.useEffect)(()=>n.subscribe(()=>{const e=n.getState().announceMessage;e!==o.current&&(r(e),o.current=e)}),[n,r]),s.createElement(lt.s.Provider,{value:r},e.children,s.createElement(dt.o,{intl:t,ref:a}))}var gt=n(6254),mt=n(2895),pt=n(5608),ft=n(7161),St=n(4183),yt=n(7201),Ct=n(393),Et=n(7338);function _t(e,t,n){return n?t?e.launcher_isTourOpen:e.launcher_isTourClosed:t?e.launcher_isOpen:e.launcher_isClosed}var At=n(2566);function vt(e,t){const{onToggleOpen:n,languagePack:a,unreadAgentCount:r,intl:o,showUnreadIndicator:i,className:c,tabIndex:l,launcherHidden:u,activeTour:d}=e,h=(0,ct.d4)(e=>e.theme.useAITheme?void 0:e.launcher.config.desktop.avatar_url_override),g=(0,ct.d4)(e=>e.theme.useAITheme),m=s.createRef();(0,s.useImperativeHandle)(t,()=>({requestFocus:()=>{(0,Et.Ht)(m)}}));let p=_t(a,u,d);0!==r&&(p+=`. ${o.formatMessage({id:"icon_ariaUnreadMessages"},{count:r})}`);let f=g?s.createElement(ft.A,{size:24,className:"WACLauncher_svg"}):s.createElement(yt.A,{size:24,className:"WACLauncher__svg"});return h&&(f=s.createElement("img",{className:"WACLauncher__Avatar",src:h,alt:"","aria-hidden":!0})),s.createElement("div",{className:rt("WACLauncher__ButtonContainer","WACLauncher__ButtonContainer--round",c,{"WACLauncher__ButtonContainer--hidden":u})},s.createElement(Ct.$nd,{"aria-label":p,className:rt("WACLauncher__Button",{WACLauncher__TourButton:d}),"data-testid":At.g.LAUNCHER,kind:le.wQ.PRIMARY,type:"button",onClick:n,ref:m,tabIndex:l},d?s.createElement(St.A,{size:24,className:"WACLauncher__svg"}):f,(0!==r||i)&&s.createElement("div",{className:"WAC__countIndicator"},0!==r?r:"")))}const Tt=(0,s.forwardRef)(vt);var It=n(2794);function wt(e){const{languagePack:t,intl:n,launcherConfig:a,launcherComplexRef:r,launcherRef:o,onOpen:i,onMinimize:c,unreadAgentCount:l,showUnreadIndicator:u,desktopLauncherIsExpanded:d,launcherHidden:h,activeTour:g,className:m}=e,{launcher_desktopGreeting:p,launcher_closeButton:f,launcher_ariaIsExpanded:S}=t;return s.createElement("div",{className:rt("WACLauncher__ButtonContainer","WACLauncherComplex__Container",m,{"WACLauncher__ButtonContainer--hidden":h}),ref:r},s.createElement("button",{className:"WACLauncherComplex__ContentButton",type:"button",onClick:i,disabled:!d},s.createElement("div",{className:rt("WACWidget__textEllipsis",{WACLauncherComplex__Text:!h})},a.desktop.title?a.desktop.title:p)),s.createElement(Tt,{languagePack:t,intl:n,ref:o,onToggleOpen:i,className:"WACLauncherComplex__SmallLauncherContainer",unreadAgentCount:l,showUnreadIndicator:u,launcherHidden:h,activeTour:g}),s.createElement(Ct.vwO,{className:"WACLauncher__CloseButton","aria-label":S,onClick:c,disabled:!d},s.createElement("div",{className:"WACLauncher__CloseButtonInnerWrapper"},s.createElement(It.A,{className:"WACLauncher__CloseButtonIcon"}),f)))}const Mt=e=>{const{launcherRef:t,onDoToggle:n,requestFocus:a,launcherHidden:r,activeTour:o}=e,i=(0,ut.O)(),c=(0,gt.D)(),u=(0,it.A)(),d=(0,ct.d4)(e=>e.persistedToBrowserStorage.launcherState),{desktopLauncherWasMinimized:h,desktopLauncherIsExpanded:g,bounceTurn:m,showUnreadIndicator:p,viewState:f}=d,y=(0,ct.d4)(e=>e.launcher).config,{time_to_expand:C,new_expand_time:E}=y.desktop,_=y.desktop.is_on,A=(0,ct.d4)(e=>e.agentState.numUnreadMessages),[v,T]=(0,s.useState)(""),[w,M]=(0,s.useState)(""),b=(0,s.useRef)(),R=(0,s.useRef)();R.current=r;const N=(0,s.useRef)(!1),O=(0,s.useRef)();O.current=m;const P=(0,s.useRef)(),D=(0,s.useRef)(),B=(0,s.useRef)(),L=(0,s.useRef)(),H=(0,s.useRef)(),W=(0,s.useRef)(),k=(0,s.useCallback)(()=>{const e=`${b.current?.offsetHeight}px`;b.current?.style?.setProperty&&b.current.style.setProperty("--cds-chat-LAUNCHER-desktop-expanded-height",e)},[]),x=(0,s.useCallback)(()=>{R.current||(i.store.dispatch(l.Ay.setLauncherProperty("desktopLauncherIsExpanded",!0)),k(),M("WACLauncherComplex__Container--introAnimation"))},[k,i.store]),U=(0,s.useCallback)(()=>{P.current=setTimeout(()=>{x()},C)},[C,x]),F=(0,s.useCallback)(()=>{clearTimeout(P.current),clearTimeout(D.current)},[]),V=(0,s.useCallback)(()=>{R.current||T("WACLauncher__ButtonContainer--bounceAnimation")},[]),$=(0,s.useCallback)(()=>{R.current||(T("WACLauncher__ButtonContainer--noAnimation"),O.current++,i.store.dispatch(l.Ay.setLauncherProperty("bounceTurn",O.current)))},[i.store]),G=(0,s.useCallback)(()=>{1===O.current?(B.current=setTimeout(()=>{V()},I[0]),L.current=setTimeout(()=>{$()},I[0]+500),H.current=setTimeout(()=>{V()},I[0]+I[1]),W.current=setTimeout(()=>{$()},I[0]+I[1]+500)):2===O.current&&(H.current=setTimeout(()=>{V()},I[1]),W.current=setTimeout(()=>{$()},I[1]+500))},[$,V]),q=(0,s.useCallback)(()=>{clearTimeout(B.current),clearTimeout(L.current),clearTimeout(H.current),clearTimeout(W.current)},[]),Y=(0,s.useCallback)(()=>{F(),i.store.dispatch(l.Ay.setLauncherMinimized()),q(),i.store.dispatch(l.Ay.setLauncherProperty("bounceTurn",3)),N.current=!1,T("WACLauncher__ButtonContainer--noAnimation")},[q,F,i.store]);(0,mt.y)(()=>{if(g)N.current=!0;else{if(!h&&_)return U(),()=>{F()};if(h&&3!==m)return G(),()=>{q()}}}),(0,s.useEffect)(()=>{f.launcher&&N.current&&(k(),M("WACLauncherComplex__Container--simpleAnimation"),N.current=!1)},[k,f.launcher]),(0,s.useEffect)(()=>{(f.mainWindow||f.tour)&&Y()},[f,Y]),(0,s.useEffect)(()=>{E&&(q(),F(),U(),i.store.dispatch(l.Ay.setLauncherConfigProperty("new_expand_time",!1,S.vX.DESKTOP)))},[D,P,E,U,F,q,i.store]);const j=(0,pt.Z)(y.desktop.title);(0,s.useEffect)(()=>{j!==y.desktop.title&&(y.desktop.title||j)&&k()},[k,y,j]);const z=(0,s.useCallback)(()=>{M("WACLauncherComplex__Container--closeAnimation"),setTimeout(()=>{T("WACLauncher__ButtonContainer--noAnimation"),i.store.dispatch(l.Ay.setLauncherMinimized()),setTimeout(a)},400)},[a,i.store]),X=(0,s.useCallback)(()=>{Y(),n()},[n,Y]);let K;return K=g?s.createElement(wt,{languagePack:c,intl:u,launcherComplexRef:b,launcherRef:t,launcherConfig:y,onOpen:X,onMinimize:z,unreadAgentCount:A,showUnreadIndicator:p,desktopLauncherIsExpanded:g,launcherHidden:r,activeTour:o,className:w}):s.createElement(Tt,{languagePack:c,intl:u,ref:t,onToggleOpen:X,unreadAgentCount:A,showUnreadIndicator:p,className:v,launcherHidden:r,activeTour:o}),K};function bt(e,t,n,a){if(e)if(e.classList.add(t),"number"==typeof n)setTimeout(()=>{e.classList.remove(t),a&&a()},n);else{const s=r=>{n&&r.animationName!==n||(e.removeEventListener("animationend",s),e.removeEventListener("animationcancel",s),e.classList.remove(t),a&&a())};e.addEventListener("animationend",s),e.addEventListener("animationcancel",s)}}var Rt=n(9705);function Nt(e,t){const{unreadAgentCount:n,showUnreadIndicator:a,launcherConfig:r,isExtended:o,playExtendAnimation:i,onToggleOpen:c,onSwipeRight:l,onReduceEnd:u,className:d,launcherHidden:h,activeTour:g}=e,m=(0,Rt.q)(),p=(0,gt.D)(),f=(0,it.A)(),S=(0,ct.d4)(e=>e.theme.useAITheme?void 0:e.launcher.config.mobile.avatar_url_override),[y,C]=(0,s.useState)(i),[E,_]=(0,s.useState)(!1),A=(0,pt.Z)(o),v=(0,s.useRef)(),T=(0,s.useRef)(),I=(0,s.useRef)(),w=(0,s.useRef)(),M=(0,s.useRef)({touchStartX:null,touchStartY:null}),b=!o&&A,R=o&&y,N=o&&!y,O=r.mobile.title||p.launcher_mobileGreeting;let P=_t(p,h,g);0!==n&&(P+=`. ${f.formatMessage({id:"icon_ariaUnreadMessages"},{count:n})}`);let D=s.createElement(yt.A,{size:24,className:"WACLauncher__svg"});return S&&(D=s.createElement("img",{className:"WACLauncher__Avatar",src:S,"aria-hidden":!0,alt:""})),(0,s.useImperativeHandle)(t,()=>({requestFocus:()=>{(0,Et.Ht)(v)},launcherContainerElement:()=>T.current})),(0,s.useEffect)(()=>{!function(e,t,n){const a=function(){const e=We.yS?32:64,{width:t,height:n}=window.screen,a=Math.min(n,t)-e;return Math.min(a,400)}()-68+12;e.style.setProperty("width",`${a}px`),t.style.setProperty("width",a-12+"px"),t.style.setProperty("display","flex");const{clientWidth:s}=t.querySelector(".WACLauncherExtended__GreetingText");let r=s+68+1;r>400&&(r=400),t.removeAttribute("style"),e.removeAttribute("style"),n.style.setProperty("--cds-chat--LAUNCHER-EXTENDED-width",`${r}px`)}(w.current,I.current,T.current)},[m,N,O]),(0,s.useEffect)(()=>{if(o){y?Ot({fadeInElement:I.current,fadeInTime:300},()=>{C(!1)}):_(!0);const e=v.current,t=e=>{!function(e,t,n){const{touchStartX:a,touchStartY:s}=t;if(null===a||null===s)return;const{clientX:r,clientY:o}=e,i=r-a,c=o-s;Math.abs(i)>Math.abs(c)&&i>0&&n(),t.touchStartX=null,t.touchStartY=null}(e.touches[0],M.current,l)},n=e=>{const{clientX:n,clientY:a}=e.touches[0],s=M.current;s.touchStartX=n,s.touchStartY=a,v.current.addEventListener("touchmove",t)};return e.addEventListener("touchstart",n),()=>{e.removeEventListener("touchmove",t),e.removeEventListener("touchstart",n)}}if(b){const e=()=>{u(),C(!0),T.current.removeEventListener("animationend",e)};T.current.addEventListener("animationend",e),Ot({fadeOutElement:I.current})}},[y,m,o,O,u,l,b]),s.createElement("div",{className:rt("WACLauncher__ButtonContainer WACLauncher__ButtonContainer--round WACLauncherExtended__Container",d,{"WACLauncher__ButtonContainer--hidden":h,"WACLauncherExtended__Button--extended":N,"WACLauncherExtended__Button--extendedAnimation":R,"WACLauncherExtended__Button--reducedAnimation":b}),ref:T},s.createElement(Ct.$nd,{"aria-label":P,className:rt("WACLauncher__Button","WACLauncherExtended__Button",{WACLauncher__TourButton:g}),kind:g?le.wQ.GHOST:le.wQ.PRIMARY,type:"button",ref:v,onClick:c},s.createElement("div",{className:"WACLauncherExtended__WrapperContainer"},s.createElement("div",{className:"WACLauncherExtended__Wrapper"},s.createElement("div",{className:"WACLauncherExtended__TextHolder",ref:w},s.createElement("div",{className:rt("WACLauncherExtended__Greeting",{"WACLauncherExtended__Element--hidden":!E}),ref:I},s.createElement("div",{className:"WACLauncherExtended__GreetingText","aria-hidden":!o},O))),s.createElement("div",{className:"WACLauncher__IconHolder"},g?s.createElement(St.A,{size:24,className:"WACLauncher__svg"}):D))),(0!==n||a)&&s.createElement("div",{className:"WAC__countIndicator"},0!==n?n:"")))}function Ot({fadeOutElement:e,fadeInElement:t,fadeInTime:n=600},a){e&&(e.classList.remove("WACLauncherExtended__Element--hidden"),bt(e,"WACLauncherExtended__Element--FadeOut",500,()=>{e.classList.add("WACLauncherExtended__Element--hidden"),e.classList.remove("WACLauncherExtended__Element--FadeOut"),!t&&a&&a()})),t&&setTimeout(()=>{t.classList.remove("WACLauncherExtended__Element--hidden"),bt(t,"WACLauncherExtended__Element--FadeIn",600,()=>{t.classList.remove("WACLauncherExtended__Element--FadeIn"),a&&a()})},n)}const Pt=s.memo((0,s.forwardRef)(Nt));function Dt(e){const{launcherRef:t,onToggleOpen:n,launcherHidden:a,activeTour:r}=e,o=(0,ut.O)(),{config:i}=(0,ct.d4)(e=>e.launcher),c=(0,ct.d4)(e=>e.agentState.numUnreadMessages),{mobileLauncherIsExtended:u,mobileLauncherWasReduced:d,mobileLauncherDisableBounce:h,bounceTurn:g,showUnreadIndicator:m,viewState:p}=(0,ct.d4)(e=>e.persistedToBrowserStorage.launcherState),[f,y]=(0,s.useState)(!1),C=(0,pt.Z)(u),E=(0,pt.Z)(d),_=(0,s.useRef)(g).current,A=(0,s.useRef)(d).current,v=(0,s.useRef)(null),T=(0,s.useRef)(null),w=(0,s.useRef)(null),M=(0,s.useRef)(A&&!h),{time_to_expand:b,new_expand_time:R,time_to_reduce:N}=i.mobile,O=i.mobile.is_on,P=void 0===C&&!u,D=void 0!==C&&!C&&u,B=D||void 0!==E&&!E&&d||f,L=(0,s.useCallback)(()=>{d||o.store.dispatch(l.Ay.setLauncherProperty("mobileLauncherWasReduced",!0))},[d,o]),H=(0,s.useCallback)(()=>{!function(){const e=v.current,t=T.current;t&&(clearTimeout(t),T.current=null),e&&(clearTimeout(e),v.current=null)}(),u&&(document.removeEventListener("scroll",H),o.store.dispatch(l.Ay.setLauncherProperty("mobileLauncherIsExtended",!1)))},[u,o]),W=(0,s.useCallback)(()=>{v.current=setTimeout(()=>{u||D||(o.store.dispatch(l.Ay.setLauncherProperty("mobileLauncherWasReduced",!1)),o.store.dispatch(l.Ay.setLauncherProperty("mobileLauncherIsExtended",!0)))},b)},[u,D,o.store,b]),k=(0,s.useCallback)(()=>{const e=w.current;e&&(e(),w.current=null),o.store.dispatch(l.Ay.setLauncherProperty("mobileLauncherDisableBounce",!0)),H(),L()},[H,o.store,L]);(0,mt.y)(()=>{if(!d&&P&&O)W();else if(M.current){const e=t?.current?.launcherContainerElement();if(e){const t=()=>{if(M.current){let n=_;e.removeEventListener("animationend",t),y(!0),w.current=function(e,t,n,a){const{startingIndex:s,beforeAll:r,afterAll:o,beforeEach:i,afterEach:c}=a;let l=s||0,u=!1,d=null;function h(){r&&0===l&&r();const e=l===n.length;e||u?e&&o&&o():d=setTimeout(m,n[l])}function g(){c&&c(),l++,e.removeEventListener("animationend",g),e.classList.remove(t),h()}function m(){i&&i(),e.addEventListener("animationend",g),e.classList.add(t)}return h(),()=>{u=!0,clearTimeout(d),e.classList.remove(t),e.removeEventListener("animationend",g)}}(e,"WACLauncher__ButtonContainer--bounceAnimation",I,{startingIndex:_-1,afterEach:()=>{n++,o.store.dispatch(l.Ay.setLauncherProperty("bounceTurn",n))},afterAll:()=>{o.store.dispatch(l.Ay.setLauncherProperty("mobileLauncherDisableBounce",!0))}})}};e.addEventListener("animationend",t)}}}),(0,s.useEffect)(()=>{(p.mainWindow||p.tour)&&k()},[p,k]),(0,s.useEffect)(()=>{if(R){M.current&&(M.current=!1);const e=w.current;e&&(e(),w.current=null),v.current&&clearTimeout(v.current),W(),o.store.dispatch(l.Ay.setLauncherConfigProperty("new_expand_time",!1,S.vX.MOBILE))}},[W,R,o.store,M]);const x=(0,s.useCallback)(()=>{k(),n()},[n,k]),U=(0,s.useCallback)(()=>{H()},[H]);return(0,s.useEffect)(()=>{u&&(T.current=setTimeout(()=>{H()},N),document.addEventListener("scroll",H))},[u,H,N,o]),s.createElement(Pt,{className:rt({"WACLauncher__ButtonContainer--noAnimation":B}),ref:t,launcherConfig:i,showUnreadIndicator:m,unreadAgentCount:c,isExtended:u,playExtendAnimation:P,onToggleOpen:x,onSwipeRight:U,onReduceEnd:L,launcherHidden:a,activeTour:r})}function Bt(){const e=(0,ut.O)(),t=(0,s.useRef)(),n=(0,ct.d4)(e=>e.persistedToBrowserStorage.launcherState.viewState),a=(0,ct.d4)(e=>e.initialViewChangeComplete),r=!n.launcher,o=(0,ct.d4)(e=>e.persistedToBrowserStorage.launcherState.activeTour),i=(0,s.useCallback)(()=>{t.current?.requestFocus()},[t]),c=(0,s.useCallback)(()=>o?e.actions.changeView(S.qi.TOUR,{viewChangeReason:m.ey.LAUNCHER_CLICKED}):e.actions.changeView(S.qi.MAIN_WINDOW,{mainWindowOpenReason:m.eg.DEFAULT_LAUNCHER}),[o,e.actions]);let l;return function(e,r){const o=(0,s.useRef)(!1);(0,s.useEffect)(()=>{o.current?n.launcher&&!n.mainWindow&&!n.tour&&a&&t.current?.requestFocus():o.current=!0},r)}(0,[n]),l=We.a3?s.createElement(Dt,{launcherRef:t,onToggleOpen:c,launcherHidden:r,activeTour:o}):s.createElement(Mt,{launcherRef:t,onDoToggle:c,requestFocus:i,launcherHidden:r,activeTour:o}),l}var Lt=n(9964),Ht=n(6538),Wt=n(8583),kt=n(4544),xt=n(4630),Ut=n(9186),Ft=n(5884),Vt=n(7429),$t=n(5005),Gt=n(4458);function qt({onClose:e,languagePack:t,isHydrated:n,headerDisplayName:a,useHomeScreenVersion:r}){const o=(0,s.useContext)(xt.l);let i;return i=r?s.createElement(Ft.Z,{onClose:e}):s.createElement(Ut.r,{onClose:e,headerDisplayName:a,onToggleHomeScreen:null,includeWriteableElement:!1,testIdPrefix:Gt.G.HYDRATING}),s.createElement("div",{className:"WAC WAC__hydratingContainer"},i,s.createElement("div",{className:rt("WAC__hydrating","WACPanelContent",{"WAC__hydrating--homeScreen":r})},!o&&s.createElement($t.l,{delay:400},!n&&s.createElement(Vt.D,{announceOnce:t.window_ariaWindowLoading}),s.createElement(Ct.Rhj,{withOverlay:!1,"aria-label":t.window_ariaWindowLoading}))))}var Yt=n(4271),jt=n(1424),zt=n(8205);function Xt(e){const{useAITheme:t,onPanelOpenEnd:n,onPanelCloseEnd:a,onPanelOpenStart:r,onPanelCloseStart:o,onClose:i,onCloseAndRestart:c,onClickRestart:u}=e,d=(0,gt.D)(),{isOpen:h,options:g}=(0,ct.d4)(e=>e.customPanelState),{title:p,hidePanelHeader:f,disableDefaultCloseAction:S,disableAnimation:y,onClickBack:C,onClickClose:E,onClickCloseAndRestart:_}=g,A=(0,ut.O)(),v=(0,Rt.q)(),T=(0,pt.Z)(h),I=y?Yt.K.NONE:Yt.K.SLIDE_IN_FROM_BOTTOM,w=y?Yt.v.NONE:Yt.v.SLIDE_OUT_TO_BOTTOM;(0,s.useEffect)(()=>{T!==h&&h&&!f&&p&&v(p)},[v,f,h,T,p]);const M=(0,s.useCallback)(()=>{A.store.dispatch(l.Ay.setCustomPanelOpen(!1)),C?.()},[A,C]),b=(0,s.useCallback)(()=>{S||(Kt(A.store.getState().viewChanging),i()),E?.()},[S,E,i,A]),R=(0,s.useCallback)(()=>{S||(Kt(A.store.getState().viewChanging),c()),_?.()},[S,_,c,A]);return s.createElement(Gt.j,{className:"WAC__overlay--covering",onOpenStart:()=>{A.eventBus.fire({type:m.xp.CUSTOM_PANEL_PRE_OPEN},A.instance),r()},onOpenEnd:()=>{A.eventBus.fire({type:m.xp.CUSTOM_PANEL_OPEN},A.instance),n()},onCloseStart:()=>{A.eventBus.fire({type:m.xp.CUSTOM_PANEL_PRE_CLOSE},A.instance),o()},onCloseEnd:()=>{A.eventBus.fire({type:m.xp.CUSTOM_PANEL_CLOSE},A.instance),a(),A.store.dispatch(l.Ay.setCustomPanelConfigOptions(O))},animationOnOpen:I,animationOnClose:w,shouldOpen:h,serviceManager:A,overlayPanelName:Gt.G.CUSTOM},s.createElement(jt.b,{className:"WACCustomPanel",eventName:"Custom panel opened",eventDescription:"A user opened a custom panel.",labelBackButton:d.general_returnToAssistant,isOpen:h,title:p,useAITheme:t,onClickBack:M,onClickClose:b,onClickCloseAndRestart:R,onClickRestart:u,hidePanelHeader:f,hideBackButton:g.hideBackButton,hideCloseButton:g.hideCloseButton,hideCloseAndRestartButton:g.hideCloseAndRestartButton,testIdPrefix:Gt.G.CUSTOM},s.createElement(zt.A,{slotName:"customPanelElement",className:"WACCustomPanel__ContentContainer"})))}function Kt(e){if(e){const e="You are attempting to close Carbon AI chat from a custom panel while Carbon AI chat is currently running a view change event which is not permitted. Please use the disableDefaultCloseAction option to disable this behavior for the custom panel and then use onClickClose to resolve your Promise that is handling the event; that Promise will allow you to close Carbon AI chat.";throw(0,g.yA)(e),new Error(e)}}const Qt=s.memo(Xt);var Zt=n(6516),Jt=n(5112),en=n(6718),tn=n(8018);const nn=(0,at.hY)(),an=(0,at.cq)(),sn=(0,at.Mx)(),rn=(0,at.$O)(),on=(0,at.j0)(),cn=(0,at.ZF)(),ln=(0,at.ad)(),un="WAC--standardWidth",dn="WAC--narrowWidth",hn="WAC--wideWidth";class gn extends s.Component{constructor(){super(...arguments),this.state={closing:!1,open:this.props.persistedToBrowserStorage.launcherState.viewState.mainWindow,modalPortalHostElement:null,numPanelsOpen:0,numPanelsAnimating:0,numPanelsCovering:0,isHydrationAnimationComplete:this.props.isHydrated,shouldAutoFocus:this.props.config.public.shouldTakeFocusIfOpensAutomatically,extraClassNames:[],areModulesLoaded:!1},this.mainWindowRef=s.createRef(),this.containerRef=s.createRef(),this.botChatRef=s.createRef(),this.homeScreenInputRef=s.createRef(),this.disclaimerRef=s.createRef(),this.brandingRef=s.createRef(),this.animationContainerRef=s.createRef(),this.iframePanelRef=s.createRef(),this.viewSourcePanelRef=s.createRef(),this.previousBodyVisibility=void 0,this.previousBodyPosition=void 0,this.onResize=()=>{let e;const t=this.containerRef?.current?.offsetHeight,n=this.containerRef?.current?.offsetWidth;e=n>=704?tn.g.WIDE:n>=360?tn.g.STANDARD:tn.g.NARROW,this.props.serviceManager.store.dispatch(l.Ay.setAppStateValue("chatWidth",n)),this.props.serviceManager.store.dispatch(l.Ay.setAppStateValue("chatHeight",t)),this.props.serviceManager.store.dispatch(l.Ay.setAppStateValue("chatWidthBreakpoint",e))},this.onVisualViewportResize=()=>{this.updateFromVisualViewport()},this.updateFromVisualViewport=()=>{const e=this.props.serviceManager.container,{visualViewport:t}=window;if(t)e.style.setProperty("--cds-chat-viewport-height",`${t.height}px`),e.style.setProperty("--cds-chat-viewport-width",`${t.width}px`),e.style.setProperty("--cds-chat-viewport-offsetTop",`${t.offsetTop}px`),e.style.setProperty("--cds-chat-viewport-offsetLeft",`${t.offsetLeft}px`);else{const t="100vh";e.style.setProperty("--cds-chat-viewport-height",t),e.style.setProperty("--cds-chat-viewport-width","100vw"),e.style.setProperty("--cds-chat-viewport-offsetTop","0"),e.style.setProperty("--cds-chat-viewport-offsetLeft","0")}},this.setModalPortalHostElement=e=>{this.state.modalPortalHostElement!==e&&this.setState({modalPortalHostElement:e})},this.onSendInput=async(e,t,n)=>{const a=(0,u.PK)(this.props),{serviceManager:s}=this.props,r=s.store.getState(),{files:o}=(0,u.i_)(r);if(a)s.humanAgentService.sendMessageToAgent(e,o);else{const a=(0,J.r2)(e);s.actions.sendWithCatch(a,t,{...n})}o.length&&s.store.dispatch(l.Ay.clearInputFiles(a))},this.onSendHomeButtonInput=e=>{const t=(0,J.Bj)(e);this.props.serviceManager.actions.sendWithCatch(t,m.vW.HOME_SCREEN_STARTER)},this.removeChatFromDom=()=>{this.containerRef.current.removeEventListener("animationend",this.removeChatFromDom),this.setState({open:!1,closing:!1})},this.onRestart=async()=>{await this.props.serviceManager.actions.restartConversation(),this.requestFocus()},this.onClose=async()=>this.doClose(!1),this.onCloseAndRestart=async()=>this.doClose(!0),this.onToggleHomeScreen=()=>{this.props.serviceManager.store.dispatch(l.Ay.toggleHomeScreen())},this.requestFocus=()=>{try{this.state.shouldAutoFocus&&!We.yS&&(this.getShowDisclaimer()?this.disclaimerRef.current&&(0,Et.Ht)(this.disclaimerRef):this.getShowHomeScreen()?this.homeScreenInputRef.current&&this.homeScreenInputRef.current.takeFocus():this.props.iFramePanelState.isOpen?this.iframePanelRef.current&&this.iframePanelRef.current.requestFocus():this.botChatRef.current&&this.botChatRef.current.requestInputFocus())}catch(e){(0,g.yA)("An error occurred in MainWindow.requestFocus",e)}},this.onUserTyping=e=>{this.props.serviceManager.store.getState().persistedToBrowserStorage.chatState.agentState.isConnected&&this.props.serviceManager.humanAgentService.userTyping(e)},this.onAcceptDisclaimer=()=>{this.props.serviceManager.store.dispatch(l.Ay.acceptDisclaimer())},this.onPanelOpenStart=e=>{this.setState(t=>({numPanelsOpen:t.numPanelsOpen+1,numPanelsAnimating:t.numPanelsAnimating+1,numPanelsCovering:t.numPanelsCovering+(e?1:0)}),this.requestFocus)},this.onPanelOpenEnd=()=>{this.setState(e=>({numPanelsAnimating:e.numPanelsAnimating-1}))},this.onPanelCloseStart=()=>{this.setState(e=>({numPanelsAnimating:e.numPanelsAnimating+1}),this.requestFocus)},this.onPanelCloseEnd=e=>{this.setState(t=>({numPanelsOpen:t.numPanelsOpen-1,numPanelsAnimating:t.numPanelsAnimating-1,numPanelsCovering:t.numPanelsCovering-(e?1:0)}))},this.onHydrationPanelClose=()=>{this.setState({isHydrationAnimationComplete:!0},this.requestFocus)}}componentDidMount(){const{persistedToBrowserStorage:e,config:t,serviceManager:n,mainWindowRef:a}=this.props,{viewState:s}=e.launcherState,{public:r}=t;if(n.mainWindow=this,a.current=this,this.mainWindowObserver=new ResizeObserver(this.onResize),this.mainWindowObserver.observe(this.containerRef.current),We.yS&&!r.disableCustomElementMobileEnhancements){const{visualViewport:e}=window;e&&(e.addEventListener("resize",this.onVisualViewportResize),e.addEventListener("scroll",this.updateFromVisualViewport)),this.updateFromVisualViewport(),this.updateBody(!1)}this.containerRef.current.style.setProperty("--cds-chat-scrollbar-width",`${(0,Et.gU)()}px`),s.mainWindow&&this.loadPanels()}componentWillUnmount(){this.mainWindowObserver.unobserve(this.containerRef.current)}destroy(){if(We.yS&&!this.props.config.public.disableCustomElementMobileEnhancements){const{visualViewport:e}=window;e&&(e.removeEventListener("resize",this.onVisualViewportResize),e.removeEventListener("scroll",this.updateFromVisualViewport))}this.updateBody(!0)}componentDidUpdate(e,t){const n=this.props,a=this.state,{persistedToBrowserStorage:s,useCustomHostElement:r,isDestroyed:o}=n,{viewState:i}=s.launcherState,{open:c}=a,l=e.persistedToBrowserStorage.launcherState.viewState;i.mainWindow!==l.mainWindow&&(this.updateBody(!1),this.updateFromVisualViewport()),o&&!e.isDestroyed&&this.destroy(),(t.areModulesLoaded!==a.areModulesLoaded||e.isHydrated!==n.isHydrated)&&n.isHydrated&&a.areModulesLoaded&&this.setState({isHydrationAnimationComplete:!0},()=>{requestAnimationFrame(()=>{this.requestFocus()})}),!i.mainWindow||l.mainWindow&&c?!i.mainWindow&&l.mainWindow&&t.open&&c&&(this.setState({closing:!0}),r?this.removeChatFromDom():(this.containerRef.current.addEventListener("animationend",this.removeChatFromDom),this.requestFocus())):(this.setState({open:!0},()=>{this.requestFocus()}),this.loadPanels()),n.config.public.shouldTakeFocusIfOpensAutomatically&&(e.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage||!n.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage||this.state.shouldAutoFocus?e.botMessageState.localMessageIDs.length>n.botMessageState.localMessageIDs.length&&this.state.shouldAutoFocus?this.setState({shouldAutoFocus:!1}):e.botMessageState.localMessageIDs.length<n.botMessageState.localMessageIDs.length&&!this.state.shouldAutoFocus&&this.setState({shouldAutoFocus:!0}):this.setState({shouldAutoFocus:!0}));const u=(0,K.ns)(n.botMessageState.localMessageIDs);if(u!==(0,K.ns)(e.botMessageState.localMessageIDs)&&a.shouldAutoFocus){const e=n.allMessageItemsByID[u],t=n.allMessagesByID[e?.fullMessageID];t?.history?.from_history||this.requestFocus()}}componentDidCatch(e,t){this.props.serviceManager.actions.errorOccurred((0,g.Jg)("MainWindow",e,t,!0))}loadPanels(){Promise.all([nn.preload(),an.preload(),sn.preload(),rn.preload(),on.preload(),cn.preload(),ln.preload()]).then(()=>{this.setState({areModulesLoaded:!0})})}updateBody(e){We.pz&&!this.props.config.public.disableCustomElementMobileEnhancements&&((window.screen.width<=500||window.screen.height<=500)&&this.props.persistedToBrowserStorage.launcherState.viewState.mainWindow&&!e?(this.previousBodyVisibility=document.body.style.getPropertyValue("visibility"),this.previousBodyPosition=document.body.style.getPropertyValue("position"),document.body.style.setProperty("visibility","hidden","important"),document.body.style.setProperty("position","fixed","important")):(document.body.style.setProperty("visibility",this.previousBodyVisibility),document.body.style.setProperty("position",this.previousBodyPosition)))}async doClose(e){const{serviceManager:t}=this.props,{activeTour:n}=t.store.getState().persistedToBrowserStorage.launcherState;e?(await t.actions.changeView(S.qi.LAUNCHER,{mainWindowCloseReason:m.MX.MAIN_WINDOW_CLOSED_AND_RESTARTED})).mainWindow||await t.actions.restartConversation():await t.actions.changeView(n?S.qi.TOUR:S.qi.LAUNCHER,{mainWindowCloseReason:m.MX.DEFAULT_MINIMIZE})}getShowHomeScreen(){return this.props.homeScreenConfig.is_on&&this.props.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen&&!this.getShowDisclaimer()}getShowDisclaimer(){return this.props.config.public.disclaimer?.is_on&&!this.props.persistedToBrowserStorage.chatState.disclaimersAccepted[window.location.hostname]}doAutoScroll(e){this.botChatRef?.current?.doAutoScroll(e)}getMessagesScrollBottom(){return this.botChatRef?.current?.getMessagesScrollBottom()}doScrollToMessage(e,t=!0){this.botChatRef.current?.doScrollToMessage(e,t)}getMessageInput(){return this.botChatRef.current?.getMessageInput()}getHomeScreenInput(){return this.homeScreenInputRef.current?.getMessageInput()}addClassName(e){this.setState(function(e){return t=>-1===t.extraClassNames.indexOf(e)?{extraClassNames:[...t.extraClassNames,e]}:null}(e))}removeClassName(e){this.setState(function(e){return t=>({extraClassNames:t.extraClassNames.filter(t=>t!==e)})}(e))}renderChat(){const{isHydrated:e,config:t,chatWidthBreakpoint:n}=this.props,{areModulesLoaded:a}=this.state,r=this.state.numPanelsCovering>0&&t.public.layout?.hasContentMaxWidth&&n===tn.g.WIDE;return s.createElement("div",{className:"WACWidget--content"},this.renderCustomPanel(),this.renderHydrationPanel(),e&&a&&s.createElement(s.Fragment,null,this.renderDisclaimerPanel(),this.renderResponsePanel(),this.renderHomeScreenPanel(),this.renderIFramePanel(),this.renderViewSourcePanel(),r&&s.createElement("div",{className:"WACBackgroundCover"}),this.renderBotChat()))}renderBotChat(){const{botName:e,languagePack:t,config:n,serviceManager:a,botMessageState:r,agentState:o,allMessageItemsByID:i,isHydrated:c,locale:l,theme:d,headerDisplayName:h,headerAvatarConfig:g}=this.props,{numPanelsAnimating:p,numPanelsOpen:f,isHydrationAnimationComplete:S}=this.state,y=(0,u.i_)(this.props),C=(0,u.R0)(this.props),E=this.getShowDisclaimer();let _;return S?p>0?_=!1:f>0&&(_=!0):_=!0,s.createElement(Zt.G,{className:"WACBotContainer",hidden:_},s.createElement(s.Suspense,{fallback:null},s.createElement(nn,{botName:e,headerDisplayName:h,headerAvatarConfig:g,ref:this.botChatRef,languagePack:t,config:n,serviceManager:a,onClose:this.onClose,onCloseAndRestart:this.onCloseAndRestart,messageState:r,onSendInput:e=>this.onSendInput(e,m.vW.MESSAGE_INPUT),agentState:o,agentDisplayState:C,allMessageItemsByID:i,onRestart:this.onRestart,isHydrated:c,isHydrationAnimationComplete:S&&!E,inputState:y,onToggleHomeScreen:this.onToggleHomeScreen,onUserTyping:this.onUserTyping,locale:l,useAITheme:d.useAITheme,carbonTheme:d.carbonTheme})))}renderInnerHydrationPanel(){const{botMessageState:e,serviceManager:t,languagePack:n,headerDisplayName:a,persistedToBrowserStorage:r,homeScreenConfig:o}=this.props,{areModulesLoaded:i}=this.state,c=o.is_on&&!r.launcherState.hasSentNonWelcomeMessage;return s.createElement(qt,{headerDisplayName:a,isHydrated:0===e.isHydratingCounter&&i,serviceManager:t,onClose:this.onClose,languagePack:n,useHomeScreenVersion:c})}renderHydrationPanel(){const{botMessageState:e,serviceManager:t,catastrophicErrorType:n,persistedToBrowserStorage:a}=this.props,{viewState:r}=a.launcherState,{areModulesLoaded:o}=this.state;return s.createElement(Gt.j,{onOpenStart:()=>this.onPanelOpenStart(!1),onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseEnd:()=>{this.onHydrationPanelClose(),this.onPanelCloseEnd(!1)},animationOnOpen:Yt.K.NONE,animationOnClose:Yt.v.NONE,shouldOpen:(e.isHydratingCounter>0||!o)&&!n&&r.mainWindow,shouldHide:!1,serviceManager:t,overlayPanelName:Gt.G.HYDRATING},this.renderInnerHydrationPanel())}renderCatastrophicPanel(){const{serviceManager:e,botName:t,languagePack:n,headerDisplayName:a}=this.props;return s.createElement(Gt.j,{animationOnOpen:Yt.K.NONE,animationOnClose:Yt.v.NONE,shouldOpen:!0,serviceManager:e,overlayPanelName:Gt.G.CATASTROPHIC},s.createElement(s.Suspense,{fallback:null},s.createElement(an,{onClose:this.onClose,headerDisplayName:a,languagePack:n,onRestart:this.onRestart,showHeader:!0,botName:t})))}renderDisclaimerPanel(){const{serviceManager:e,config:t}=this.props,n=this.getShowDisclaimer();return t.public.disclaimer?.is_on?s.createElement(Gt.j,{onOpenStart:()=>this.onPanelOpenStart(!1),onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseEnd:()=>this.onPanelCloseEnd(!1),animationOnOpen:Yt.K.FADE_IN,animationOnClose:Yt.v.FADE_OUT,shouldOpen:n,serviceManager:e,overlayPanelName:Gt.G.DISCLAIMER},s.createElement(s.Suspense,{fallback:null},s.createElement(sn,{onAcceptDisclaimer:this.onAcceptDisclaimer,onClose:this.onClose,disclaimerHTML:t.public.disclaimer?.disclaimerHTML,disclaimerAcceptButtonRef:this.disclaimerRef}))):null}renderHomeScreenPanel(){const{isHydrationAnimationComplete:e}=this.state,t=this.getShowHomeScreen();return s.createElement(s.Suspense,{fallback:null},s.createElement(rn,{onPanelOpenStart:()=>this.onPanelOpenStart(!1),onPanelOpenEnd:this.onPanelOpenEnd,onPanelCloseStart:this.onPanelCloseStart,onPanelCloseEnd:()=>this.onPanelCloseEnd(!1),onClose:this.onClose,onCloseAndRestart:this.onCloseAndRestart,onSendBotInput:e=>this.onSendInput(e,m.vW.HOME_SCREEN_INPUT),onSendButtonInput:this.onSendHomeButtonInput,onRestart:this.onRestart,showHomeScreen:t,isHydrationAnimationComplete:e,homeScreenInputRef:this.homeScreenInputRef,onToggleHomeScreen:this.onToggleHomeScreen,requestFocus:this.requestFocus}))}renderIFramePanel(){const{serviceManager:e,iFramePanelState:t}=this.props;return s.createElement(Gt.j,{className:"WAC__overlay--covering",onOpenStart:()=>this.onPanelOpenStart(!0),onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseEnd:()=>this.onPanelCloseEnd(!0),animationOnOpen:Yt.K.SLIDE_IN_FROM_BOTTOM,animationOnClose:Yt.v.SLIDE_OUT_TO_BOTTOM,shouldOpen:t.isOpen,serviceManager:e,overlayPanelName:Gt.G.IFRAME},s.createElement(s.Suspense,{fallback:null},s.createElement(on,{useAITheme:this.props.theme.useAITheme,ref:this.iframePanelRef,onClickClose:this.onClose,onClickRestart:this.onRestart,onClickCloseAndRestart:this.onCloseAndRestart})))}renderViewSourcePanel(){const{serviceManager:e,viewSourcePanelState:t}=this.props;return s.createElement(Gt.j,{className:"WAC__overlay--covering",onOpenStart:()=>this.onPanelOpenStart(!0),onCloseStart:this.onPanelCloseStart,onOpenEnd:this.onPanelOpenEnd,onCloseEnd:()=>this.onPanelCloseEnd(!0),animationOnOpen:Yt.K.SLIDE_IN_FROM_BOTTOM,animationOnClose:Yt.v.SLIDE_OUT_TO_BOTTOM,shouldOpen:t.isOpen,serviceManager:e,overlayPanelName:Gt.G.CONVERSATIONAL_SEARCH_CITATION},s.createElement(s.Suspense,{fallback:null},s.createElement(cn,{ref:this.viewSourcePanelRef,onClickClose:this.onClose,onClickRestart:this.onRestart,onClickCloseAndRestart:this.onCloseAndRestart})))}renderCustomPanel(){return s.createElement(Qt,{useAITheme:this.props.theme.useAITheme,onClose:this.onClose,onClickRestart:this.onRestart,onCloseAndRestart:this.onCloseAndRestart,onPanelOpenStart:()=>this.onPanelOpenStart(!0),onPanelOpenEnd:this.onPanelOpenEnd,onPanelCloseStart:this.onPanelCloseStart,onPanelCloseEnd:()=>this.onPanelCloseEnd(!0)})}renderResponsePanel(){if(!this.props.responsePanelState.localMessageItem)return null;const{isOpen:e,localMessageItem:t,isMessageForInput:n}=this.props.responsePanelState,a=(t?.item).panel,r=Gt.G.PANEL_RESPONSE;return s.createElement(s.Suspense,{fallback:null},s.createElement(ln,{eventName:'"Show panel" opened',eventDescription:"Panel opened through panel response type",overlayPanelName:r,testIdPrefix:r,isOpen:e,isMessageForInput:n,localMessageItem:t,title:a?.title,showAnimations:a?.show_animations,useAITheme:this.props.theme.useAITheme,requestFocus:this.requestFocus,onClose:this.onClose,onClickRestart:this.onRestart,onCloseAndRestart:this.onCloseAndRestart,onClickBack:()=>this.props.serviceManager.store.dispatch(l.Ay.setResponsePanelIsOpen(!1)),onPanelOpenStart:()=>this.onPanelOpenStart(!0),onPanelOpenEnd:this.onPanelOpenEnd,onPanelCloseStart:this.onPanelCloseStart,onPanelCloseEnd:()=>{this.onPanelCloseEnd(!0),this.props.serviceManager.store.dispatch(l.Ay.setResponsePanelContent(null,!1))}}))}renderWidget(){const{serviceManager:e,useCustomHostElement:t,locale:n,catastrophicErrorType:a,config:r,isHydrated:o,theme:i,chatWidthBreakpoint:c,layout:l,languagePack:u}=this.props,{closing:d,open:h,extraClassNames:g}=this.state,m=`WACLocale-${n||"en"}`,p=r.public.enableFocusTrap&&h&&!r.public.hideCloseButton&&!r.public.headerConfig.hideMinimizeButton,f=Boolean(p&&o),S=c===tn.g.WIDE;return s.createElement(kt,{active:f},s.createElement("div",{className:rt("WACMainWindow","WACWidget__FocusTrapContainer",...g),ref:this.mainWindowRef},p&&s.createElement("div",{className:"WACWidget__FocusTrapGlass"}),s.createElement("div",{id:`WACWidget${e.namespace.suffix}`,className:rt(`WACWidget ${m}`,{"WACWidget--rounded":i.corners===R.L.ROUND,"WACWidget--defaultElement":!t,"WACWidget--launched":!d,"WACWidget--closing":d,"WACWidget--closed":!h,"WACWidget--maxWidth":S&&l.hasContentMaxWidth,[dn]:c===tn.g.NARROW,[un]:c===tn.g.STANDARD,[hn]:S}),ref:this.containerRef},s.createElement(Jt.A,null,s.createElement("h1",null,u.window_title)),a&&this.renderCatastrophicPanel(),!a&&s.createElement("div",{ref:this.animationContainerRef,className:"WACWidget__animationContainer",onScroll:()=>{0!==this.animationContainerRef.current.scrollTop&&(this.animationContainerRef.current.scrollTop=0)}},this.renderChat()),s.createElement("div",{className:"WACMainWindowModalHost",ref:this.setModalPortalHostElement}))))}render(){return s.createElement(en.B.Provider,{value:this.state.modalPortalHostElement},this.renderWidget())}}var mn=(0,ct.Ng)(e=>e,null,null,{forwardRef:!0})(gn);const pn=(0,at.QT)();function fn({serviceManager:e,hostElement:t,applicationStyles:n,fontStyles:a}){const{store:r}=e,{config:o}=r.getState();o.public.debug&&(0,g.$Z)("[render] Called render");const i=`${a?`${a} `:""}${n}`;return s.createElement(ct.Kq,{store:r},s.createElement(Sn,{serviceManager:e,hostElement:t,applicationStyles:i}))}function Sn({serviceManager:e,hostElement:t,applicationStyles:n}){const a=(0,ct.d4)(e=>e.languagePack),r=(0,ct.d4)(e=>e.cssVariableOverrides),o=(0,ct.d4)(e=>e.theme),i=(0,ct.d4)(e=>e.config),c=(0,ct.d4)(e=>e.layout),{namespace:u}=e,{originalName:d}=u,h=(0,ct.wA)(),[g,m]=(0,s.useState)({width:window.innerWidth,height:window.innerHeight}),p=(0,s.useMemo)(()=>function(e){let t="";const n=Object.keys(e).map(t=>{const n=e[t];return void 0===n?"":`${t.startsWith("$")?`${ue}${t.replace(/^\$/,"")}`:`${ue}chat-${t}`}:${n};`}).join("");return n.length>0&&(t=`.WACContainer .cds--white, .WACContainer .cds--g10, .WACContainer .cds--g90, .WACContainer .cds--g100, :host{${n}}`),t}(r),[r]),f=document.dir||"auto";return(0,mt.y)(()=>{const e=()=>{m({width:window.innerWidth,height:window.innerHeight})};window.addEventListener("resize",e);const t=()=>{h(l.Ay.setIsBrowserPageVisible("visible"===document.visibilityState))};return document.addEventListener("visibilitychange",t),()=>{window.removeEventListener("resize",e),document.removeEventListener("visibilitychange",t)}}),s.createElement("div",{className:"WACContainer","data-namespace":d,ref:e=>{e&&t&&(e.style.setProperty("height","100%","important"),e.style.setProperty("width","100%","important"))}},s.createElement("div",{className:"WACContainer--styles"},s.createElement("style",{"data-base-styles":"true",nonce:i.public.cspNonce},n||".WACContainer { visibility: hidden; }"),s.createElement("style",{"data-variables-custom":"true",nonce:i.public.cspNonce},p)),s.createElement("div",{className:rt("WACContainer--render",Se(o),{"WACContainer-disableMobileEnhancements":t&&i.public.disableCustomElementMobileEnhancements,"WAC-isPhone":We.a3&&!i.public.disableCustomElementMobileEnhancements,"WAC-isPhonePortraitMode":We.cT&&!i.public.disableCustomElementMobileEnhancements,"WAC--frameless":!c?.showFrame}),dir:f},s.createElement(Ht.l.Provider,{value:g},s.createElement(Wt.k.Provider,{value:e},s.createElement(ot.Kq,{value:e.intl},s.createElement(Lt.F.Provider,{value:a},s.createElement(ht,null,s.createElement(yn,{serviceManager:e,hostElement:t}))))))))}function yn(e){const{hostElement:t,serviceManager:n}=e,a=(0,ct.d4)(e=>e.launcher.config.is_on),{viewState:r}=(0,ct.d4)(e=>e.persistedToBrowserStorage.launcherState),o=(0,s.useRef)(),i=(0,s.useRef)(),c=r.tour,l=(0,s.useRef)(c);l.current=c||l.current;const u=(0,it.A)(),d=n.namespace.originalName,h=d?"window_ariaChatRegionNamespace":"window_ariaChatRegion",m=u.formatMessage({id:h},{namespace:d});return(0,mt.y)(()=>{n.appWindow={requestFocus:function(){try{const{persistedToBrowserStorage:e}=n.store.getState(),{viewState:t}=e.launcherState;t.tour?o.current?.requestFocus():t.mainWindow&&i.current?.requestFocus()}catch(e){(0,g.yA)("An error occurred in App.requestFocus",e)}}}}),s.createElement("div",{className:"WACWidget__regionContainer",role:"region","aria-label":m},s.createElement(mn,{mainWindowRef:i,useCustomHostElement:Boolean(t),serviceManager:n}),l.current&&s.createElement(s.Suspense,{fallback:null},s.createElement(pn,{ref:o})),a&&s.createElement(Bt,null))}var Cn=n(8325);function En({chatInstance:e,renderUserDefinedResponse:t,userDefinedResponseEventsBySlot:n}){return t?Object.entries(n).map(([n,a])=>{const{element:r}=a;return r?s.createElement(_n,{key:n,hostElement:r},t(a,e)):null}):null}function _n({hostElement:e,children:t}){return Cn.createPortal(t,e)}const An=s.memo(En);function vn({chatInstance:e,renderResponseMap:t}){return s.createElement(s.Fragment,null,Object.keys(e.writeableElements).map(n=>{const a=t[n];return a?s.createElement(Tn,{key:n,hostElement:e.writeableElements[n]},a):null}))}function Tn({hostElement:e,children:t}){return Cn.createPortal(t,e)}const In=s.memo(vn);function wn({config:e,onBeforeRender:t,onAfterRender:n,renderUserDefinedResponse:r,renderWriteableElements:o,container:i,setParentInstance:l,element:u}){const[d,h]=(0,s.useState)(null),[p,f]=(0,s.useState)(null),[S,y]=(0,s.useState)(null),C=e=>{h(e),l?.(e)},[E,_]=(0,s.useState)({}),A=(0,s.useRef)(null),v=(0,s.useRef)(null);return(0,s.useEffect)(()=>{const s=v.current;if(v.current=e,!(0,a.A)(s,e)){const a={instance:null,shouldDestroy:!1,config:e};return e&&async function({managedWebChatRef:e,managedWebChat:t,render:n,setInstance:a,onBeforeRender:s,onAfterRender:r,setUserDefinedResponseEventsBySlot:o,element:i}){if(await Mn(e.current,a),e.current=t,t.shouldDestroy)return void await Mn(t,a);const l=await async function(e,t,n,a){const s=(0,c.A)(e);if(!s.messaging?.customSendMessage)throw new Error("You must set messaging.customSendMessage in your configuration object.");s?.debug&&(0,g.$Z)("[ChatEntry] Called instantiateWidget",s),"https:"!==document.location.protocol&&(0,g.OP)('Your page is not running with "https"; your data will not be sent  securely.'),"CSS1Compat"!==document.compatMode&&(0,g.OP)('Your page is running in quirks mode; you may experience layout issues with the chat. Add "<!DOCTYPE html>" to the page to run in standards mode.');const{onError:r,...o}=s;return new(await Promise.resolve(st))(o,a,{onError:r,render:n})}(t.config,0,Promise.resolve(n),i),u=await l.start();(function(e,t){e.on({type:m.xp.CHUNK_USER_DEFINED_RESPONSE,handler:function(e){if("complete_item"in e.data.chunk){const n=e.data.chunk.complete_item;t(t=>({...t,[e.data.slot]:{messageItem:n,element:e.data.element}}))}else if("partial_item"in e.data.chunk){const n=e.data.chunk.partial_item;t(t=>({...t,[e.data.slot]:{partialItems:[...t[e.data.slot]?.partialItems||[],n],element:e.data.element}}))}}}),e.on({type:m.xp.USER_DEFINED_RESPONSE,handler:function(e){t(t=>({...t,[e.data.slot]:{fullMessage:e.data.fullMessage,messageItem:e.data.message,element:e.data.element}}))}}),e.on({type:m.xp.RESTART_CONVERSATION,handler:function(){t({})}})})(u,o),s?.(u),await u.render(),r?.(u),a(u),t.instance=u,t.shouldDestroy&&await Mn(t,a)}({managedWebChatRef:A,managedWebChat:a,render:async function({serviceManager:e}){const t=await async function(){const[e,t]=await Promise.all([Rn(),Nn()]);return t+e}();e.container=i,e.customHostElement?(i.style.setProperty("width","100%","important"),i.style.setProperty("height","100%","important")):(i.style.setProperty("width","0","important"),i.style.setProperty("height","0","important")),y(t),f({serviceManager:e}),await(0,Q.y)(0)},setInstance:C,onBeforeRender:t,onAfterRender:n,setUserDefinedResponseEventsBySlot:_,element:u}),()=>{Mn(a,C),v.current=null}}},[e,i]),p&&d?s.createElement(s.Fragment,null,s.createElement(fn,{serviceManager:p.serviceManager,hostElement:p.serviceManager.customHostElement,applicationStyles:S}),r&&s.createElement(An,{chatInstance:d,renderUserDefinedResponse:r,userDefinedResponseEventsBySlot:E}),o&&s.createElement(In,{chatInstance:d,renderResponseMap:o})):null}async function Mn(e,t){e&&(e.instance&&(e.instance.destroy(),await(0,Q.y)(0)),e.shouldDestroy=!0,e.instance=null),t(null),await(0,Q.y)(0)}const bn=s.memo(wn),Rn=async()=>{const{default:e}=await n.e(3212).then(n.bind(n,3212));return e},Nn=async()=>{const{default:e}=await n.e(2971).then(n.bind(n,2971));return e}},2537:function(e,t,n){n.d(t,{J:function(){return r}});var a=n(3696),s=n(395);function r(e){const t=a.forwardRef((t,n)=>{const r=(0,a.useContext)(s.s);return a.createElement(e,{...t,ref:n,ariaAnnouncer:r})});return t.displayName=`withAriaAnnouncer(${e.displayName||e.name||"Component"})`,t}},2566:function(e,t,n){var a;function s(e,t){return t?`${t}-${e}`:e}n.d(t,{W:function(){return s},g:function(){return a}}),function(e){e.CLOSE_CHAT="close_chat",e.LAUNCHER="launcher_open_chat",e.INPUT="input_field",e.INPUT_SEND="input_send"}(a||(a={}))},3092:function(e,t,n){var a;n.d(t,{J:function(){return a}}),function(e){e[e.NONE=1]="NONE",e[e.FAILED=2]="FAILED",e[e.RETRYING=3]="RETRYING",e[e.WAITING=4]="WAITING"}(a||(a={}))},4271:function(e,t,n){var a,s;n.d(t,{K:function(){return a},v:function(){return s}}),function(e){e.NONE="none",e.FADE_IN="fadeIn",e.SLIDE_IN_FROM_LEFT="slideInFromLeft",e.SLIDE_IN_FROM_RIGHT="slideInFromRight",e.SLIDE_IN_FROM_BOTTOM="slideInFromBottom",e.BRANDING_SLIDE_IN_FROM_BOTTOM="brandingSlideInFromBottom"}(a||(a={})),function(e){e.NONE="none",e.FADE_OUT="fadeOut",e.SLIDE_OUT_TO_LEFT="slideOutToLeft",e.SLIDE_OUT_TO_RIGHT="slideOutToRight",e.SLIDE_OUT_TO_TOP="slideOutToTop",e.SLIDE_OUT_TO_BOTTOM="slideOutToBottom"}(s||(s={}))},4458:function(e,t,n){n.d(t,{G:function(){return a},j:function(){return l}});var a,s=n(4452),r=n(3696),o=n(4271),i=n(5230),c=n(6516);!function(e){e.MAIN="main",e.DISCLAIMER="disclaimer",e.HOME_SCREEN="home_screen",e.HYDRATING="hydrating",e.CATASTROPHIC="catastrophic",e.IFRAME="iframe",e.CONVERSATIONAL_SEARCH_CITATION="conversational_search_citation",e.CUSTOM="custom",e.SHOW_PANEL="show_panel",e.PANEL_RESPONSE="panel_response"}(a||(a={}));class l extends r.PureComponent{constructor(){super(...arguments),this.state={isClosing:!1,isOpening:!1},this.openPanelTimeout=null,this.closePanelTimeout=null,this.openPanel=()=>{const{onOpenEnd:e,onOpenStart:t,animationOnOpen:n,animationDurationOpen:a}=this.props;t?.(),this.setState({isClosing:!1,isOpening:!0});const s=n===o.K.NONE?0:a||240;this.openPanelTimeout=(0,i.Ah)(()=>{this.setState({isClosing:!1,isOpening:!1}),e?.()},s)},this.closePanel=()=>{const{onCloseEnd:e,onCloseStart:t,animationOnClose:n,animationDurationClose:a}=this.props;t?.(),this.setState({isClosing:!0,isOpening:!1});const s=n===o.v.NONE?0:a||240;this.closePanelTimeout=(0,i.Ah)(()=>{this.setState({isClosing:!1,isOpening:!1}),e?.()},s)}}componentDidMount(){const{shouldOpen:e}=this.props;e&&this.openPanel()}componentDidUpdate(e){const{shouldOpen:t}=this.props;t!==e.shouldOpen&&(t?this.openPanel():this.closePanel())}componentWillUnmount(){this.openPanelTimeout&&clearTimeout(this.openPanelTimeout),this.closePanelTimeout&&clearTimeout(this.closePanelTimeout),this.props.shouldOpen&&(this.props.onCloseStart&&this.props.onCloseStart(),this.props.onCloseEnd&&this.props.onCloseEnd())}render(){const{children:e,className:t,shouldOpen:n,animationOnClose:a,animationOnOpen:o,overlayPanelName:i}=this.props,{isClosing:l,isOpening:u}=this.state;return r.createElement(c.G,{hidden:!l&&!n,className:s("WAC__overlay-panelContainer",`WAC__overlay--${i}`,t,{"WAC__overlay-panelContainer--animating":u||l})},r.createElement("div",{className:s("WAC__overlay-panel",`WAC__overlay-panel--${i}`,{[`WAC__overlay-panel--closing--${a}`]:l,"WAC__overlay-panel--closed":!l&&!n,[`WAC__overlay-panel--opening--${o}`]:u,"WAC__overlay-panel--open":!u&&n})},e))}}},4630:function(e,t,n){n.d(t,{l:function(){return a}});const a=n(3696).createContext(!1)},4774:function(e,t,n){n.d(t,{Ay$:function(){return a}});var a={ai_slug_title:"Powered by IBM watsonx",ai_slug_description:"IBM watsonx is powered by the latest AI models to intelligently process conversations and provide help whenever and wherever you may need it.",components_overflow_ariaLabel:"Open and close list of options",components_swiper_currentLabel:"{currentSlideNumber}/{totalSlideCount}",errors_communicating:"{botName} isn't available right now. Problems with a related system are preventing the data from being supplied.",errors_imageSource:"Image is not available.",errors_videoSource:"Video is not available.",errors_audioSource:"Audio is not available.",errors_iframeSource:"The web page is not available.",errors_singleMessage:"There is an error with the message you just sent, but feel free to ask me something else.",errors_ariaMessageRetrying:"We are having some trouble sending your message but are still trying",errors_ariaMessageFailed:"Your message failed to be sent",errors_noAgentsAvailable:"No agents are available.",errors_noAgentsJoined:"No agents accepted the chat",errors_connectingToAgent:"I'm sorry. Something went wrong and I cannot connect you to an agent right now.",errors_busy:"I'm sorry, but I can't help you right now. I'm answering questions from lots of people at the moment. Please try again later.",errors_agentAppSessionExpired:"I'm sorry, but access to the chat history has expired.",errors_generalContent:"There was an error displaying this content",errors_somethingWrong:"Something went wrong",input_ariaLabel:"Message to send",input_placeholder:"Type something...",input_buttonLabel:"Click to send message",input_uploadButtonLabel:"Add files to upload",window_title:"Chat window",window_ariaTourRegion:"Tour",window_ariaTourRegionNamespace:"Tour {namespace}",window_ariaChatRegion:"Chat",window_ariaChatRegionNamespace:"Chat {namespace}",window_ariaWindowOpened:"The chat window has been opened",window_ariaWindowClosed:"The chat window has been closed",window_ariaWindowLoading:"The chat is loading.",launcher_isOpen:"Close the chat window",launcher_isClosed:"Open the chat window",launcher_isTourOpen:"Close the tour window",launcher_isTourClosed:"Open the tour window",launcher_desktopGreeting:"Hi! Im a virtual assistant. How can I help you today?",launcher_mobileGreeting:"Hi! How can I help you today?",launcher_ariaIsExpanded:"Close the chat launcher",launcher_closeButton:"Close",messages_youSaid:"You said",messages_botSaid:"{botName} said",messages_agentSaid:"The live agent said",messages_searchResults:"Search results",messages_searchResultsLink:"Open this search result in a new window",messages_searchResultsOpenDocument:"Open document",messages_searchResultsOpenDocumentWithLabel:'Open document "{documentName}"',messages_searchResultsExpand:"Expand",messages_searchResultsCollapse:"Collapse",messages_botIsLoading:"{botName} is loading",messages_botIsTyping:"{botName} is typing",messages_agentIsTyping:"The live agent is typing",messages_scrollHandle:"Chat history begin",messages_scrollHandleDetailed:"Chat history begin. Activate to focus the first message then use the arrow, home, and end keys to move between messages. Press escape to exit.",messages_scrollHandleEnd:"Chat history end",messages_scrollHandleEndDetailed:"Chat history end. Activate to focus the last message then use the arrow, home, and end keys to move between messages. Press escape to exit.",message_labelBot:"{actorName} {timestamp}",message_labelYou:"You {timestamp}",notifications_toastClose:"Close notification",buttons_restart:"Restart conversation",buttons_cancel:"Cancel",buttons_retry:"Retry",options_select:"Select an option",options_ariaOptionsDisabled:"These options are disabled and cannot be selected",header_previewLinkTitle:"Assistant preview",header_ariaCloseRestart:"End chat and close the window",header_ariaBotAvatar:"{botName} avatar image",header_overflowMenu_options:"Options",homeScreen_returnToAssistant:"Return to assistant",homeScreen_returnToHome:"Return to the home screen",homeScreen_overflowMenuHomeScreen:"Home screen",homeScreen_ariaQuickStartListButton:"Quick start menu",homeScreen_ariaQuickStartListOpened:"The quick start menu has been opened.",homeScreen_ariaQuickStartListClosed:"The quick start menu has been closed.",default_agent_availableMessage:"Request an agent, and I'll notify you when they're ready. Your wait time may vary based on availability.",default_agent_unavailableMessage:"Sorry, no agents are available right now.",agent_reason_error:"Hmmm... I'm experiencing some difficulties. I need a human agent to manually continue the chat.",agent_sdMissingWarning:'No service desk is configured. Unless you have a custom service desk implemented, users will see an error instead of the message below. See the <a href="https://cloud.ibm.com/docs/watson-assistant?topic=watson-assistant-deploy-web-chat-haa" rel="noreferrer noopener" target="_blank">documentation</a> for more information.',agent_noName:"Live agent",agent_chatTitle:"Live agent support",agent_startChat:"Connect to agent",agent_connecting:"Request for agent sent...",agent_agentNoNameTitle:"Agent",agent_agentJoinedName:"{personName} connected.",agent_agentJoinedNoName:"A live agent connected.",agent_youConnectedWarning:"If you refresh or leave the current page, you'll have to request a new agent.",agent_connectingMinutes:"Current wait time is <b>{time, number} {time, plural, one {minute} other {minutes}}</b>.",agent_connectingQueue:"You're number <b>{position, number}</b> in line.",agent_ariaAgentAvatar:"Live agent avatar image",agent_ariaGenericAvatar:"Avatar image",agent_ariaGenericBotAvatar:"Avatar image",agent_youEndedChat:"You disconnected from the live agent.",agent_conversationWasEnded:"You disconnected from the live agent.",agent_disconnected:"Something went wrong and your connection to the live agent was lost. Check your internet connection and then try again to connect to an agent.",agent_reconnected:"The agent reconnected.",agent_agentLeftChat:"{personName} disconnected.",agent_agentLeftChatNoName:"The live agent disconnected.",agent_agentEndedChat:"{personName} ended the chat.",agent_agentEndedChatNoName:"The live agent ended the chat.",agent_transferring:"You're being transferred.",agent_transferringNoName:"You're being transferred.",agent_endChat:"Disconnect from live agent?",agent_confirmSuspendedEndChatTitle:"Disconnect from previous agent?",agent_confirmSuspendedEndChatMessage:"You are currently connected to an agent. Continuing will disconnect you from the agent and connect you to a new one. Do you want to continue?",agent_confirmCancelRequestTitle:"Cancel request?",agent_confirmCancelRequestMessage:"If you continue, you'll cancel your request for an agent.",agent_confirmCancelRequestNo:"Go back",agent_confirmCancelRequestYes:"Cancel request",agent_confirmEndChat:"If you disconnect, you'll have to request a new live agent.",agent_confirmEndChatNo:"Go back",agent_confirmEndChatYes:"Disconnect",agent_confirmEndSuspendedYes:"Continue",agent_botReturned:"Can I help you with anything else?",agent_newMessage:"New message",agent_cardButtonChatRequested:"Connecting...",agent_cardButtonConnected:"Connected",agent_cardButtonChatEnded:"Disconnected",agent_cardMessageChatEnded:"You disconnected from the live agent.",agent_cardMessageConnected:"You're now connected.",agent_connectButtonCancel:"Cancel",agent_connectedButtonEndChat:"Disconnect",agent_connectWaiting:"Waiting...",agent_defaultMessageToAgent:"Begin conversation",agent_inputPlaceholderConnecting:"Waiting for agent...",agent_inputPlaceholderReconnecting:"Reconnecting to agent...",agent_sharingStopSharingButton:"Stop sharing screen",agent_sharingRequestTitle:"Screen sharing",agent_sharingRequestMessage:"The agent has requested you share your screen. You can stop sharing at any time.",agent_sharingAcceptButton:"Share screen",agent_sharingDeclineButton:"Decline",agent_sharingRequested:"You were requested to share your screen.",agent_sharingAccepted:"You shared your screen.",agent_sharingDeclined:"You declined to share your screen.",agent_sharingCancelled:"The screen sharing request was cancelled.",agent_sharingEnded:"You stopped sharing your screen.",agent_suspendedWarning:"You are currently connected to an agent.",icon_ariaUnreadMessages:"There {count, plural, one {is} other {are}} {count, number} unread {count, plural, one {message} other {messages}}",showMore:"See more",showMoreResults:"See more",disclaimer_title:"Disclaimer",disclaimer_accept:"I accept",general_ariaCloseInformationOverlay:"Close information panel.",general_ariaAnnounceOpenedInformationOverlay:"An information panel has been opened.",general_ariaAnnounceClosedInformationOverlay:"An information panel has been closed.",general_ariaAnnounceEscapeOverlay:"Press escape or click the close button to close.",general_returnToAssistant:"Return to assistant",conversationalSearch_streamingIncomplete:"This message was not completed. Please try again.",conversationalSearch_viewSourceDocument:"View source",conversationalSearch_citationsLabel:"Sources",conversationalSearch_toggleCitations:"Open or close the list of sources",conversationalSearch_responseStopped:"Response stopped",launcher_chatNow:"Chat now",iframe_ariaSourceLoaded:"The web page has loaded.",iframe_ariaImageAltText:"Preview image for the web page panel.",iframe_ariaClosePanel:"Close the web page panel.",iframe_ariaOpenedPanel:"Web page panel has opened.",iframe_ariaClosedPanel:"Web page panel has closed.",iframe_ariaClickPreviewCard:"Click to open the web page panel and visit {source}.",closeAndRestartModal_title:"End chat",closeAndRestartModal_message:"Are you sure you want to end your chat?",closeAndRestartModal_confirm:"Yes",closeAndRestartModal_cancel:"No",datePicker_chooseDate:"Choose a date ({format})",datePicker_confirmDate:"Confirm date",tour_resumeButton:"Resume",tour_restartButton:"Restart",tour_startButton:"Get started",tour_doneButton:"Done",tour_ariaMinimizeButton:"Hide tour window",tour_ariaCloseButton:"Close tour window",tour_ariaChatButton:"Open the chat window",tour_ariaPreviousButton:"Go to previous step",tour_ariaNextButton:"Go to next step",tour_instructions:"Use the previous and next buttons to navigate between steps of the tour. Use the {chatButtonText} button to open that chat window.",tour_errorFetchingStep:"There was a problem fetching the next step.",tour_errorTitle:"Unable to continue",tour_errorBody:"The content failed to load. Please try again.",fileSharing_fileTooLarge:"The maximum file size allowed is {maxSize}.",fileSharing_ariaAnnounceSuccess:"The file was uploaded successfully.",fileSharing_fileIcon:"File icon",fileSharing_removeButtonTitle:"Remove file",fileSharing_statusUploading:"Uploading file",fileSharing_uploadFailed:"There was an error uploading the file.",fileSharing_agentMessageText:"File upload",fileSharing_request:"The agent has requested you upload a file.",carousel_prevNavButton:"Go to previous slide.",carousel_nextNavButton:"Go to next slide.",input_completionsTagApp:"App",input_completionsTagAssistant:"Assistant",table_filterPlaceholder:"Filter table",table_previousPage:"Previous page",table_nextPage:"Next page",table_itemsPerPage:"Items per page:",table_paginationSupplementalText:"of {pagesCount, number} {pagesCount, plural, one {page} other {pages}}",table_paginationStatus:"{start, number}{end, number} of {count, number} {count, plural, one {item} other {items}}",feedback_positiveLabel:"Good response",feedback_negativeLabel:"Bad response",feedback_defaultTitle:"Additional feedback",feedback_defaultPrompt:"Why did you choose this rating?",feedback_defaultPlaceholder:"Add a comment",feedback_submitLabel:"Submit",feedback_cancelLabel:"Cancel",input_stopResponse:"Stop response",messages_responseStopped:"Response stopped",chainOfThought_stepTitle:"{stepNumber, number}: {stepTitle}",chainOfThought_inputLabel:"Input",chainOfThought_outputLabel:"Output",chainOfThought_toolLabel:"Tool",chainOfThought_statusSucceededLabel:"Succeeded",chainOfThought_statusFailedLabel:"Failed",chainOfThought_statusProcessingLabel:"Processing",chainOfThought_explainabilityLabel:"How did I get this answer?"}},5005:function(e,t,n){n.d(t,{l:function(){return s}});var a=n(3696);class s extends a.PureComponent{constructor(){super(...arguments),this.state={showChildren:!1}}componentDidMount(){this.onComponentDidMount=setTimeout(()=>{this.setState({showChildren:!0})},this.props.delay)}componentWillUnmount(){clearTimeout(this.onComponentDidMount),this.onComponentDidMount=void 0}render(){return!!this.state.showChildren&&this.props.children}}s.defaultProps={delay:500}},5041:function(e,t,n){function a(){let e,t;const n=new Promise((n,a)=>{e=n,t=a});return n.doResolve=t=>{n.isResolved=!0,n.isComplete=!0,e(t)},n.doReject=e=>{n.isRejected=!0,n.isComplete=!0,t(e)},n.isResolved=!1,n.isRejected=!1,n.isComplete=!1,n}n.d(t,{H:function(){return a}})},5088:function(e,t,n){n.d(t,{$F:function(){return p},$O:function(){return l},Mx:function(){return c},QT:function(){return g},RE:function(){return s},ZF:function(){return d},ad:function(){return h},cq:function(){return i},hY:function(){return o},j0:function(){return u},kN:function(){return m}});var a=n(3696);async function s(){const{createService:e}=await n.e(2340).then(n.bind(n,2340));return e}function r(e){const t=a.lazy(e);return t.preload=e,t}function o(){return r(()=>Promise.all([n.e(1264),n.e(7854),n.e(78),n.e(369),n.e(1240),n.e(9574)]).then(n.bind(n,9574)))}function i(){return r(()=>Promise.all([n.e(1264),n.e(369),n.e(4764)]).then(n.bind(n,7542)).then(e=>({default:e.CatastrophicError})))}function c(){return r(()=>Promise.all([n.e(1264),n.e(9692)]).then(n.bind(n,9692)).then(e=>({default:e.Disclaimer})))}function l(){return r(()=>n.e(2223).then(n.bind(n,2223)).then(e=>({default:e.HomeScreenContainer})))}function u(){return r(()=>Promise.all([n.e(1264),n.e(369),n.e(2930)]).then(n.bind(n,9440)).then(e=>({default:e.IFramePanel})))}function d(){return r(()=>n.e(7640).then(n.bind(n,7640)).then(e=>({default:e.ViewSourcePanel})))}function h(){return r(()=>Promise.all([n.e(1264),n.e(7854),n.e(78),n.e(369),n.e(1240),n.e(3955)]).then(n.bind(n,3955)).then(e=>({default:e.BodyAndFooterPanelComponent})))}function g(){return a.lazy(()=>Promise.all([n.e(1264),n.e(7854),n.e(369),n.e(3125)]).then(n.bind(n,3125)))}function m(){return a.lazy(()=>n.e(2665).then(n.t.bind(n,2665,19)).then(e=>{let t=e.default??e;return t&&"object"==typeof t&&"default"in t&&(t=t.default),{default:t}}))}function p(){return a.lazy(()=>Promise.all([n.e(705),n.e(2868)]).then(n.bind(n,2868)))}},5112:function(e,t,n){n.d(t,{A:function(){return s}});var a=n(3696);const s=a.forwardRef((e,t)=>a.createElement("div",{ref:t,...e,className:`WACVisuallyHidden ${e.className||""}`},e.children));s.displayName="VisuallyHidden"},5230:function(e,t,n){n.d(t,{Ah:function(){return p},PB:function(){return m},a3:function(){return d},cT:function(){return h},pz:function(){return l},w9:function(){return g},yS:function(){return u}});var a=n(4880),s=n(711);const r="undefined"!=typeof window&&"undefined"!=typeof navigator,o=r?(0,a.o0)():void 0;let i=0,c=0;r&&(i=window.screen.width,c=window.screen.height);const l="iOS"===o?.os,u=l||"Android OS"===o?.os,d=u&&(i<500||c<500),h=d&&i<500,g=(0,s.A)(function(){if(!r||!window.sessionStorage)return!1;try{return window.sessionStorage.setItem("web-chat-test-item","true"),window.sessionStorage.getItem("web-chat-test-item"),window.sessionStorage.removeItem("web-chat-test-item"),!0}catch{return!1}});function m(e){try{return new URL(e).hostname}catch{return e}}function p(e,t){return t?setTimeout(e,t):(e(),null)}},5608:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(3696);function s(e){const t=(0,a.useRef)();return(0,a.useEffect)(()=>{t.current=e}),t.current}},5688:function(e,t,n){n.d(t,{Y:function(){return re}}),n(712);var a,s=n(2794),r=n(8799),o=n(2642),i=n(7395),c=n(2629),l=n(4573),u=n(2213),d=n(393),h=n(9417),g=n(445),m=n(4452),p=n(3696),f=n(5022);!function(e){e.LINK="link",e.MENU="menu",e.BUTTON="button",e.RADIO_GROUP="radio-group"}(a||(a={}));var S=n(3210),y=n(4629),C=n(3981),E=(n(6677),n(3192)),_=n(404),A=n(7019),v=n(9890),T=n(619);class I extends E.WF{constructor(){super(...arguments),this.isLoaded=!1}_handleOnError(){this.onError?.()}}I.styles=E.AH`
    ${(0,E.iz)(".cds--aichat-chat-header-avatar{\n  display:block;\n  block-size:20px;\n  max-block-size:20px;\n}\n\n.cds--aichat-chat-header-avatar--round{\n  border-radius:10px;\n}")}
  `,(0,y.Cg)([(0,T.MZ)({type:String})],I.prototype,"url",void 0),(0,y.Cg)([(0,T.MZ)({type:String})],I.prototype,"corners",void 0),(0,y.Cg)([(0,T.MZ)({type:String})],I.prototype,"alt",void 0),(0,y.Cg)([(0,T.MZ)({type:Object})],I.prototype,"onError",void 0),(0,y.Cg)([(0,T.wk)()],I.prototype,"isLoaded",void 0),(0,y.Cg)([v.oI],I.prototype,"_handleOnError",null);const w="cds-aichat-chat-header-avatar";let M=class extends I{render(){return function(e){const{url:t,corners:n,alt:a,onError:s}=e;return E.qy`
    <img
      class="${m(`${_.o}-chat-header-avatar`,{[`${_.o}-chat-header-avatar--round`]:n===A.L.ROUND})}"
      src="${t}"
      alt="${a}"
      @error="${s}"
    />
  `}(this)}};M=(0,y.Cg)([(0,C.Q)(w)],M);const b=(0,S.a)({tagName:w,elementClass:M,react:p});n(236),n(1162);var R=n(6543);let N=class extends E.WF{constructor(){super(...arguments),this.isNewTab=!0}render(){return function(e){const{label:t,url:n,isNewTab:a}=e;return E.qy`<cds-custom-button
    class="WACChatHeaderLink"
    href="${n}"
    target="${a?"_blank":"_self"}"
    kind="${R.wQ.GHOST}"
    size="md"
    >${t}</cds-custom-button
  >`}(this)}};(0,y.Cg)([(0,T.MZ)({type:String})],N.prototype,"url",void 0),(0,y.Cg)([(0,T.MZ)({type:String})],N.prototype,"label",void 0),(0,y.Cg)([(0,T.MZ)({type:Boolean})],N.prototype,"isNewTab",void 0),N=(0,y.Cg)([(0,C.Q)(`${_.S}-chat-header-link`)],N);const O=(0,S.a)({tagName:`${_.S}-chat-header-link`,elementClass:N,react:p});var P=n(7073),D=n(112),B=n(3407),L=n(34);function H({id:e,className:t,label:n,isOpen:a,target:s,children:r,menuAlignment:o,containerRef:i}){return p.createElement(d.W1t,{id:e,className:t,open:a,target:s,label:n,size:"md",menuAlignment:o,mode:"full",legacyAutoalign:!1,containerRef:i},r)}function W(e){const[t,n]=(0,p.useState)(!1),{refs:a,context:s}=(0,B.we)({open:t,onOpenChange:n}),{getReferenceProps:r,getFloatingProps:o}=(0,B.bv)([(0,B.kp)(s),(0,B.s9)(s)]),i=(0,L.r)();return p.createElement("div",{ref:a.setReference,"aria-owns":i,...r()},p.createElement(d.$nd,{size:R.Ni.MEDIUM,kind:R.wQ.GHOST,onClick:()=>n(!t),renderIcon:t?D.A:P.A,onMouseDown:e=>e.preventDefault(),"aria-label":e.ariaLabel,"aria-haspopup":!0,"aria-expanded":t,"aria-controls":i},e.label),p.createElement(H,{id:i,isOpen:t,target:a.floating.current,label:e.label,containerRef:e.containerRef,menuAlignment:e.menuAlignment},e.children),p.createElement("div",{ref:a.setFloating,className:"WAChatHeaderMenuButton_HostElement",...o()}))}function k({label:e,url:t,isNewTab:n=!0,onClick:a,children:s}){return p.createElement(d.Drp,{label:e,onClick:()=>{a?.(),t&&window.open(t,n?"_blank":"_self")}},s)}function x(e){const{label:t,items:n,defaultSelectedItem:a,selectedItem:s,onChange:r}=e;return p.createElement(d.nU_,{label:t,items:n,defaultSelectedItem:a,selectedItem:s,onChange:e=>{e.preventDefault||r(e)},itemToString:e=>"string"==typeof e?e:e.label||e.value})}function U(e){const[t,n]=(0,p.useState)(!1),{refs:a,context:s}=(0,B.we)({open:t,onOpenChange:t=>{n(t),t?e.onOpen?.():e.onClose?.()}}),{getReferenceProps:r,getFloatingProps:o}=(0,B.bv)([(0,B.kp)(s),(0,B.s9)(s)]),i=(0,L.r)();return p.createElement("div",{ref:a.setReference,"aria-owns":i,...r()},p.createElement(d.$nd,{className:m("WACChatHeaderOverflowMenu__Button",e.className),size:R.Ni.MEDIUM,kind:R.wQ.GHOST,onClick:()=>n(!t),tooltipPosition:e.tooltipPosition,renderIcon:e.renderIcon,onMouseDown:e=>e.preventDefault(),iconDescription:e.iconDescription,hasIconOnly:!0,"aria-label":e.ariaLabel,"aria-haspopup":!0,"aria-expanded":t,"aria-controls":i}),p.createElement(H,{id:i,label:e.ariaLabel,isOpen:t,target:a.floating.current,containerRef:e.containerRef,menuAlignment:e.menuAlignment},e.children),p.createElement("div",{ref:a.setFloating,className:"WACChatHeaderOverflowMenu__HostElement",...o()}))}let F=class extends E.WF{render(){return function(e){const{title:t,name:n}=e;return E.qy`<div class="WACChatHeaderTitle">
    <span className="WACChatHeaderTitle__Title" ?hidden="${!t}"
      >${t}</span
    >
    <span class="WACChatHeaderTitle__Name">${n}</span>
  </div>`}(this)}};F.styles=E.AH`
    ${(0,E.iz)("cds-chat-header-title{\n  text-align:center;\n}\n\n.WACChatHeaderTitle{\n  overflow:hidden;\n  font-size:var(--cds-chat-BASE-font-size-med);\n  font-weight:400;\n  line-height:var(--cds-chat-BASE-line-height-med);\n  overflow-wrap:break-word;\n  text-overflow:ellipsis;\n  white-space:nowrap;\n  word-wrap:break-word;\n}\n\n.WACChatHeaderTitle .WACChatHeaderTitle__Title:only-child{\n  padding-inline-end:0.25rem;\n}\n\n.WACChatHeaderTitle__Name{\n  font-weight:var(--cds-chat-BASE-weight-semibold);\n}")}
  `,(0,y.Cg)([(0,T.MZ)({type:String})],F.prototype,"title",void 0),(0,y.Cg)([(0,T.MZ)({type:String})],F.prototype,"name",void 0),F=(0,y.Cg)([(0,C.Q)(`${_.S}-chat-header-title`)],F);const V=(0,S.a)({tagName:`${_.S}-chat-header-title`,elementClass:F,react:p});var $=n(4630),G=n(6254),q=n(5608),Y=n(6683),j=n(1748),z=n(8018),X=n(7338),K=n(8676),Q=n(8205),Z=(n(4776),n(3716));const J=(0,S.a)({tagName:"cds-custom-ai-label",elementClass:Z.A,react:p});var ee=n(3158),te=n(2566),ne=n(8795);function ae(e,t){const{displayName:n,backContent:S,showRestartButton:y,showBackButton:C,useAITheme:E,labelBackButton:_,onClickClose:A,onClickRestart:v,onCloseAndRestart:T,onClickBack:I,overflowItems:w,overflowClicked:M,backButtonType:N,showCenter:P,hideCloseButton:D,hideCloseAndRestartButton:B,brandColor:L="primary",enableChatHeaderConfig:H,headerAvatarConfig:F,testIdPrefix:Z}=e,ae=(0,p.useRef)(),re=(0,p.useRef)(),oe=(0,p.useRef)(),ie=(0,p.useRef)(),ce=(0,p.useRef)(),le=(0,p.useRef)(),ue=(0,p.useRef)(),de=(0,Y.O)(),he=(0,G.D)(),ge=(0,f.d4)(e=>e.config.public),me=(0,f.d4)(e=>e.chatHeaderState.config),pe=(0,f.d4)(e=>e.chatWidthBreakpoint),fe=(0,f.d4)(e=>e.chatHeaderState.maxVisibleHeaderObjects),[Se,ye]=(0,p.useState)(!1),[Ce,Ee]=(0,p.useState)(!1),[_e,Ae]=(0,p.useState)({}),[ve,Te]=(0,p.useState)(!1),Ie=Boolean(F)&&!ve,we=(0,p.useContext)($.l),Me=(0,q.Z)(F?.url),{headerConfig:be}=ge,Re=pe===z.g.WIDE,Ne=H?me?.headerTitle?.title:void 0,Oe=(H?me?.headerTitle?.name:void 0)||n,Pe=(0,p.useCallback)(()=>{Ee(!1)},[]),De=be?.showCloseAndRestartButton&&!B&&T,Be=be?.hideMinimizeButton||D;let Le,He=!1,We=!0;const ke=be?.minimizeButtonIconType;switch(ke){case ee.IB.CLOSE:Le=p.createElement(r.A,{className:"WACIcon__Close",size:16});break;case ee.IB.MINIMIZE:Le=p.createElement(u.A,{className:"WACIcon__Subtract",size:16});break;case ee.IB.SIDE_PANEL_LEFT:We=!1,Le=p.createElement(l.A,{className:"WACIcon__SidePanelClose"});break;case ee.IB.SIDE_PANEL_RIGHT:We=!1,He=!0,Le=p.createElement(l.A,{className:"WACIcon__SidePanelClose"});break;default:Le=p.createElement(u.A,{className:"WACIcon__Subtract",size:16})}if(De&&y)throw new Error("You cannot enable both the restart button and the close-and-restart buttons.");const xe=(0,p.useCallback)(()=>{Ee(!1),T()},[T]);function Ue(e,t,n){switch(e.type){case a.LINK:return p.createElement(k,{key:t,label:e.label,url:e.url,isNewTab:e.isNewTab,onClick:()=>{(0,X.Ht)(ue)}});case a.BUTTON:return p.createElement(k,{key:t,label:e.label,onClick:()=>{e.onClick?.(),(0,X.Ht)(ue)}});case a.RADIO_GROUP:{const s=n[t+1];return p.createElement(p.Fragment,{key:t},0!==t&&p.createElement(d.OHP,null),p.createElement(x,{label:e.label,items:e.items,defaultSelectedItem:e.defaultSelectedItem,selectedItem:_e[e.label],onChange:t=>{Ae(n=>({...n,[e.label]:t})),e.onChange?.(t)}}),Boolean(s)&&s.type!==a.RADIO_GROUP&&p.createElement(d.OHP,null))}case a.MENU:return p.createElement(k,{key:t,label:e.label},e.items.filter(e=>e.type!==a.MENU).map(Ue));default:return null}}function Fe(e,t){switch(e.type){case a.LINK:return p.createElement(O,{key:t,label:e.label,url:e.url,isNewTab:e.isNewTab});case a.MENU:return p.createElement(W,{key:t,label:e.label,menuAlignment:"bottom-start"},e.items.map(Ue));case a.BUTTON:return p.createElement(d.$nd,{key:t,kind:R.wQ.GHOST,size:R.Ni.MEDIUM,onClick:e.onClick},e.label);default:return null}}(0,p.useImperativeHandle)(t,()=>({requestFocus:()=>ie.current?((0,X.Ht)(ie,!1,!0),!0):ae.current?((0,X.Ht)(ae,!1,!0),!0):!!re.current&&((0,X.Ht)(re,!1,!0),!0)}));let Ve=0,$e=0;H&&(Ve=me?.left?.length??0,$e=me?.right?.length??0);const Ge=Ve>fe,qe=$e>fe,Ye=(Ve||$e)&&(!Re||Ge||qe),je=Boolean(w?.length)||Ye,ze="rtl"===document.dir;let Xe,Ke=null,Qe=null,Ze=null,Je=null;return H&&(Ke=me?.left?.slice(0,Ge?fe:void 0).map(Fe),Qe=me?.right?.slice(0,qe?fe:void 0).map(Fe),Ze=Ge&&me?.left?.slice(fe).map(Ue),Je=qe&&me?.right?.slice(fe).map(Ue)),je?Xe=p.createElement(U,{className:"WACHeader__OverflowMenu",renderIcon:Se?s.A:i.A,iconDescription:he.header_overflowMenu_options,ariaLabel:he.components_overflow_ariaLabel,containerRef:ue,tooltipPosition:ze?"left":"right",menuAlignment:"bottom-start",onOpen:()=>{setTimeout(()=>{ye(!0)})},onClose:()=>{ye(!1)}},w?.map((e,t)=>p.createElement(d.Drp,{key:e,label:e,onClick:()=>{(0,X.Ht)(ue),M(t)}})),Ze,Je):C&&(Xe=p.createElement(se,{className:"WACHeader__BackButton",label:_,onClick:I,buttonRef:ae,buttonKind:N,tooltipPosition:ze?"left":"right"},S||p.createElement(o.A,null))),(0,p.useEffect)(()=>{if(!Re)return void de.store.dispatch(j.Ay.setMaxVisibleHeaderObjects(0));if(!H)return;const e=new ResizeObserver(()=>{const e=le.current;if(e&&(e.offsetWidth>100||0===e.offsetWidth)){let e=Math.floor((ce.current.offsetWidth-100)/200);e<0&&(e=0),setTimeout(()=>{de.store.dispatch(j.Ay.setMaxVisibleHeaderObjects(e))})}});return e.observe(ce.current),()=>{e.disconnect()}},[Re,H,de]),(0,p.useEffect)(()=>{ve&&Me!==F?.url&&Te(!1)},[Me,F?.url,ve]),p.createElement("div",{className:m("WACHeader",`WAC--${L}Color`,{"WACHeader--withAvatar":Ie})},p.createElement("div",{className:m("WACHeader--content",`WAC--${L}Color`),"data-floating-menu-container":!0},Xe&&p.createElement("div",{className:"WACHeader__Buttons WACHeader__LeftButtons"},Xe),P&&p.createElement("div",{className:"WACHeader__CenterContainer"},Ie&&p.createElement(b,{url:F.url,corners:F.corners,alt:he.header_ariaBotAvatar,onError:()=>Te(!0)}),(Ne||Oe)&&p.createElement("div",{className:"WACHeader__TitleContainer"},p.createElement(V,{title:Ne,name:Oe})),Re&&Boolean(Ve)&&p.createElement("div",{className:"WACHeader__Separator"}),p.createElement("div",{ref:ce,className:"WACHeader__HeaderObjects"},Re&&Boolean(Ve)&&p.createElement("div",{className:"WACHeader__LeftItems"},Ke),p.createElement("div",{ref:le,className:"WACHeader__CenterGap"}),Re&&Boolean($e)&&p.createElement("div",{className:"WACHeader__RightItems"},Qe))),p.createElement("div",{className:"WACHeader__Buttons WACHeader__RightButtons"},E&&p.createElement(J,{className:"WACHeader__Slug",size:h.G.EXTRA_SMALL,alignment:ze?g.U.BOTTOM_LEFT:g.U.BOTTOM_RIGHT},p.createElement("div",{slot:"body-text"},p.createElement("h4",{className:"WACHeader__Slug-title"},he.ai_slug_title),p.createElement("div",{className:"WACHeader__Slug-description"},p.createElement("div",null,he.ai_slug_description),!we&&p.createElement(Q.A,{slotName:ne.t.AI_TOOLTIP_AFTER_DESCRIPTION_ELEMENT,id:`aiTooltipAfterDescription${de.namespace.suffix}`})))),y&&p.createElement(se,{className:"WACHeader__RestartButton",label:he.buttons_restart,onClick:v,buttonRef:re,tooltipPosition:ze?"right":"left"},p.createElement(c.A,null)),!Be&&p.createElement(se,{className:m("WACHeader__CloseButton",{WACReverseIcon:He}),isReversible:We,label:he.launcher_isOpen,onClick:async()=>{A()},buttonRef:ie,tooltipPosition:ze?"right":"left",testId:(0,te.W)(te.g.CLOSE_CHAT,Z)},Le),De&&p.createElement(se,{className:"WACHeader__CloseAndRestartButton",label:he.header_ariaCloseRestart,onClick:()=>Ee(!0),buttonRef:oe,tooltipPosition:ze?"right":"left"},p.createElement(r.A,{className:"WACIcon__Close"}))),Ce&&p.createElement(K.u,{title:he.closeAndRestartModal_title,message:he.closeAndRestartModal_message,onConfirm:xe,onCancel:Pe,cancelButtonLabel:he.closeAndRestartModal_cancel,confirmButtonLabel:he.closeAndRestartModal_confirm,modalAnnounceMessage:he.closeAndRestartModal_message,serviceManager:de})))}function se({onClick:e,buttonRef:t,label:n,className:a,children:s,buttonKind:r,isReversible:o=!0,tooltipPosition:i,testId:c}){return p.createElement(d.$nd,{ref:t,className:m(a,{WACDirectionHasReversibleSVG:o}),onClick:e,hasIconOnly:!0,iconDescription:n,size:R.Ni.MEDIUM,kind:r||R.wQ.GHOST,tooltipPosition:i,"data-testid":c},s)}const re=p.memo((0,p.forwardRef)(ae))},5807:function(e,t,n){n.d(t,{P:function(){return l},o:function(){return c}});var a=n(3696),s=n(7338),r=n(5112);const o=new Set(["button","date","datetime-local","email","file","month","number","range","reset","search","submit","tel","text","time","url","week"]),i="data-wac-exclude-node-read";class c extends a.PureComponent{constructor(){super(...arguments),this.ref1=a.createRef(),this.ref2=a.createRef(),this.useRef1=!0,this.doAnnouncements=()=>{const e=[];this.pendingValues.forEach(t=>{"string"==typeof t?e.push(t):l(t,e)});const t=this.useRef1?this.ref1.current:this.ref2.current;t&&(t.innerText=e.join(" "),(this.useRef1?this.ref2.current:this.ref1.current).innerHTML=""),this.useRef1=!this.useRef1,this.pendingValues=null}}announceValue(e){if(e)if(this.pendingValues||(this.pendingValues=[],setTimeout(this.doAnnouncements,250)),"string"==typeof e||function(e){return void 0!==e.nodeType}(e))this.pendingValues.push(e);else if(e.messageID){const t=this.props.intl.formatMessage({id:e.messageID},e.messageValues);this.pendingValues.push(t)}else this.pendingValues.push(e.messageText)}render(){return a.createElement(r.A,{className:"WACAriaAnnouncer"},a.createElement("div",{ref:this.ref1,"aria-live":"polite"}),a.createElement("div",{ref:this.ref2,"aria-live":"polite"}))}}function l(e,t){(0,s.vq)(e)?"none"===window.getComputedStyle(e).display||"true"===e.getAttribute("aria-hidden")||e.hasAttribute(i)||(u(e.getAttribute("aria-label"),t),(0,s.vQ)(e)&&o.has(e.type.toLowerCase())?""===e.value?u(e.placeholder,t):u(e.value,t):(0,s.rG)(e)?""===e.value&&u(e.placeholder,t):(0,s.A8)(e)&&u(e.alt,t),e.shadowRoot&&e.shadowRoot.childNodes?.forEach(e=>{l(e,t)}),e.childNodes&&e.childNodes.forEach(e=>{l(e,t)})):(0,s.ir)(e)&&u(e.data,t)}function u(e,t){e&&(e=e.trim())&&t.push(e.replaceAll("\n"," "))}},5884:function(e,t,n){n.d(t,{Z:function(){return c}});var a=n(3696),s=n(5022),r=n(5688),o=n(4458);function i(e,t){const{brandColor:n,onClose:i,onRestart:c,onCloseAndRestart:l}=e,u=(0,s.d4)(e=>e.config.public.showRestartButton||e.config.public.headerConfig?.showRestartButton),d=(0,s.d4)(e=>e.persistedToBrowserStorage.chatState.homeScreenState.showBackToBot),h=(0,s.d4)(e=>e.headerDisplayName),g=(0,s.d4)(e=>e.customMenuOptions),m=(0,s.d4)(e=>e.theme.useAITheme),p=(0,a.useRef)();(0,a.useImperativeHandle)(t,()=>p.current);const f=!d,S=(0,a.useCallback)(e=>{const{handler:t}=g[e];t()},[g]),y=g?.map(e=>e.text);return a.createElement("div",{className:"WACHomeScreenHeader"},a.createElement(r.Y,{ref:p,displayName:h,showCenter:!0,showRestartButton:u,hideCloseAndRestartButton:f,onClickRestart:c,onClickClose:i,onCloseAndRestart:l,overflowClicked:S,overflowItems:y,useAITheme:m,brandColor:n,testIdPrefix:o.G.HOME_SCREEN}))}const c=a.memo((0,a.forwardRef)(i))},5888:function(e,t,n){n.d(t,{KS:function(){return m},Xq:function(){return u},_M:function(){return p},gu:function(){return d},hw:function(){return f},w9:function(){return S}});var a=n(5285),s=n(8142),r=n(3499),o=n(3696),i=n(2870),c=n(4774);const l={ar:()=>n.e(350).then(n.t.bind(n,350,19)),"ar-dz":()=>n.e(5693).then(n.t.bind(n,5693,19)),"ar-kw":()=>n.e(2669).then(n.t.bind(n,2669,19)),"ar-ly":()=>n.e(7052).then(n.t.bind(n,7052,19)),"ar-ma":()=>n.e(5101).then(n.t.bind(n,5101,19)),"ar-sa":()=>n.e(3543).then(n.t.bind(n,3543,19)),"ar-tn":()=>n.e(5601).then(n.t.bind(n,5601,19)),cs:()=>n.e(915).then(n.t.bind(n,915,19)),de:()=>n.e(2922).then(n.t.bind(n,2922,19)),"de-at":()=>n.e(5858).then(n.t.bind(n,5858,19)),"de-ch":()=>n.e(8516).then(n.t.bind(n,8516,19)),en:()=>Promise.resolve().then(n.t.bind(n,8142,19)),"en-au":()=>n.e(8173).then(n.t.bind(n,8173,19)),"en-ca":()=>n.e(8119).then(n.t.bind(n,8119,19)),"en-gb":()=>n.e(110).then(n.t.bind(n,110,19)),"en-ie":()=>n.e(3061).then(n.t.bind(n,3061,19)),"en-il":()=>n.e(6190).then(n.t.bind(n,6190,19)),"en-nz":()=>n.e(7031).then(n.t.bind(n,7031,19)),es:()=>n.e(1593).then(n.t.bind(n,1593,19)),"es-do":()=>n.e(4183).then(n.t.bind(n,6564,19)),"es-us":()=>n.e(4462).then(n.t.bind(n,4462,19)),nl:()=>n.e(8971).then(n.t.bind(n,8971,19)),fr:()=>n.e(2609).then(n.t.bind(n,2609,19)),"fr-ca":()=>n.e(1254).then(n.t.bind(n,1254,19)),"fr-ch":()=>n.e(3773).then(n.t.bind(n,3773,19)),it:()=>n.e(4528).then(n.t.bind(n,2147,19)),"it-ch":()=>n.e(4762).then(n.t.bind(n,4762,19)),ja:()=>n.e(1204).then(n.t.bind(n,1204,19)),ko:()=>n.e(1015).then(n.t.bind(n,1015,19)),pt:()=>n.e(4261).then(n.t.bind(n,4261,19)),"pt-br":()=>n.e(9406).then(n.t.bind(n,9406,19)),zh:()=>n.e(7317).then(n.t.bind(n,7317,19)),"zh-cn":()=>n.e(7317).then(n.t.bind(n,7317,19)),"zh-tw":()=>n.e(8737).then(n.t.bind(n,8737,19)),"zh-mo":()=>n.e(8737).then(n.t.bind(n,8737,19)),"zh-hk":()=>n.e(8737).then(n.t.bind(n,8737,19))};async function u(e){try{const t=function(e,t){const n=function(e,t){if(!e)return null;if(t[e=e.toLowerCase().replace(/_/g,"-")])return e;const n=e.substring(0,2);return t[n]?n:null}(e,t);if(n)return n;if(e){const n=JSON.stringify(Object.keys(t));(0,i.yA)(`The requested locale "${e}" does not contain a supported locale. We are defaulting to "en". The supported values are ${n}.`)}return"en"}(e,l),n=await l[t]();if(n)return n.default;(0,i.yA)(`The locale data for "${t}" did not load. The application will default to "en".`)}catch(t){(0,i.yA)(`An error occurred loading the locale data for "${e}". The application will default to "en".`,t)}return s}async function d(e){return e?(t=e,{...c.Ay$,...t}):c.Ay$;var t}function h(e){return o.createElement("b",null,e)}function g(){return o.createElement("br",null)}function m(e){return e.b=h,e.br=g,e}async function p(e){if(!a.Ls[e]){const t=a.locale(),n=await u(e);a.locale(n),a.locale(t);const s=Boolean(a.Ls[e]);if(!s&&2===e.length)throw Error("Locale is not recognized.");if(!s)return p(e.substring(0,2))}return e}function f(e,t,n){return e.formatMessage({id:t},n)}function S(e){return new r.Ay(c.Ay$[e],"en-US")}},6254:function(e,t,n){n.d(t,{D:function(){return r}});var a=n(3696),s=n(9964);function r(){return(0,a.useContext)(s.F)}},6516:function(e,t,n){n.d(t,{G:function(){return o}});var a=n(4452),s=n(3696),r=n(4630);function o(e){const{hidden:t,children:n,className:o,...i}=e;return s.createElement(r.l.Provider,{value:t},s.createElement("div",{className:a(o,{WAC__hidden:t}),...i},n))}},6538:function(e,t,n){n.d(t,{l:function(){return a}});const a=n(3696).createContext(null)},6543:function(e,t,n){var a,s,r;n.d(t,{Ni:function(){return r},ps:function(){return a},wQ:function(){return s}}),function(e){e.WHITE="cds--white",e.G10="cds--g10",e.G90="cds--g90",e.G100="cds--g100"}(a||(a={})),function(e){e.PRIMARY="primary",e.SECONDARY="secondary",e.DANGER="danger",e.GHOST="ghost",e.DANGER_PRIMARY="danger--primary",e.DANGER_GHOST="danger--ghost",e.DANGER_TERTIARY="danger--tertiary",e.TERTIARY="tertiary"}(s||(s={})),function(e){e.SMALL="sm",e.MEDIUM="md",e.LARGE="lg",e.XLARGE="xl",e.XXLARGE="2xl"}(r||(r={}))},6683:function(e,t,n){n.d(t,{O:function(){return r}});var a=n(3696),s=n(8583);function r(){return(0,a.useContext)(s.k)}},6718:function(e,t,n){n.d(t,{B:function(){return a}});const a=n(3696).createContext(null)},6753:function(e,t,n){n.d(t,{u:function(){return s}});var a=n(8139);function s(e){return(0,a.A)()}},7008:function(e,t,n){n.d(t,{z:function(){return o}});var a=n(3696),s=n(395);function r(e){const t=(0,a.useContext)(s.s);return(0,a.useEffect)(()=>{t(e.message)},[t,e.message]),a.createElement("div",null)}const o=a.memo(r)},7338:function(e,t,n){n.d(t,{A8:function(){return m},Ci:function(){return y},Ht:function(){return u},TV:function(){return C},c1:function(){return i},d$:function(){return c},gU:function(){return o},ir:function(){return h},rG:function(){return p},vQ:function(){return g},vq:function(){return d},vv:function(){return f}});var a=n(2271),s=n(711),r=n(3066);const o=(0,s.A)(function(){const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",document.body.appendChild(e);const t=document.createElement("div");e.appendChild(t);const n=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),n});function i(e,t=!1,n){e&&(0,a.O)(e,{boundary:n,scrollMode:"if-needed",block:"nearest",inline:"nearest"}).forEach(({el:e,top:n,left:a})=>{c(e,Math.round(n),Math.round(a),t)})}function c(e,t,n,a=!1){setTimeout(()=>{e&&(a&&e.scroll?e.scroll({top:t,left:n,behavior:"smooth"}):(e.scrollTop=t,e.scrollLeft=n))})}function l(e,t=!1){e&&document.activeElement!==e&&(0,r.tabbable)(e,{getShadowRoot:!0})&&e.focus({preventScroll:t})}function u(e,t=!1,n=!1){e&&(t?setTimeout(()=>{u(e)}):e.current&&l(e.current,n))}function d(e){return 1===e?.nodeType}function h(e){return 3===e?.nodeType}function g(e){return"INPUT"===e?.tagName}function m(e){return"IMG"===e?.tagName}function p(e){return"TEXTAREA"===e?.tagName}function f(e){for(let t=0;t<e.length;t++)if(S(e[t]))return!0;return!1}function S(e){const t=(0,r.tabbable)(e,{getShadowRoot:!0});return!!t?.length&&(l(t[0]),!0)}function y(e){return"Enter"===e.key&&!function(e){return e.shiftKey||e.altKey||e.metaKey||e.ctrlKey}(e)&&!(e.isComposing||229===e.keyCode)}function C(e){return e?e.scrollHeight-e.offsetHeight-e.scrollTop:0}},7391:function(e,t,n){n.d(t,{$H:function(){return b},$Q:function(){return C},Bj:function(){return E},Cx:function(){return P},D6:function(){return H},Dc:function(){return m},E_:function(){return _},Ex:function(){return N},I3:function(){return j},Ll:function(){return y},Mm:function(){return O},OL:function(){return L},Of:function(){return d},Or:function(){return z},R2:function(){return l},Rt:function(){return k},SP:function(){return S},Sq:function(){return A},Sv:function(){return u},U7:function(){return p},Wf:function(){return h},Wo:function(){return x},XV:function(){return G},Xk:function(){return W},Z2:function(){return w},_0:function(){return R},_x:function(){return F},bY:function(){return D},eK:function(){return I},ee:function(){return U},f9:function(){return $},jS:function(){return T},jv:function(){return M},kZ:function(){return q},ks:function(){return g},p0:function(){return f},qH:function(){return V},r2:function(){return v},xN:function(){return Y}});var a=n(8690),s=n(948),r=n(6753),o=n(9633),i=n(577),c=n(6895);const l="main";function u(e){return e&&void 0!==e.output}function d(e){return e?.item.response_type===o.sP.DATE}function h(e){return e.id||(e.id=(0,r.u)(i.y.MESSAGE)),e.thread_id||(e.thread_id=l),e.history||(e.history={}),e.history.timestamp||(e.history.timestamp=Date.now()),void 0===e.history.from_history&&(e.history.from_history=!1),e}function g(e){return void 0!==e?.input}function m(e){return Boolean(e.item.agent_message_type)}function p(e){return e?.input?.message_type===o.s9.EVENT}function f(e){return e&&"text"===e.response_type&&void 0!==e.text}function S(e){return e.response_type===o.sP.PAUSE&&1==e.typing}function y(e){return e.response_type===o.sP.PAUSE}function C(e){return e?.response_type===o.sP.OPTION&&void 0!==e.options}function E(e,t){const n={id:(0,r.u)(i.y.MESSAGE),thread_id:l,...(0,a.A)(e.value)};return n.history={label:e.label,related_message_id:t},n}function _(e,t){const n={id:(0,r.u)(i.y.MESSAGE),thread_id:l,input:null};return e.value?.input?.text?n.input=(0,a.A)(e.value.input):n.input={text:e.label},n.history={related_message_id:t},n}function A(){return h({id:(0,r.u)(i.y.MESSAGE),input:{text:""},history:{silent:!0,is_welcome_request:!0},thread_id:l})}function v(e){return h({input:{text:e,message_type:o.s9.TEXT}})}function T(e){return h({id:e.id,input:{text:e.file.name,message_type:o.Co.FILE,agent_message_type:o.Xb.FROM_USER},history:{file_upload_status:c.aT.UPLOADING}})}function I(e,t,n){const a=v(e);return a.history={label:t,related_message_id:n},a}function w(e,t=l,n=o.sP.TEXT,a){const s={response_type:n,text:e};return{id:(0,r.u)(i.y.MESSAGE),thread_id:t,output:{generic:[s]}}}function M(e,t){return h({output:{generic:[e]}})}function b(e){return e?.response_type===o.sP.CONNECT_TO_AGENT}function R(e){return e?.response_type===o.sP.CARD}function N(e){return e?.response_type===o.sP.CAROUSEL}function O(e){return e?.response_type===o.sP.BUTTON}function P(e){return O(e)&&e.button_type===o.kw.SHOW_PANEL}function D(e){return O(e)?B(e.panel):R(e)?B(e):N(e)?void 0!==e.items:F(e)}function B(e){return void 0!==e?.body||void 0!==e?.footer}function L(e){switch(e.response_type){case o.sP.TEXT:case o.sP.IMAGE:case o.sP.OPTION:case o.sP.CONNECT_TO_AGENT:case o.sP.IFRAME:case o.sP.VIDEO:case o.sP.AUDIO:case o.sP.DATE:case o.sP.CONVERSATIONAL_SEARCH:case o.sP.TABLE:case o.sP.INLINE_ERROR:case o.sP.CARD:case o.sP.CAROUSEL:case o.sP.BUTTON:case o.sP.GRID:return!1;default:return!H(e)}}function H(e){return W(e)}function W(e){return"IBM_BETA_JOURNEYS_TOUR"===e?.user_defined?.user_defined_type}function k(e){return Boolean(e.public.serviceDeskFactory)}function x(e){switch(e.response_type){case o.sP.IMAGE:case o.sP.IFRAME:case o.sP.VIDEO:case o.sP.AUDIO:case o.sP.TEXT:case o.sP.USER_DEFINED:case o.sP.CARD:case o.sP.GRID:return!0;default:return!1}}function U(e){return N(e)&&1===e.items.length}function F(e){return e?.response_type===o.sP.GRID}function V(e,t){let n="button";return e&&"button"===e?n="button":(e&&"dropdown"===e||t>4)&&(n="dropdown"),n}function $(e){return Boolean(e.partial_item)}function G(e){return Boolean(e.complete_item)}function q(e){return Boolean(e.final_response)}function Y(e,t){const n=t?.streaming_metadata?.id;return n?`${e}-${n}`:null}function j(e){return e.dimensions}function z(e){const t=e.botMessageState.messageIDs||[];return(0,s.U1)(t,e.allMessagesByID,e=>u(e)&&!function(e){return u(e)&&Boolean(e.output.generic?.find(e=>e?.agent_message_type))||g(e)&&Boolean(e.input.agent_message_type)}(e)&&Boolean(e.context))}},7429:function(e,t,n){n.d(t,{D:function(){return o}});var a=n(3696),s=n(2537);class r extends a.PureComponent{constructor(){super(...arguments),this.state={isMounted:!1},this.onceAnnounced=!1}componentDidMount(){this.setState({isMounted:!0}),this.onceAnnounced||(this.props.announceOnce&&setTimeout(()=>{this.props.ariaAnnouncer(this.props.announceOnce)}),this.onceAnnounced=!0)}render(){return a.createElement("div",{"aria-live":"polite"},this.state.isMounted&&this.props.children)}}const o=(0,s.J)(r)},8018:function(e,t,n){var a;n.d(t,{g:function(){return a}}),function(e){e.NARROW="narrow",e.STANDARD="standard",e.WIDE="wide"}(a||(a={}))},8205:function(e,t,n){n.d(t,{A:function(){return r}});var a=n(3696);function s({slotName:e,id:t,className:n}){return a.createElement("div",{className:n,id:t,"data-floating-menu-container":!0},a.createElement("slot",{name:e}))}var r=a.memo(s)},8583:function(e,t,n){n.d(t,{k:function(){return a}});const a=n(3696).createContext(null)},8676:function(e,t,n){n.d(t,{u:function(){return u}});var a=n(393),s=n(4544),r=n(3696),o=n(8325),i=n(6718);class c extends r.Component{constructor(){super(...arguments),this.state={attachedToHost:null},this.modalElement=document.createElement("div")}componentDidMount(){this.attachIfNeeded()}componentDidUpdate(){this.attachIfNeeded()}componentWillUnmount(){this.state.attachedToHost&&this.state.attachedToHost.removeChild(this.modalElement)}attachIfNeeded(){const e=this.context;e&&!this.state.attachedToHost&&(this.setState({attachedToHost:e}),e.appendChild(this.modalElement))}render(){return this.state.attachedToHost?o.createPortal(this.props.children,this.modalElement):null}}c.contextType=i.B;var l=n(7008);class u extends r.Component{constructor(){super(...arguments),this.onYesClick=()=>{this.props.onConfirm()},this.onNoClick=()=>{this.props.onCancel()},this.onKeyDown=e=>{"Escape"===e.key&&this.props.onCancel()}}render(){const{title:e,message:t,cancelButtonLabel:n,confirmButtonLabel:o,modalAnnounceMessage:i,serviceManager:u}=this.props;return r.createElement(c,null,r.createElement(s,null,r.createElement("div",{className:"WACConfirmModal",role:"dialog","aria-labelledby":`WACConfirmModal__title${u.namespace.suffix}`,"aria-describedby":`WACConfirmModal__message${u.namespace.suffix}`},r.createElement("div",{className:"WACConfirmModal__container"},r.createElement(l.z,{message:i}),r.createElement("div",{className:"WACConfirmModal__title",id:`WACConfirmModal__title${u.namespace.suffix}`},e),r.createElement("div",{className:"WACConfirmModal__message",id:`WACConfirmModal__message${u.namespace.suffix}`},t),r.createElement("div",{className:"WACConfirmModal__buttonContainer"},r.createElement(a.$nd,{className:"WACConfirmModal__NoButton",kind:"secondary",onClick:this.onNoClick,onKeyDown:this.onKeyDown,size:"md"},n),r.createElement(a.$nd,{className:"WACConfirmModal__YesButton",onClick:this.onYesClick,onKeyDown:this.onKeyDown,size:"md"},o))))))}}},8795:function(e,t,n){var a,s;n.d(t,{k:function(){return a},t:function(){return s}}),function(e){e.BASE_HEIGHT="BASE-height",e.BASE_MAX_HEIGHT="BASE-max-height",e.BASE_WIDTH="BASE-width",e.BASE_Z_INDEX="BASE-z-index"}(a||(a={})),function(e){e.AI_TOOLTIP_AFTER_DESCRIPTION_ELEMENT="aiTooltipAfterDescriptionElement",e.WELCOME_NODE_BEFORE_ELEMENT="welcomeNodeBeforeElement",e.HEADER_BOTTOM_ELEMENT="headerBottomElement",e.BEFORE_INPUT_ELEMENT="beforeInputElement",e.HOME_SCREEN_BEFORE_INPUT_ELEMENT="homeScreenBeforeInputElement",e.HOME_SCREEN_AFTER_STARTERS_ELEMENT="homeScreenAfterStartersElement",e.HOME_SCREEN_HEADER_BOTTOM_ELEMENT="homeScreenHeaderBottomElement",e.CUSTOM_PANEL_ELEMENT="customPanelElement"}(s||(s={}))},9049:function(e,t,n){n.d(t,{PK:function(){return c},R0:function(){return i},i_:function(){return l}});const a=e=>e.botInputState,s=e=>e.agentState.inputState,r=e=>e.agentState,o=e=>e.persistedToBrowserStorage.chatState.agentState;function i(e){const t=r(e),n=o(e);if(n.isSuspended)return{isConnectingOrConnected:!1,disableInput:!1,isAgentTyping:!1,inputPlaceholderKey:null};const{isReconnecting:a,isConnecting:s,isAgentTyping:i}=t,{isConnected:c}=n;let l;return l=s?"agent_inputPlaceholderConnecting":a?"agent_inputPlaceholderReconnecting":null,{isAgentTyping:i,isConnectingOrConnected:s||c,disableInput:s||a,inputPlaceholderKey:l}}function c(e){return i(e).isConnectingOrConnected}function l(e){return c(e)?s(e):a(e)}},9186:function(e,t,n){n.d(t,{r:function(){return g}});var a=n(1311),s=n(3696),r=n(5022),o=n(6254),i=n(6683),c=n(9049),l=n(8205),u=n(5688),d=n(8795);function h(e,t){const{onClose:n,onCloseAndRestart:h,onRestart:g,onToggleHomeScreen:m,headerDisplayName:p,includeWriteableElement:f,enableChatHeaderConfig:S,headerAvatarConfig:y,testIdPrefix:C}=e,E=(0,i.O)(),_=(0,o.D)(),A=(0,r.d4)(e=>e.homeScreenConfig.is_on&&e.homeScreenConfig.allow_return),v=(0,r.d4)(e=>e.config.public),T=(0,r.d4)(e=>e.customMenuOptions),{isConnectingOrConnected:I}=(0,r.d4)(c.R0,r.bN),w=(0,r.d4)(e=>e.theme.useAITheme),M=(0,r.d4)(e=>e.chatHeaderState.maxVisibleHeaderObjects),b=(0,r.d4)(e=>e.chatHeaderState.config?.left?.length||0),R=(0,r.d4)(e=>e.chatHeaderState.config?.right?.length||0),N=(0,s.useRef)(),O=S&&(b>M||R>M),P=v.showRestartButton||v.headerConfig?.showRestartButton,D=A&&!I,B=(0,s.useCallback)(e=>{if(0===e&&D)m?.();else{const{handler:t}=T[D?e-1:e];t()}},[T,m,D]);let L=T?.map(e=>e.text);return L&&D?L.splice(0,0,_.homeScreen_overflowMenuHomeScreen):!L&&D&&O&&(L=[_.homeScreen_overflowMenuHomeScreen]),(0,s.useImperativeHandle)(t,()=>N.current),s.createElement("div",{className:"WACHeader__Container"},s.createElement(u.Y,{ref:N,showCenter:!0,headerAvatarConfig:y,displayName:p,showBackButton:Boolean(D&&m),showRestartButton:P,useAITheme:w,backContent:s.createElement(a.A,null),labelBackButton:_.homeScreen_returnToHome,onClickRestart:g,onClickClose:n,onCloseAndRestart:h,onClickBack:m,overflowItems:L,overflowClicked:B,enableChatHeaderConfig:S,testIdPrefix:C}),f&&s.createElement(l.A,{slotName:d.t.HEADER_BOTTOM_ELEMENT,id:`headerBottomElement${E.namespace.suffix}`,className:"WACHeader__HeaderBottomElement"}))}const g=s.memo((0,s.forwardRef)(h))},9280:function(e,t,n){function a(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(t=>{!Object.prototype.hasOwnProperty.call(e,t)||null===e[t]||"object"!=typeof e[t]&&"function"!=typeof e[t]||Object.isFrozen(e[t])||a(e[t])}),e}n.d(t,{o:function(){return a}})},9499:function(e,t,n){n.d(t,{A:function(){return o}});var a=n(9633),s=n(6753),r=n(577);function o(e,t,n=(0,s.u)(r.y.LOCAL_MESSAGE)){return{item:{response_type:a.sP.TEXT,...e.input},ui_state:{id:n,originalUserText:t,needsAnnouncement:!1},fullMessageID:e.id}}},9705:function(e,t,n){n.d(t,{q:function(){return r}});var a=n(3696),s=n(395);function r(){return(0,a.useContext)(s.s)}},9763:function(e,t,n){n.d(t,{A9:function(){return M},AF:function(){return S},BC:function(){return _},F:function(){return I},G:function(){return i},HD:function(){return o},HM:function(){return u},HO:function(){return w},KK:function(){return r},KT:function(){return T},Nj:function(){return c},Rf:function(){return p},VD:function(){return y},XF:function(){return l},_0:function(){return C},bf:function(){return s},cg:function(){return v},dB:function(){return a},gW:function(){return d},hB:function(){return E},j1:function(){return m},np:function(){return f},o$:function(){return h},oP:function(){return b},qb:function(){return A},xO:function(){return g}});const a="HA_SET_AGENT_AVAILABILITY",s="HA_SET_IS_CONNECTING",r="HA_SET_IS_RECONNECTING",o="HA_SET_AGENT_JOINED",i="HA_SET_AGENT_LEFT_CHAT",c="HA_END_CHAT",l="HA_UPDATE_CAPABILITIES",u="HA_UPDATE_FILE_UPLOAD_IN_PROGRESS",d="HA_SET_SHOW_SCREEN_SHARE_REQUEST",h="HA_SET_IS_SCREEN_SHARING",g="HA_SET_PERSISTED_STATE",m="HA_UPDATE_IS_SUSPENDED",p="HA_UPDATE_IS_TYPING";function f(e,t){return{type:s,isConnecting:e,localMessageID:t}}function S(e){return{type:r,isReconnecting:e}}function y(){return{type:i}}function C(){return{type:c}}function E(e){return{type:a,availability:e}}function _(e){return{type:o,agentProfile:e}}function A(e){return{type:l,capabilities:e}}function v(e){return{type:u,fileUploadInProgress:e}}function T(e){return{type:d,showRequest:e}}function I(e){return{type:h,isSharing:e}}function w(e){return{type:g,state:e}}function M(e){return{type:m,isSuspended:e}}function b(e){return{type:p,isTyping:e}}},9964:function(e,t,n){n.d(t,{F:function(){return a}});const a=n(3696).createContext(null)}}]);
//# sourceMappingURL=2288.bundle.js.map