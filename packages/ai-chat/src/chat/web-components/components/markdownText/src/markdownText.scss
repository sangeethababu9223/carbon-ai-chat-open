/*
 *  Copyright IBM Corp. 2025
 *
 *  This source code is licensed under the Apache-2.0 license found in the
 *  LICENSE file in the root directory of this source tree.
 */

@use "sass:meta";
@use "@carbon/styles/scss/reset";
@use "@carbon/styles/scss/type";
@use "@carbon/styles/scss/theme";
@use "@carbon/layout";
@use "@carbon/styles/scss/components/link";

:host {
  display: block;
  container-type: inline-size;
  inline-size: 100%;
  max-inline-size: 100%;

  @include type.default-type();

  .WACConversationalSearchText--hasCitation {
    border-radius: 4px;
    background-color: theme.$highlight;
  }

  .cds-aichat-markdown-stack {
    display: block;
    max-inline-size: 100%;

    > *:not(:first-child) {
      margin-block-start: layout.$spacing-05;
    }

    > h1 + *:not(:first-child),
    > h2 + *:not(:first-child),
    > h3 + *:not(:first-child),
    > h4 + *:not(:first-child),
    > h5 + *:not(:first-child),
    > h6 + *:not(:first-child) {
      margin-block-start: layout.$spacing-02;
    }
  }

  p {
    @include type.type-style("body-01");
  }

  blockquote {
    border-inline-start: 2px solid theme.$border-subtle-00;
    padding-inline-start: layout.$spacing-03;

    > *:not(:first-child) {
      margin-block-start: layout.$spacing-05;
    }

    > h1 + *:not(:first-child),
    > h2 + *:not(:first-child),
    > h3 + *:not(:first-child),
    > h4 + *:not(:first-child),
    > h5 + *:not(:first-child),
    > h6 + *:not(:first-child) {
      margin-block-start: layout.$spacing-03;
    }
  }

  pre {
    @include type.type-style("code-02");

    overflow: auto hidden;
    padding: layout.$spacing-05;

    border: solid 1px theme.$chat-bubble-border;
    background-color: theme.$layer-02;
    white-space: pre-wrap;
  }

  img {
    /* Make sure images in markdown do not overflow. */
    max-inline-size: 100%;
  }

  h1 {
    @include type.type-style("heading-04");
  }

  h2 {
    @include type.type-style("heading-03");
  }

  h3 {
    @include type.type-style("heading-02");
  }

  h4 {
    @include type.type-style("heading-01");
  }

  h5 {
    @include type.type-style("heading-01");
  }

  h6 {
    @include type.type-style("heading-01");
  }

  cds-ordered-list:not([nested]) cds-list-item {
    margin-inline-start: layout.$spacing-06;
  }

  // Apply styles for narrow and standard widths (< 704px) using container queries
  // Carbon displays cds--link using display: inline-flex to allow icons to align well. In our narrow viewport this can
  // lead to some funky linebreaks. This CSS will set cds--link to be display: inline if there is no icon.
  @container (max-width: 703px) {
    .cds--link:not(:has(.cds--link__icon)) {
      display: inline;
    }
  }
}
